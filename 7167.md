## NCR 7167 Two-Station POS Printer

## Release 1.

# Owner's Manual

B005-000-

Revision C

November, 2003


```
ii
```
The product described in this book is a licensed product of NCR Corporation.

NCR is the registered trademark of NCR Corporation. Other trademarks and registered trademarks are the property of their
respective holders.

It is the policy of NCR Corporation (NCR) to improve products as new technology, components, software, and firmware
become available. NCR, therefore, reserves the right to change specifications without prior notice.

All features, functions, and operations described herein may not be marketed by NCR in all parts of the world. In some
instances, photographs are of equipment prototypes. Therefore, before using this document, consult with your NCR
representative or NCR office for information that is applicable and current.

To maintain the quality of our publications, we need your comments on the accuracy, clarity, organization, and value of this
book.

Address correspondence to:

Retail Systems Group−Atlanta
NCR Corporation
2651 Satellite Blvd.
Duluth, GA 30136

Copyright © 2003
By NCR Corporation
Dayton, Ohio U.S.A.
All Rights Reserved


```
iii
```
**Important Information to the User**

In order to ensure compliance with the Product Safety, FCC and CE marking requirements, you must use the power supply,
power cord, and interface cable which were shipped with this product or which meet the following parameters:

**Power Supply**

UL Listed (QQGQ), Class 2 power supply with SELV (Secondary Extra Low Voltage), non-energy hazard output, limited
energy source, input rated 100-240 Vac, 1.5/0.8 A, 50/60 Hz, output rated 24 Vdc, 2.3 A. or 3.15A

Use of this product with a power supply other than the NCR power supply will require you to test this power supply and
NCR printer for FCC and CE mark certification.

**Interface Cable**

A shielded (360 degree) interface cable must be used with this product. The shield must be connected to the frame or earth
ground connection or earth ground reference at EACH end of the cable.

Use of a cable other than described here will require that you test this cable with the NCR printer and your system for FCC
and CE mark certification.

**Power Cord**

A UL listed, detachable power cord must be used for this product. For applications where the power supply module may be
mounted on the floor, a power cord with Type SJT marking must be used. For applications outside the US, power cords which
meet the particular country’s certification and application requirements should be used.

Use of a power cord other than described here may result in a violation of safety certifications which are in force in the
country of use.


```
iv
```
**Federal Communications Commission (FCC)
Radio Frequency Interference Statement**

**Warning:** Changes or modifications to this unit not expressly approved by the party responsible for compliance could void the
user’s authority to operate the equipment.

**Note:** This equipment has been tested and found to comply with the limits for a Class A digital device, pursuant to Part 15 of
the FCC Rules. These limits are designed to provide reasonable protection against harmful interference when the equipment is
operated in a commercial environment. This equipment generates, uses, and can radiate radio frequency energy and, if not
installed and used in accordance with the instruction manual, may cause harmful interference to radio communications.
Operation of this equipment in a residential area is likely to cause harmful interference in which case the user will be required
to correct the interference at his own expense.

**Communication Cables**

Shielded communication cables must be used with this unit to ensure compliance with the Class A FCC limits.

**Information to User**

This equipment must be installed and used in strict accordance with the manufacturer's instructions. However, there is no
guarantee that interference to radio communications will not occur in a particular commercial installation. If this equipment
does cause interference, which can be determined by turning the equipment off and on, the user is encouraged to contact NCR
immediately.

The NCR company is not responsible for any radio or television interference caused by unauthorized modification of this
equipment or the substitution or attachment of connecting cables and equipment other than those specified by NCR. The
correction of interferences caused by such unauthorized modification, substitution or attachment will be the responsibility of
the user.

**Industry Canada (IC)
Radio Frequency Interference Statement**

This Class A digital apparatus meets all requirements of the Canadian Interference-Causing Equipment Regulations.

_Cet appareil numérique de la classe A respecte toutes les exigences du Règlement sur le matériel brouilleur du Canada._


```
v
```
### Quick Reference

```
This Quick Reference will direct you to key areas of the Service Manual. For a complete
listing of topics, consult the Table of Contents or the Index.
```
```
Setting Up the Printer .................................................... page 9
Basic requirements for unpacking and installation, connecting the printer, turning it on,
and running the print test.
```
```
Diagnostics .................................................................... page 53
Procedures for setting up the printer for items such as communications, diagnostics, and
other printer options.
```
```
Printer Commands........................................................ page 83
Printer firmware commands
```

```
vi
```
#### How to Use this Book

```
Use this book as a general and technical reference manual and as a guide when replacing
parts on the printer. The service guide is intended as a guide for service representatives,
field engineers, and those who will be installing and learning about the 7167 printer. It can
also be used as a reference for service courses.
See the Quick Reference page, the Contents, or the Index for detailed listings of what is
contained in this book.
```
#### Who Should Use this Book?

```
You must be a trained service representative to service the 7167 Thermal Receipt and
Impact printer.
```
#### How to Obtain More Information

```
For more information see the following documents:
7167 Two - Station POS Printer: Service Manual (B005-000-1407)
7167 Two - Station POS Printer: Parts Identification Manual (B005-000-1408)
For this and additional copies of the Owner’s Manual, contact your sales representative.
```
### Revision Record

```
Issue Date Remarks
A Mar 2003 First printing
B May 2003 Update to reflect first production configuration.
C September 2003 Updated to add the 7167 check scan information.
```

## 7167 Owner’s Manual Contents

```
November 2003 vii
```
### Contents

```
Quick Reference........................................................................................................................... v
How to Use this Book......................................................................................................... vi
Who Should Use this Book?............................................................................................... vi
How to Obtain More Information....................................................................................... vi
Revision Record.......................................................................................................................... vi
```


7167 Owner’s Manual Contents

- Chapter 1: About the 7167 Printer........................................................................................................................................ Contents vii
   - Features and Options....................................................................................................................
      - Receipt Station.....................................................................................................................
      - Slip Station
      - Receipt and Slip Print Stations
      - General Features
      - Options
   - Thermal Print Head......................................................................................................................
   - Impact Print Head
   - Ordering Paper and Supplies........................................................................................................
      - Ordering Thermal Receipt Paper
      - Ordering Ribbon Cassettes
      - Ordering Other Supplies
      - Ordering Documentation
   - Cleaning the Printer
      - Cleaning the Cabinet
      - Cleaning the Thermal Print Head
      - Cleaning the Scanner Sensor
- Chapter 2: Setting Up and Using the Printer
   - What Is in the Box?......................................................................................................................
      - Removing the Packing Material
      - Re Packing the Printer
   - Choosing a Location
      - c) Wall mounted Power Supply (Option)
   - Setting Switches...........................................................................................................................
      - Printer Reset
   - Using the Printer
   - Loading and Changing the Receipt Paper
      - Removing the Paper Roll...................................................................................................
      - Loading the Paper Roll
      - Advancing Paper
   - Installing and Changing the Ribbon Cassette
      - Removing the Ribbon Cassette..........................................................................................
      - Installing the Ribbon Cassette
   - Printing on Forms or Checks
   - Validating and Verifying Checks...............................................................................................
   - About the Universal Serial Bus..................................................................................................
      - Advantages of USB connections
      - Advantages of the NCR USB Solution..............................................................................
   - Checking for USB Support on the Host Computer
      - Host Configuration
   - Installing the USB Printer Drivers
   - Checking the Installation
   - Configuring Serial Port Number Assignments...........................................................................
- viii November 7167 Owner’s Manual Contents
      - Running the Edgeport Utility............................................................................................
      - Serial Port Configuration Methods
      - Uninstalling the Drivers.....................................................................................................
- Chapter 3: Solving Problems
   - Green LED Does Not Come On/Printer Will Not Print
   - Green LED Blinking (Slow)
   - Green LED Blinking (Fast)........................................................................................................
   - Slip or Forms Printing is Light
   - Receipt Printing is Light or Spotty.............................................................................................
   - LED (Slip Table) Does Not Come On
   - Forms Skew or Catch.................................................................................................................
   - MICR Check Reader Not Reading Properly
   - Other Serious Problems
   - Contacting a Service Representative..........................................................................................
- Chapter 4: Diagnostics..........................................................................................................................................................
   - Level 0 Diagnostics....................................................................................................................
   - Level 1 Diagnostics....................................................................................................................
      - Printer Configuration.........................................................................................................
      - Configuring the Printer
      - Communication Interface Modes
      - Diagnostic Modes
      - Emulation/Software Options
      - Hardware Options..............................................................................................................
      - Default Code Page
   - Level 2 Diagnostics....................................................................................................................
   - Level 3 Diagnostics....................................................................................................................
- Chapter 5: Communication..................................................................................................................................................
   - Communication Overview
      - Interface.............................................................................................................................
      - Sending Commands...........................................................................................................
   - RS-232C Interface
      - Print Speed and Timing
      - XON/XOFF Protocol.........................................................................................................
      - DTR/DSR Protocol............................................................................................................
      - RS-232C Technical Specifications
      - RS-232C 9-Pin to 9-Pin Cable Diagram............................................................................
      - USB Cable Connector
      - Power Cable Connector
      - Cash Drawer Connector and Pin Assignments
      - Setting Extra RS-232C Options.........................................................................................
- Chapter 6: Commands..........................................................................................................................................................
   - Introduction................................................................................................................................
   - List of Commands and Location
      - By Command Code
      - Printer Function Commands
      - Vertical Positioning and Print............................................................................................
      - Horizontal Positioning Commands....................................................................................
      - Print Characteristic Commands
      - Graphics Commands
      - Status Commands
      - Real Time Commands
      - Auto Status Back Commands
      - Bar Code Commands.........................................................................................................
      - Macro Commands November 2003 ix
      - MICR Check Reader Commands
      - MICR Parsing....................................................................................................................
      - User Data Storage Commands...........................................................................................
      - Asian Character Commands
      - Scanner Function Commands
      - Flash Download Commands..............................................................................................
      - Printer Function Commands
      - Vertical Positioning and Print Commands.......................................................................
      - Horizontal Positioning Commands..................................................................................
      - Print Characteristic Commands
      - Graphics Commands
      - Status Commands
      - Real Time Commands
      - Auto Status Back Commands
      - Page Mode Commands
      - Macro Commands
      - MICR Commands............................................................................................................
      - MICR Parsing..................................................................................................................
      - Check Flip Command
      - User Data Storage Commands.........................................................................................
      - Asian Character Commands
      - Scanner Function Commands
      - Flash Download Commands............................................................................................
- Appendix A: Specifications
   - Printing Specifications
   - Power Requirements
   - Environmental Conditions
   - Reliability.................................................................................................................................
   - Dimensions and Weight ...........................................................................................................
   - Density of Receipt Print Lines
   - Duty Cycle Restrictions (Printing Solid Blocks)
- Appendix B: Print Characteristics
   - Character Size
      - Receipt Station.................................................................................................................
      - Slip Station
   - Print Zones
      - Receipt Station.................................................................................................................
      - Slip Station
      - Slip Form Parameters
      - Check Size
      - MICR Media Requirements.............................................................................................
   - Appendix C: Character Sets
   - Index


7167 Owner’s Manual Chapter 1: About the 7167 Printer

1 November 2003

Chapter 1: About the 7167 Printer

```
The 7167 printer is a fast, quiet, relatively small and very reliable multiple-
function printer. It prints receipts, validates and prints checks, and prints on a
variety of single- or multiple-part forms. There is no journal as it is kept
electronically by the host computer.
The industry-standard RS-232C communication interface allows the 7167 to be
connected to any host computer that uses RS-232C or USB communication
interface.
With thermal printing technology on the more frequently used receipt station,
there is no ribbon cassette to change and paper loading is extremely simple.
Printing on single- or multiple-part forms, validating checks, and printing checks
is also easy in the accommodating slip station. An additional option is the
Magnetic Ink Character Recognition (MICR) check reader with parsing which
reads account numbers on checks for easy verification. An extended slip table is
available for handling large forms and is standard with the MICR option.
```
```
Receipt Cover
LED
Paper Feed
Button
```
```
Receipt
```
```
Front Cover
```
```
Slip Table
LED
```
```
Slip or
Check
```
```
Extended
Slip Table
```

7167 Owner’s Manual Chapter 1: About the 7167 Printer

```
November 2003 2
```
### Features and Options....................................................................................................................

```
The 7167 printer comes with several features and options.
```
#### Receipt Station.....................................................................................................................

```
Thermal printing
Standard pitch (host selectable): 15.2 characters per inch, 44 columns
Compressed pitch (host selectable): 19.0 characters per inch, 56 columns
Resident bar codes
```
- Code 39
- Code 93
- Code 128
- UPC-A
- UPC-E
- JAN8 (EAN)
- JAN13 (EAN)
- Interleaved 2 of 5
- Codabar
- PDF
Drop-in paper loading requiring no spindle or threading paper
Paper low indicator
Paper exhaust indicator

#### Slip Station

```
Bi-directional, impact printing
Standard pitch (host selectable): 13.9 characters per inch, 45 columns
Compressed pitch (host selectable): 17.1 characters per inch, 55 columns
Printing of forms up to five plies
```
- Front insertion of forms with forms stop
- Side insertion of forms with override of forms stop
- Automatic and manual insertion of forms
Form alignment sensors and Slip In LED indicator
Horizontal flat-bed slip table with optional extension (standard with MICR check reader)

#### Installing the Ribbon Cassette

```
Resident bar codes
```
- Code 39
- Code 93
- Code 128
- UPC-A
- UPC-E
- JAN8 (EAN)


7167 Owner’s Manual Chapter 1: About the 7167 Printer

3 November 2003

##### • JAN13 (EAN)

- Interleaved 2 of 5
- Codabar

#### Receipt and Slip Print Stations

```
Variety of print modes: double high (receipt station only), double strike (slip station only), double
wide, upside down, and rotated
14 resident character language Code Pages:
```
- PC Code Page 437 (US English)
- PC Code Page 850 (Multilingual)
- PC Code Page 852 (Slavic)
- PC Code Page 858 (with Euo symbol)
- PC Code Page 860 (Portuguese)
- PC Code Page 862 (Hebrew)
- PC Code Page 863 (French Canadian)
- PC Code Page 864 (Arabic)
- PC Code Page 865 (Nordic)
- PC Code Page 866 (Cyrillic)
- PC Code Page 874 (Thai)
- PC Code Page 1252 (Windows Latin #1)
- PC Code Page Katakana
- Space Page
- Code Page 932*
- Code Page 936*
- Code Page 949*
- Code Page 950*

```
16K RAM for downloaded character sets or bit-mapped graphics (such as logos)
```
#### General Features

```
Knife
Cover open sensors
Industry standard RS-232C and USB communication interface
One cash drawer connector (supports 2 cash drawers)
History EEROM for custom settings
Audible tone (controlled by application)
```
```
Note: The 7167 does not have a paper journal. The journal is kept electronically by the
host computer.
```
* Not supported by model 7167-1035 and 7167-2035.


7167 Owner’s Manual Chapter 1: About the 7167 Printer

```
November 2003 4
```
#### Options

```
Magnetic Ink Character Recognition (MICR) check reader built into the slip station for verifying
checks (includes custom MICR field parsing). E13B and CMC-7 is support with auto sensing of the
MICR type provided.
Extended slip table for handling large forms (standard with MICR check reader)
Remote power supply
Check Scanning function
```

7167 Owner’s Manual Chapter 1: About the 7167 Printer

5 November 2003

### Thermal Print Head......................................................................................................................

```
The 7167 Receipt Station uses a thermal print head for printing receipts, and is extremely
fast and quiet. Since it uses heat to print directly on paper, there is no cassette or ribbon to
change, eliminating soiled fingers and paper dust.
There is no regularly scheduled maintenance for the print head and it does not need to be
regularly cleaned. However, if it does appear dirty, wipe it with cotton swabs and rubbing
alcohol. If spotty or light printing problems persist after the thermal print head has been
cleaned, see “Chapter 3: Solving Problems” for more information.
Note: The thermal print head does not normally require cleaning if the recommended
paper is used. If non-recommended paper has been used for an extended period of time,
cleaning the print head with cotton swabs and rubbing alcohol will not be of much benefit.
See “Ordering Receipt Paper” on the next page for the recommended paper.
The print head is designed for a very long life, but it may be replaced if needed. Only a
trained service representative may replace the print head. See “Chapter 3: Solving
Problems” to determine if the print head needs to be replaced.
```
### Impact Print Head

```
The bi-directional, impact print head is designed for a very long life, but it may be
replaced if needed. Only a trained service technician may replace the impact print head.
See “Chapter 3: Solving Problems” to determine if the print head needs to be replaced.
```

7167 Owner’s Manual Chapter 1: About the 7167 Printer

```
November 2003 6
```
### Ordering Paper and Supplies........................................................................................................

```
Thermal receipt paper, ribbon cassettes, and forms can be ordered. Documentation is also
available.
```
#### Ordering Thermal Receipt Paper

```
The 7167 requires NCR qualified thermal paper to be used on the thermal receipt print
station to insure proper operation of the printer. In addition the paper rolls must be have
the following dimension.
```
```
Diameter Length Width
80 mm max. (3.15 in.) 83 meters (273 ft.) 80 mm ± .5 mm (3.15 ± .008 in.)
The paper must not be attached at the core. Otherwise the receipt station will be damaged
when the paper is exhausted.
```
```
Paper grades available from NCR
```
```
Paper Stock Paper Grade Description
```
```
856911 Economy (for text printing)
856966 Standard Sensitivity (for text and simple graphics)
878559 High Sensitivity (for text, bar codes & detailed graphics)
856380 For improved archiveability and added resistance to
incompatible substances
856461 Red/Black
856458 Blue/Black
```
```
The paper must not be attached at the core. Otherwise the receipt station will be damaged
when the paper is exhausted.
To order thermal receipt paper, contact your sales representative or order from NCR at the
following address or toll free number:
NCR
Media Products Division
9995 Washington Church Road
Miamisburg, OH 45342
Voice: 1(800)543-8130 (toll free), or local listing of The NCR Media Products sales
office
```
```
It is critical that only certified thermal paper be used with this printer, otherwise damage
may result causing poor print quality or cause damage to the printer.
```

7167 Owner’s Manual Chapter 1: About the 7167 Printer

7 November 2003

Ordering Forms

```
The 7167 prints on single- or multiple-part forms in the slip station (up to five-part forms).
Forms and slips must meet the following requirements:
Front insertion (minimum):
```
```
51 mm (2.0 inches) wide
70 mm (2.75 inches) long
Side insertion (minimum):
```
```
203 mm (8.0 inches) wide
51 mm (2.0 inches) long
```
```
Single-ply forms should be on paper that is greater than 15 pounds
Multiple-part forms (up to five parts) should be no thicker than .406 mm
(.016 inches)
If multi-part formare used the cardstock must be the last ply of the form.
To order forms, contact your sales representative or order from NCR at the following
address or toll free number:
NCR
Media Products Division
9995 Washington Church Road
Miamisburg, OH 45342
Voice: 1(800)543-8130 (toll free), or local listing of The NCR Media Products sales
office
```
#### Ordering Ribbon Cassettes

```
To order ribbon cassettes, contact your sales representative or order from NCR at the
following address or toll free number:
NCR
Media Products Division
9995 Washington Church Road
Miamisburg, OH 45342
Voice: 1(800)543-8130 (toll free), or local listing of Media Products sales office
```
```
Stock Numbers: (purple ribbon cassette—8 million characters) 127022
(black ribbon cassette—5 million characters) 127035
```

7167 Owner’s Manual Chapter 1: About the 7167 Printer

```
November 2003 8
```
#### Ordering Other Supplies

```
Contact your NCR sales representative to order the supplies listed in the table.
```
```
Item Type Number
Power supply with attached cable to printer
and U.S. power supply cord
```
```
75 Watt Power Supply 7167-K331-V
```
```
Power supply ( w/o power cord) 75 Watt Power Supply 7167-K302-V
Power supply cord (to outlet) United States
International (no plug)
United Kingdom
S.E.V.
Australia
International (with plug)
```
##### 1406-C325-

##### 1416-C319-

##### 1416-C321-

##### 1416-C320-

##### 1416-C322-

##### 1416-C323-

```
RS-232C Communication Cables
9-pin to 9-pin (G11)
9-pin to 9-pin (G11)
9-pin to 9-pin (CG1)
```
```
0.7 meters
4.0 meters (13.2 feet)
4.0 meters (13.2 feet)
```
##### 1416-C359-

##### 1416-C266-

##### 1416-C879-

```
DC Plus Power Cable
DC Power from NCR POS Terminal (G11)
DC Power from NCR POS Terminal (G11)
DC Power from NCR POS Terminal (CG1)
```
```
1.0 Meters
4.0 Meters
4.0 Meters
```
##### 1416-C712-

##### 1416-C712-

##### 1416-C881-

```
USB Communication Cables
USB Type A to Type B Connector
USB Type A to Type B Connector
```
```
2.0 Meters
4.0 Meters
```
##### 1416-C528-

##### 1416-C528-

```
USB Plus Power Cables
USB/Plus Power to Type B Connector (G11)
USB/Plus Power to Type B Connector (G11)
USB/Plus Power to Type B Connector (CG1)
```
```
3.0 Meters
4.0 Meters
4.0 Meters
```
##### 1416-C713-

##### 1416-C713-

##### 1416-C880-

```
Extended Slip Table (Standard) 7167-K280-V
Cash Drawer 2189 2189-K002-V
(Switchable for
Drawer 1 or
Drawer 2)
Cash Drawer Cable Y Cable 1416-C372-
```
#### Ordering Documentation

```
Contact your sales representative to obtain the following documentation:
7167 Thermal Receipt and Impact Slip Printer: Parts Identification Manual (B005-0000-1408)
7167 Thermal Receipt and Impact Slip Printer: Service Manual (B0005-0000-1407)
(includes Troubleshooting Guide and the Preventative Maintenance Guide)
```

7167 Owner’s Manual Chapter 1: About the 7167 Printer

9 November 2003

### Cleaning the Printer

#### Cleaning the Cabinet

```
The external cabinet materials and finish are durable and resistant to these items:
Cleaning solutions
Lubricants
Fuels
Cooking oils
Ultraviolet light
There is no scheduled maintenance required for the 7167.
Clean the cabinet as needed to remove dust and finger marks. Use any household cleaner
designed for plastics, but test it first on a small unseen area. If the receipt bucket is dirty,
wipe it with a clean, damp cloth.
```
#### Cleaning the Thermal Print Head

```
Caution: Do not spray or try to clean the thermal print head or the inside of the printer
with any kind of cleaner as this may damage the thermal print head and electronics.
If the thermal print head appears dirty, wipe it with cotton swabs and isopropyl alcohol.
If spotty or light printing problems persist after the thermal print head has been cleaned,
see “Chapter 3: Solving Problems” for more information.
Note: The thermal print head does not normally require cleaning if the recommended
paper grades are used. If non-recommended paper has been used for an extended period
of time, cleaning the print head with cotton swabs and rubbing alcohol will not be of much
benefit. See “Ordering Paper and Supplies” earlier in this manual for recommended paper.
```
#### Cleaning the Scanner Sensor

```
Caution: Do not spray or try to clean the thermal print head or the inside of the printer
with any kind of cleaner as this may damage the scanner sensor and electronics.
If the scanner sensor appears dirty, wipe it with cotton swabs and isopropyl alcohol.
If spotty or light printing problems persist after the scanner sensor has been cleaned, see
“Chapter 3: Solving Problems” for more information.
Note: The scanner sensor does not normally require cleaning if the recommended paper
grades are used. If non-recommended paper has been used for an extended period of time,
cleaning the print head with cotton swabs and isopropyl alcohol will not be of much
benefit. See “Ordering Paper and Supplies” earlier in this manual for recommended paper.
```


```
7167 Owner’s Manual Chapter 3: Solving Problems
```
```
3 November 2003
```
Chapter 2: Setting Up and Using the Printer

### What Is in the Box?......................................................................................................................

```
The following items are packed in the shipping box:
```
- Printer enclosed in a plastic bag and foam pack
- Ribbon cassette
- Thermal receipt paper roll

```
Cardboard restraint for carriage (behind front cover)
```
```
These items may be ordered as options from NCR and will be shipped separately:
```
- Communication cable (from host computer to printer)
- DC Power Cable
- Remote Power Supply
- USB plus Power Cables
- Cash drawer cables (may be ordered from other equipment suppliers: see “Ordering Other
    Supplies” in chapter 1)


7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 4
```
#### Removing the Packing Material

1. Remove the printer from the foam pack and plastic bag.
2. Open the front cover and remove the carriage holder.

```
Receipt
Cover
```
```
Carriage
Holder
```
```
Head Gap
Holder
```

7167 Owner’s Manual Chapter 3: Solving Problems

5 November 2003

3. Remove the head gap holder from the slip table.
4. Remove the ribbon cassette / receipt paper roll and cables from the foam packing material.
5. Save all packing materials for future storing, moving, or shipping the printer.

**Caution:** Remove the carriage holder and the head gap holder before using the printer.

Do not pickup the printer using the slip table as a handle.

#### Re Packing the Printer

Review the illustrations on the previous pages to pack the printer.

1. Place receipt paper between the receipt cover and the print head for protection.
2. Remove the ribbon cassette, move the carriage to the corner, and place the cardboard restraint in

```
the slip carriage area.
```
3. Place the cardboard support on the slip table.
4. Place the printer in the plastic bag and foam pack, place the packed printer in the box, and secure

```
the box with packing tape.
```
5. If you are sending the printer to NCR for repair, call your NCR-authorized service representative
    for instructions on where to send the printer.

```
Be prepared to answer questions concerning shipping and billing.
```
### Choosing a Location

The 7167 printer takes up relatively little counter space and may be set on or near the host computer.

Make sure there is enough room to open the receipt cover to change the paper and to open the front

cover to change the ribbon cassette. The illustration shows the actual dimensions of the printer, but
leave several inches around the printer for connecting and accessing the cables.

**Note:** The optional Magnetic Ink Character Recognition (MICR) check reader feature is designed to
operate under a normal operating environment with a host computer. However, additional devices,

such as CRT monitors, or large metal surfaces that are near the printer can affect the printer's

magnetic field, causing intermittent reading errors when the MICR check reader is in operation.
Relocating these devices may be required to prevent this interference.


7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 6
```
#### c) Wall mounted Power Supply (Option)

```
The 75 watt power supply may be mounted on a vertical wall by using the holes on the cover.
Mount the screws on the wall using the following recommended mount dimensions. Use a #8 wood
screw which is to be securely fastened to a wall stud or using “Molly” fasteners (not provided).
```
```
316.20 mm
(12.50 in.)
```
```
190 mm
(7.50 in.)
```
```
174 mm
6.85 in.)
```
```
175mm (6.89 in)
```
```
75mm
(2.95 in)
```
```
10mm (.39 in)
```

7167 Owner’s Manual Chapter 3: Solving Problems

7 November 2003

### Setting Switches...........................................................................................................................

The DIP switches, located at the back of the printer, are used for three purposes:

- To set variables for several printer functions (see the sections for the various printer functions in

```
“Level 1 Diagnostics” in “Chapter 4: Diagnostics” for Setting Up The Printer)
```
- To perform diagnostic tests (see the sections for the various diagnostic tests in “Level 1

```
Diagnostics” in “Chapter 4: Diagnostics” for Setting Up The Printer)
```
**Caution:** The DIP switches are set to OFF.

**Note:** Switch 1 is shown in the Off position for reference.

Use a paper clip or other pointed object to set the switches.

1. Set the switches to the desired settings shown in the table.
2. Reset the printer.

#### Printer Reset

The printer is reset by disconnecting/reconnecting the DC power or by opening the slip door and
closing the slip door while holding the receipt paper feed button down.

```
DIP Switch
```
```
Switch 1 is shown in
the OFF position
```
```
Bottom 2 1 ON
Cover
```
```
Back of Printer
```

7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 8
```
```
DIP Switch Settings
Switch 1 Settings Switch 2 Settings Printer State
```
```
OFF (0) OFF (0) On-line Mode (default)
```
```
ON (1) OFF (0)
Diagnostic Mode
```
```
OFF (0) ON (1) *
Flash Download Mode
```
```
ON (1) ON (1)
Vendor Adjustment Mode
```
- It is optional to set this switch to ON when reflashing the IPL firmware.


7167 Owner’s Manual Chapter 3: Solving Problems

9 November 2003

### Connecting the Cables

There are three different types of cables that connect to the printer:

- Power supply cable supplying power from the host POS terminal or from a external power supply
- Communication cable (RS-232 or USB) connecting the printer to the host computer
- Cash drawer cable connecting the printer to one or two cash drawers

**Caution:** Disconnect the power before connecting the cables. Always connect the communication

cable and cash drawer cables before connecting power to the power source. Always disconnect

power to the power source before disconnecting the communication and cash drawer cables.

Follow these steps to connect the cables. See the illustration on the next page.

1. Unplug the power cable from its power source.
2. Connect the power and communication cables to their respective connectors under the printer as
    shown in the illustration.

```
For RS232 cable, be sure to screw the communication cable to the communication connector.
```
3. Route the cables through the cable strain relief on the bottom of the printer, then through the two
    slots in the cable access cover as shown in the illustration.
4. Connect the communication cable to the appropriate host computer connector.
5. Connect the cash drawer cable to the printer and cash drawer.

```
The connectors is a standard phone jack located at the rear of the printer.
```
6. For Host powered installation plug the DC cable into the POS terminal or plug the power cord

```
into the power supply for remote power supply installation, then plug the power supply into an
outlet.
```
At this point, the printer receives power. If the On Line LED (green) is on, the printer is on-line.

Otherwise, the printer is not receiving power. Check to insure that the host terminal is on or that the
power supply is on.


7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 10
```
```
Bottom of the printer
```
```
Cash Drawer
Connector
```
```
Communication Power Cable DIP Switch
Cable
```
```
USB Cable
```
```
Power
Connector
```
```
Communication
Connector
```
```
USB
Connector
```
```
Cash Drawer
Connector
```
```
Power Cable DIP Switch
```
```
Power
Connector
```
```
RS-232 Cable Connection
```
```
USB Cable Connection
```
```
Cash Drawer
Cable
```
```
Cash Drawer
Cable
```

7167 Owner’s Manual Chapter 3: Solving Problems

11 November 2003

### Using the Printer

**Note:** See “Setting Switches” earlier in this book for instructions on setting the DIP switches.

1. Connect the power supply cable to the printer and turn on the power source.

```
The printer goes through a self-test routine to ensure everything is working properly then
“beeps.” After the printer has completed its “startup” cycle, it is ready to receive data.
```
```
If the LED blinks, or the host computer indicates that there is a problem, see “Chapter 3: Solving
Problems” for more information.
```
2. To perform a Configuration check (optional), reset the printer while holding the Paper Feed
    Button, or open the receipt door and while pressing the paper feed button close the receipt door,
    let go of the Paper Feed Button once the printing begins.

**Note:** The printer receives power when the power supply is on even if the printer is off-line. To
completely remove power, unplug the power supply from the outlet, or turn the POS terminal off.

```
LED
```
```
Paper Feed
Button
```

7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 12
```
### Loading and Changing the Receipt Paper

Although the illustrations show a used roll being removed, the instructions apply to loading paper for

the first time.

Change the paper when either of the following two conditions occurs:

- LED blinks (slow): the paper is low

```
There are approximately 1 ½ to 7 ½ meters (5-25 feet) of paper remaining on the roll. Change the
paper as soon as possible to avoid running out part way through a transaction.
```
```
Depending on the application program, the host computer may alert you when the paper is low.
```
- LED blinks (fast): the paper is out

```
Change the paper immediately or data may be lost.
```
**Caution:** Do not operate the printer or host computer if the printer runs out of paper. The printer will

not operate without paper, but it may continue to accept data from the host computer. Because the
printer cannot print any transactions, the data may be lost.


7167 Owner’s Manual Chapter 3: Solving Problems

13 November 2003

#### Removing the Paper Roll...................................................................................................

1. Open the receipt cover.
2. Remove the used roll.

```
Receipt
cover
```

7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 14
```
#### Loading the Paper Roll

**Note:** Tear off the end of the new roll so that the edge is loose.

1. Place the new roll in the bin with a little extra paper extending over the front.

```
Be sure the paper unrolls from the bottom of the roll. Otherwise the paper will not be printed on
because the thermal coating will be on the wrong side.
```
2. Close the receipt cover.
3. Remove the excess paper by tearing it against the tear-off blade.

### 1

### 2


7167 Owner’s Manual Chapter 3: Solving Problems

15 November 2003

#### Advancing Paper

1. Press the Paper Feed button on the operator panel to advance the paper.

```
The cover must be closed. To ensure print quality and the proper alignment of the paper, advance
about 30 cm (12 inches) of paper.
```
2. Tear off the excess paper against the tear-off blade.

### 3


7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 16
```
### Installing and Changing the Ribbon Cassette

Change the ribbon cassette when the print is too light or the ribbon is frayed.

#### Removing the Ribbon Cassette..........................................................................................

1. Open the front cover.
2. Use the handle on the cassette and pull the cassette from the printer.

```
Front
Cover
```
```
Ribbon
Cassette
```
```
Handle
```
```
Slot
```
```
Slot
```

```
7167 Owner’s Manual Chapter 3: Solving Problems
```
```
17 November 2003
```
#### Installing the Ribbon Cassette

1. Tighten the ribbon by turning the knob in the direction of the arrow.
2. Position the ribbon cassette slot at the catch on the printer slip frame and push it into place.

```
Be sure the ribbon is in front of or underneath the print head and between the print head and the
ribbon shield.
```
```
Tighten the ribbon using the shaft at the upper left corner of the cassette. Rotate the shaft
clockwise until the ribbon is positioned between the print head and the metal ribbon guide.
```
3. Close the front cover.

```
Catch
Cantilever Frame
```
```
Front
Cover
```
```
Slot
```
### 1

### 2

### 3

```
Slot
```
```
Slot
```
```
Catch
```

7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 18
```
### Printing on Forms or Checks

There are several types of transactions that require you to insert a form or check into the printer:

- Credit card transaction (some credit card transactions may be printed on the receipt station and

```
not require any forms)
```
- Multiple-part forms such as credit transactions or merchandise returns
- Electronic funds transfers
- Check printing (printing the date, payee, and amount on the check face)
- Check endorsement

Although the illustration on the facing page shows a check being inserted into the printer, the

instructions apply to any type of form. The 7167 can print on forms up to five-parts thick. See

“Ordering Forms” in chapter 1 for more information about the type of forms that can be used.

1. Insert the form or check (check shown in the illustration) from the front and place it on the slip

```
table top first and with the print side up.
```
```
If the form is extra long, you may need to insert it from the side.
```
2. Slide the form or check to the right until it lines up against the slip guide.

```
If the form is extra long, you need to slide it over the form stop to disengage it. In this situation
use the mark that is located on the slip door to align the form for printing in the proper location on
the form.
```
3. Slide the form or check toward the back of the printer until it contacts the form stop (it won't be

```
able to go any further);
```
```
Or, align the form or check with the mark on the slip door.
```
```
The green LED on the slip table turns on when the form or check is properly inserted (the form
has to cover two sensors on the slip table).
```
4. Follow the instructions from the host computer.

```
The printer begins printing.
```
5. Remove the form or check after it has been fed back out.
6. Follow the instructions from the host computer to finish the transaction.


7167 Owner’s Manual Chapter 3: Solving Problems

19 November 2003

```
Guide
```
```
Extended
Slip Table
```
```
LED
```

7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 20
```
### Validating and Verifying Checks...............................................................................................

**Note:** If the MICR check reader feature is present, checks are verified then validated.

1. Insert the check from the front and place it on the slip table face down as shown in the illustration

```
on the facing page.
```
2. Slide the check to the right until it lines up against the guide (wall).
3. Slide the check toward the back of the printer until it contacts the form stop (it won't be able to go

```
any further);
```
```
Or, align the check with any preset mark you may have made on the slip table.
```
```
The green LED on the slip table turns on when the form or check is properly inserted (it has to
cover two sensors on the slip table).
```
4. Follow the instructions from the host computer.

```
If the MICR check reader feature is present, the check is fed in and out while the check numbers
are read. If the check is verified as good, it is then validated. If the check is not verified as good, it
is not validated.
```
**Note:** Do not hold or keep the check from moving during the MICR check reader transaction or the
check numbers will not be read accurately.

5. Remove the check after it has been fed all the way back out.
6. Follow the instructions from the host computer to finish the transaction.


7167 Owner’s Manual Chapter 3: Solving Problems

21 November 2003

```
LED
```
```
Guide
Extended
Slip Table
```

7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 22
```
### About the Universal Serial Bus..................................................................................................

The Universal Serial Bus (USB) is a peripheral bus for personal computers that was first released in

January 1996. Since that time, virtually all Intel Architecture personal computers have the hardware to

support USB, and a large number of computers exist that have both the hardware and software
support required to interface with USB peripherals.

#### Advantages of USB connections

USB has a number of advantages over legacy connection schemes (e.g., serial RS-232). These

advantages include:

- High Speed: up to 12 MB/second for high-speed devices.
- Plug and Play: Devices are automatically recognized and configured at installation.
- Hot plug: Bus supports installation and removal of devices with the power applied.
- Up to 127 devices: One host can support up to 127 devices with the use of hubs.
- “Free ports”: Most PC architecture machines contain two USB ports in the base hardware.

These advantages have become attractive to the POS industry for a couple of reasons.

**Additional POS devices.** Some POS systems are required to host more peripherals than can be
supported by two RS-232 ports typical in a platform. With the addition of one (or two) USB

connectors, the platform can now support the additional devices that had previously required a serial

port expander card.

**Higher bandwidths.** New devices coming into use have bandwidth requirements that are higher

than the bandwidth that can be supported on legacy interfaces. These devices include image scanners

and printers. As the speed and capability of POS printers increases, the performance of the printer in
an application can become limited by the speed of the communications interface. USB provides ample

bandwidth to support current and future POS printer requirements.

#### Advantages of the NCR USB Solution..............................................................................

NCR has eliminated any cost associated with porting applications to USB by implementing a USB
solution that simulates standard serial communications in Windows 98 (SR2), Windows 98 USB Hot

Patch, ID: Q236934, NT 4.0 (Service Pack 3 or higher) and Windows 2000. Application developers

need only redirect their software to the virtual serial ports created by the NCR USB solution to use the
printer.


7167 Owner’s Manual Chapter 3: Solving Problems

23 November 2003

### Checking for USB Support on the Host Computer

If the USB interface communications is required, the host computer must be equipped and setup

properly. If it is not, you need to install a USB interface card. With the required hardware in place,

Windows 98 (SR 2), Windows 98 USB Hot Patch, ID: Q236934, NT 4.0 (Service Pack 3 or higher) and
Windows 2000 natively support plug-and-play USB with a built-in driver; Windows NT does not, and

the NCR windows NT USB driver needs to be installed.

**IMPORTANT: You need to have internet access to download the USB drivers from the NCR Web**

**site://www.NCR.com**

#### Host Configuration

Verify that the proper hardware has been installed in the host terminal.

**Windows 98:**

1. Open the Control Panel.
_2._ Click on System (Windows 98).
_3._ Click the Device Manager tab.
4. In the Device Manager window, scroll down the list of installed hardware devices until you find

```
an entry for “Universal serial bus controller.”
```
If this entry exists, your host computer is set up for USB operation. If this entry does not appear:

- Consult your computer documentation to see if USB must be enabled in the BIOS setup.

Windows NT:
To see if your POS terminal is USB-compliant, look at the back.

- If it has a USB connector port, your hardware is all set.

Note: Even though the host may have a USB port, Windows NT does not natively support plug-and-

play USB because it does not have a built-in driver. You will need to load the NCR Windows NT USB
driver (see “Installing the USB Printer Drivers”).

**Windows 2000:**

1. Open the Control Panel.
_2._ Click on System.
_3._ Click on Hardware.
_4._ Click the Device Manager tab.
5. In the Device Manager window, scroll down the list of installed hardware devices until you find
    an entry for “Universal serial bus controller.”

If this entry exists, your host computer is set up for USB operation. If this entry does not appear:


7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 24
```
- Consult your computer documentation to see if USB must be enabled in the BIOS setup.

### Installing the USB Printer Drivers

Windows NT users need to run Service Pak 3 or higher for a successful installation and should exit all
Windows programs before starting.

1. Verify that the printer is plugged in and the power is on.
2. The installation varies depending on the operating system.

**Windows 98**

Follow the on-screen instructions. The printer beeps when the USB device is recognized. Go to the

location where you downloaded the drivers and double click the file.


7167 Owner’s Manual Chapter 3: Solving Problems

25 November 2003


7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 26
```
Note: Location of the IONetworks files on the CD-ROM may very depending on the version of the CD that is
being used.


7167 Owner’s Manual Chapter 3: Solving Problems

27 November 2003

Also verify that you have the Windows 98 USB Hot Patch, ID: Q236934, created: 08-Jul-1999 and

modified: 10Aug-1999 installed. To verify if this hot patch is installed check file
c:\Windows\System32\Drivers\usbhub.sys. This file should be dated 08/13/99, size 36,672, version

4.10.22223.


7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 28
```
**Windows NT**

The printer beeps when it is plugged in to show the USB device is recognized. Click on the file you

downloaded and follow the on-screen instructions.


7167 Owner’s Manual Chapter 3: Solving Problems

29 November 2003


7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 30
```
**Windows 2000**

Follow the on-screen instructions. The printer beeps when the USB device is recognized. Go to the
location where you downloaded the drivers and double click the file.


7167 Owner’s Manual Chapter 3: Solving Problems

31 November 2003


7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 32
```
Note: Location of the IONetworks files on the CD-ROM may very depending on the version of the CD that is
being used.


7167 Owner’s Manual Chapter 3: Solving Problems

33 November 2003


7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 34
```
Note: Location of the IONetworks files on the CD-ROM may very depending on the version of the CD that is
being used.


7167 Owner’s Manual Chapter 3: Solving Problems

35 November 2003

### Checking the Installation

You need to verify that the device drivers were installed correctly:

**Windows 98:**

1. Open the Device Manager window, as you did in “Checking for USB Support.”
2. Scroll down to “Universal serial bus controllers.”

```
The following devices should be displayed:
```
- **NCR** 7167 Printer
- **NCR** 7167 Serial Ports [Port#] (where the # is the location of the printer)


7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 36
```
3. Scroll back up to “Ports.”

You should see a COM number and port description for the **NCR** printer.

If the devices are missing or are not listed correctly, the installation wasn’t successful. You will need
to reinstall the drivers.

**Windows NT:**

Go the Windows Start button and select Programs > InsideOut Networks Utilities > Edgeport

Configuration Utility. A window opens that contains the name of the printer, and the port

assignment.

If this information is not listed, then the installation was not successful. You will need to reinstall the

drivers.


7167 Owner’s Manual Chapter 3: Solving Problems

37 November 2003

**Windows 2000:**

1. Open the Device Manager window, as you did in “Checking for USB Support.”
2. Scroll down to “Universal serial bus controllers.”


7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 38
```
3. Scroll back up to “Ports.”

If the devices are missing or are not listed correctly, the installation wasn’t successful. You will need
to reinstall the drivers.

If this information is not listed, then the installation was not successful. You will need to reinstall the

drivers.


7167 Owner’s Manual Chapter 3: Solving Problems

39 November 2003

### Configuring Serial Port Number Assignments...........................................................................

This section described how the **NCR** USB solution assigns serial port numbers (e.g., COM _x_ ) to the

printer. The information that determines the assigned port number is stored in the host computer and

not in the printer. This assignment is made in one of three ways. The first method is the default
method that automatically assigns a serial port number to the printer. The other two methods require

the user to specify a port number. These methods are described more fully in “Serial Port
Configuration Methods” on the following page.


7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 40
```
#### Running the Edgeport Utility

You’ll need to run the Edgeport utility to check which serial port has been assigned to the printer.

This utility queries and configures the operating system and driver for the information regarding the

virtual serial port.

**Windows 98**

1. Open the Device Manager and make sure “View Devices By Type” is selected.
2. Scroll down to Universal serial bus controller, and expand the list by pressing the “+” symbol.

```
You’ll see two entries for your NCR printer.
```
3. Select the printer name and click Properties.
4. Select the Details tab, then press the Details button to start the Edgeport utility.

**Windows NT 4.0**

From the Windows Start menu, select Programs > Inside Out Networks Utilities > Edgeport

Configuration Utility.

**Windows 2000**

1. Open the Device Manager and make sure “View Devices By Type” is selected.
2. Scroll down to Universal serial bus controller, and expand the list by pressing the “+” symbol.

```
You’ll see two entries for your NCR printer.
```
3. Select the printer name and click Properties.
4. Select the Details tab, then press the Details button to start the Edgeport utility.

#### Serial Port Configuration Methods

**Automatic (Default)**. When the printer is plugged into the USB port of the host and the drivers are

loaded, the printer will default to the next available serial port number. In many cases this is exactly
what is desired. You can check the assigned serial port by clicking the General tab in the Edgeport

utility. You’ll see an entry for the NCR printer. Expand the list to see which serial port has been

assigned to the printer.

**Assigning a serial port to the printer.** If the default assignment does not meet the requirements of

the installation, you can assign a different serial port to the printer. From the General tab of the

Edgeport utility, select the printer and press Configure. Follow the directions on the resulting form to
assign a new port to the printer.

**Associating a serial port with a specific USB port.** (Windows 98 and NT) In certain installations it is

desirable to associate a serial port number with a specific USB port. This is particularly important if
multiple identical printers are installed on one host. Select the Advanced tab in the Edgeport utility,

and follow the instructions for configuring the serial port number based on the physical USB port.


7167 Owner’s Manual Chapter 3: Solving Problems

41 November 2003

#### Uninstalling the Drivers

**Windows 98:**

1. Open the Device Manager and make sure “View Devices By Type” is selected.
2. Scroll down to Universal serial bus controller, and expand the list by pressing the “+” symbol.
    You’ll see two entries for your NCR printer.
3. Select the printer name and click Properties.
4. Select the Details tab, then press the Details button to start the Edgeport utility.
5. Click the Advanced tab.
6. Click the Uninstall button and follow the on-screen instructions.

**Windows NT:**

Windows NT users will need to run the Edgeport Configuration Utility to uninstall the drivers.

1. Press Windows Start Menu button.
2. Choose Programs, then Inside Out Networks Utilities.
3. Choose Edgeport Configuration Utility.
4. Click the Advanced tab.
5. Click the Uninstall button and follow the on-screen instructions.

**Windows 2000:**

1. Open the Device Manager and make sure “View Devices By Type” is selected.
2. Scroll down to Universal serial bus controller, and expand the list by pressing the “+” symbol.

```
You’ll see two entries for your NCR printer.
```

7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 42
```
3. Select the printer name and click Properties.
4. Select the Details tab, then press the Details button to start the Edgeport utility.
5. Click the Advanced tab.
6. Click the Uninstall button and follow the on-screen instructions.


7167 Owner’s Manual Chapter 3: Solving Problems

43 November 2003

Chapter 3: Solving Problems

The 7167 printer is a simple, generally trouble-free printer, but from time to time minor problems may occur.
For example, the power supply may be interrupted or the thermal print head may overheat.

```
A green LED on the operator panel signals that something may be wrong.
For some problems, the printer communicates the information to the host computer and
relies on the application to indicate what the problem is.
The information on the following pages describes some problems that you may encounter:
problems that you can easily fix, and others that you will need to contact a service
representative for.
You may be able to correct many of the conditions or problems without calling for service.
However, if a problem persists, contact a service representative. See “Contacting a Service
Representative” at the end of this chapter.
```
### Green LED Does Not Come On/Printer Will Not Print

```
Problem What to Do Where to Go
Cables may not be connected
properly
```
```
Check all cable connections. Check that the
host computer and power supply are both on
(the power supply is turned on by plugging it
into an outlet).
```
```
See “Connecting the
Cables” in chapter 2.
```
```
Power supply may be defective If the power supply is plugged in, but does
not come on, you will need to order a new
power supply.
```
```
See “Ordering Other
Supplies” in chapter 1.
```

7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 44
```
### Green LED Blinking (Slow)

```
Problem What to Do Where to Go
Receipt paper is low* There are about 4 ½ meters, ± 3 meters, (15
feet, ± 10 feet) of paper left. Change the paper
soon to avoid running out of paper part way
through a transaction.
```
```
See “Loading and
Changing the Receipt
Paper” in chapter 2.
```
### Green LED Blinking (Fast)

```
Problem What to Do Where to Go
Receipt paper is out Change the paper now. Do not run a
transaction without paper as the data may be
lost.
```
```
See “Loading and
Changing the Receipt
Paper” in chapter 2.
Receipt cover or front cover is
open
```
```
Close the cover. The printer will not operate
with either of the covers open.
Knife failure Open the receipt cover and check the knife.
Clear any jammed paper you can see. Tear off
any excess paper against the tear-off blade.
```
```
Contact a service representative if this does
not resolve the problem.
```
```
See “Contacting a Service
Representative” later in
this chapter.
Paper jam in slip station Open the front cover and check the slip table
and under the carriage. Remove any paper
you see.
```
```
If you cannot see a paper jam or other
obstruction, contact a service representative.
```
```
See “Contacting a Service
Representative” later in
this chapter.
Paper jam in carriage Open Front Cover and clear paper from path.
Paper jam during flip If visible through Front Window, open access
door and clear paper jam, if not, open Front
Cover and clear jam.
```

7167 Owner’s Manual Chapter 3: Solving Problems

45 November 2003

```
AC supply voltage is out of
range
```
```
If paper is not low and no conditions indicate
that the thermal print head is too hot, then it is
likely that the power supply voltage is out of
range.
```
```
Contact a service representative if this does
not resolve the problem.
```
```
See “Contacting a Service
Representative” later in
this chapter.
```
```
Thermal print head temperature
is out of range
```
```
The print head may overheat when printing in
a room where the temperature is above the
recommended operating temperature or when
printing high-density graphics continuously,
regardless of the room temperature. In either
case, the printer will shut off.
```
```
If the temperature of the print head is too hot,
adjust the room temperature or move the
printer to a cooler location.
```
```
See “Environmental
Conditions” in Appendix
A for the recommended
temperature range for
operating the printer.
```
```
If the print head is overheating because of
printing high density graphics continuously,
reduce the demand on the printer.
```
```
If the printer continues to overheat, contact a
service representative.
```
```
See “Contacting a Service
Representative” later in
this chapter.
Power supply voltage is out of
range
```
```
If paper is not low and no conditions indicate
that the print head is too hot, the power
supply voltage is out of range. Contact a
service representative.
```
```
See “Contacting a Service
Representative” later in
this chapter.
```
### Slip or Forms Printing is Light

```
Problem What to Do Where to Go
Ribbon cassette is worn Replace the ribbon cassette.
```
```
Contact a service representative if this does
not resolve the problem.
```
```
See “Putting In and
Changing the Ribbon
Cassette” in chapter 2.
```
```
See “Contacting a Service
Representative” later in
this chapter.
```

7167 Owner’s Manual Chapter 3: Solving Problems

```
November 2003 46
```
### Receipt Printing is Light or Spotty

```
Problem What to Do Where to Go
Thermal print head may be dirty Open the receipt cover and clean the thermal
print head with cotton swabs and isopropyl
alcohol.
Caution: Do not use the alcohol to clean other
parts of the printer. Damage will occur.
Contact a service representative if this does
not resolve the problem.
```
```
See “Cleaning the Printer”
in chapter 2.
```
```
See “Contacting a Service
Representative” later in
this chapter.
```
```
Note: The thermal print head does not normally require cleaning if the
recommended paper grades are used. If non-recommended paper has been
used for an extended period of time, cleaning the print head with the
alcohol and cotton swabs will not be of much benefit. See “Ordering
Thermal Paper” in chapter 1 for recommended paper.
```
### LED (Slip Table) Does Not Come On

```
Problem What to Do Where to Go
Form or check not inserted
properly
```
```
Line up the form or check against the guide
(wall) and slide it toward the back of the
printer until it contacts the form stop and can't
go any further. Extra long forms may need to
be inserted from the side to disengage the
form stop.
```
```
Contact a service representative if this does
not resolve the problem.
```
```
See “Printing on Forms or
Checks” or “Validating
and Verifying Checks” in
chapter 2
```
```
See “Contacting a Service
Representative” later in
this chapter.
```
### Forms Skew or Catch

```
Problem What to Do Where to Go
Form or check skewing or
catching in slip station due to an
obstruction or paper jam
```
```
Open the front cover and check for any paper
jams or obvious obstruction in the slip station.
Clear the obstruction or jammed paper.
```
```
Contact a service representative if this does
not resolve the problem.
```
```
See “Contacting a Service
Representative” later in
this chapter.
```

7167 Owner’s Manual Chapter 3: Solving Problems

47 November 2003

### MICR Check Reader Not Reading Properly

```
Problem What to Do Where to Go
MICR (Magnetic Ink Character
Recognition) check reader does
not read or misreads checks
```
```
Open the slip cover and clean the MICR read
head with cotton swabs and isopropyl
alcohol.
```
```
See “Adjusting the MICR
Check Reader” in
chapter 4.
```
### Other Serious Problems

```
The following problems all need to be corrected by a qualified service representative. See
the next section, “Contacting a Service Representative.”
```
#### MICR Check Reader Commands

```
Forms not feeding into the slip/forms area properly
Missing dots in slip or forms printing
Printer will not cycle or stop when required
Illegible characters
Paper will not feed
Knife will not cycle or cut
Platen will not open or close
Printer will not communicate with Host
```
### Contacting a Service Representative

```
For serious problems, such as the printer not printing, not communicating with the host
computer, or not turning on, contact your NCR-authorized service organization to arrange
for a service call. In addition to the service manual listed below, other service-related
materials may be available. Contact your NCR-authorized service representative to obtain
the service manual.
7167 Thermal Receipt and Impact Slip Printer: Service Manual (B005-000-1407)
(includes the Troubleshooting Guide and the Preventative Maintenance Guide)
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 53
```
Chapter 4: Diagnostics

```
The following diagnostic tests are available for the 7167:
Level 0 Diagnostics (Startup)
Performed during the startup cycle.
Level 1 Diagnostics (Printer Configuration)
Allows configuration of the printer using a Configuration Menu that is printed on a receipt.
Level 2 Diagnostics (Runtime)
The printer checks the status of these conditions during normal operation.
Level 3 Diagnostics (Remote)
The printer keeps track of counters during normal operation.
Vendor Adjustment
Performed in off-line mode. Allows to change settings for mechanical and perform printer test.
Modifications of these settings are to be made by service personnel only.
```
### Level 0 Diagnostics

```
The printer automatically performs level 0 diagnostics when it is put on-line. Level 0
diagnostics comprise the following actions:
Motors are turned off.
Microprocessor timing is checked, CRC check of the firmware ROM is performed, external RAM is
read.
```
- The green LED on the slip table flashes once if this action succeeds.
- Level 0 diagnostics stop if this action fails. Failure is indicated by the printer going
    dead: knife and print head do not home, the platen does not open, LEDs are not
    lit, the printer is unable to communicate with the host computer.
- Knife is homed. A fault condition is caused if this action fails.
- Slip platen is opened.
- Slip print head is homed. A fault condition is caused if this action fails.
- The status of all sensors is checked, and the status bytes are updated.
If the printer has not been turned on before, the default values for the printer functions
will be loaded into the non volatile memory during level 0. These values can be changed
in level 1 diagnostics. See “Level 1 Diagnostics” for the functions and their settings.
When the last step is complete, the Paper Feed button is enabled and the printer is ready
for normal operation. Information about the tests is available to the communication
interface through the commands.


7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 54
```
### Level 1 Diagnostics

```
Level 1 diagnostics (setup mode) allow you to change the settings for various printer
functions and run certain tests.
Keep the following information in mind when changing the settings:
The settings can only be changed when the printer is in level 1 diagnostics (setup mode): Switch 1
must be set to On and Switch 2 must be set to Off.
The default options are set at the factory and are stored in the history non volatile memory
Once the settings have been changed and stored in the non volatile memory, the diagnostic setup
is exited which saves the settings.
Caution: If you are changing the printer settings, be sure they are the correct settings for
that particular function or test to avoid accidentally changing the settings for another
function or test. If the settings are accidentally changed you must reenter the setup mode
and reenter the correct settings. If you need assistance, contact a service representative.
See “Contacting a Service Representative” in chapter 3.
```
#### Printer Configuration

```
Printers are generally shipped with all appropriate configuration settings pre-set at the
factory. The only time the user should need to change the printer configuration is if a new
option is installed or the firmware is changed. It is also possible the user may need to run
certain tests using the Configuration Menu.
The user configures the printer using a convenient Configuration Menu that is printed on
receipt paper. The Configuration Menu prints instructions and setting options
interactively as the user goes through the configuration process. The following functions
and parameters can be changed with the scrolling Configuration Menu:
```
#### Configuring the Printer

#### Communication Interface Modes

```
Interface Type
Baud Rate
Number of Data Bits
Number of Stop Bits
Parity
Flow Control
Data Reception Errors
Receive Buffer
```
#### Diagnostic Modes

```
Off, Normal Mode
Datascope Mode
Slip Test Mode
Receipt Test Mode
MICR Test Mode
```
#### Check Flip Command

```
Print Head Gap Adjust Test Mode
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 55
```
#### Emulation/Software Options

```
Emulation
Printer ID
Default Lines Per Inch
Carriage Return Usage
Asian Mode^1
Slip Print Width
```
#### Receipt Station.................................................................................................................

```
Platen Waiting Time
Setting Hardware Options
Print Density
Maximum Power Option
Paper Low Sensor
Paper Width
Knife Options
```
#### MICR Parsing....................................................................................................................

```
Check Flip Option
Color Paper Option
MICR Dual Pass
Scan
```
#### Default Code Page

```
Setting EEPROM to default settings
```
(^1) Asian Mode isn’t supported by model 7167-1035 and 7167-2035.


7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 56
```
#### Configuring the Printer

```
Use the Configuration Menu to select functions or change various settings as indicated in
the preceding sections. The Configuration Menu prints instructions and setting options
interactively as the user goes through the configuration process.
Caution: Be extremely careful in changing any of the printer settings to avoid changing
settings that might affect the performance of the printer.
```
1. Set DIP Switch 2 to Off, Switch 1 to On.
2. Reset the printer.
For resetting the printer instruction see Chapter 2 page 13
This configuration menu allows you to set mechanical adjustment parameters and select
printer test.

```
Sub-menus are entered and selections are made using the Paper Feed Button.
```
- Short Click: Feed Button is quickly depressed and released
- Long click: Feed Button is held down more than 1 second

```
Press the paper feed for the configuration you want.
Defaults are marked with asterisk (*).
```
```
******** Main Menu ********
*******************************
```
```
Select a sub-menu:
```
- EXIT -> 1 Click
- Print Current Configuration -> 2 Clicks
- Set Communication Interface -> 3 Clicks
- Set Diagnostics Modes -> 4 Clicks
- Set Emulation/Software Options -> 5 Clicks
- Set Hardware Options -> 6 Clicks
- Set Default Code page -> 7 Clicks
- Set EEPROM To Default Settings -> 8 Clicks

```
Enter code, then hold Button DOWN
at least 1 second to validate
```
```
Bottom
Cover
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 57
```
Configuration Menu and Print Test samples (show approximately 60% of size).

```
7167
A991703053
```
```
V00.17
C525
V03.12
0EFF
```
```
2Mbytes
256Kbytes
64Kbytes
64Kbytes
```
```
RS232/USB
```
```
9600
8
1
None
DTR/DSR
Print ‘?’
4K Bytes
OFF, Normal Mode
```
```
7158 Native Mode
7158 Native ID
7.52
```
```
To enter Diagnostics Mode:
1) Flip DIP switch #1 on
2) Reset the printer by pressing
and holding the Receipt Feed switch
down while disconnecting and
reconnecting the power.
```
```
*** Diagnostics Form ***
Model number
Serial number
```
```
Boot Firmware
Revision
CRC
Flash Firmware
Revision
CRC
Hardware
Flash Memory Size
Flash Logos Size
Flash Fonts Size
Flash User Storage
Communication Interface
Interface Type
Parameters
Baud Rate
Data Bits
Stop Bits
Parity
Flow Control
Reception Errors
Receive Buffer
Diagnostic Mode
Emulation/Software
Printer Emulation
Printer ID Mode
Default LPI
```
```
*** Printer Config Menu ***
The config menu allows you to set
general printer parameters. Sub-menus
are entered and selections are made
using the Paper Feed Button:
```
- Short Click : Feed Button is
    quickly depressed
    then released.
- Long Click : Feed Button is held
    Down more than 1sec
    then released.

```
CAUTION !!
The settings are predetermined in
factory and should generally not be
changed to avoid changing other
functions.
**************
************* Main Menu *************
*****************************************
Select a sub –menu:
```
- EXIT 1 Click
- Print Current Configuration 2 Clicks
- Set Communication Interface 3 Clicks
- Set Diagnostics Modes 4 Clicks
- Set Emulation/Software 5 Clicks
- Set Hardware Options 6 Clicks
- Set Default Code Page 7 Clicks
Set EEPROM To Default 8 Clicks

```
Enter code, then hold Button DOWM
at least 1 second to validate
```
```
Important: Ensure that the
configuration settings match
your host computer, if not,
enter the Configuration Menu
to make changes.
```
```
: : : : : : : : : : : : : : : : : : : : : :
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 58
```
4. Press the Paper Feed Button to make the selections.
    The instructions indicate whether to select something with a short click, a long click,
    or a series of short clicks. Indicate Yes with a long click, No with a short click.

```
Press and hold the Paper Feed Button for at least one second for a long click. Press the
Paper Feed Button quickly for a short click.
```
5. When finished, set DIP Switch 1 to Off and reset printer.

#### Communication Interface Modes

```
The Configuration Menu gives the user the option of setting the printer to use an RS-232C
serial port. (See “Configuring the Printer” for instructions on how to enter the
Configuration Menu.)
```
```
RS-232C Interface Settings
If the user sets the printer to use an RS-232C serial interface, the Configuration Menu can
be used to set the following RS-232C specific settings:
Set the baud rate to 115200, 57600, 38400, 19200, 9600, 4800, 2400, or 1200 baud
Set the number of data bits to seven or eight
Set the number of stop bits to one or two
Enable or disable parity
Set flow control to software (XON/XOFF) or Hardware (DTR/DSR)
Set the printer to ignore data errors or print a “?” upon encountering an error
The settings used will depend on the software the operator is using and the capabilities of
the host computer.
```
```
Press the paper feed button for the communications settings you want.
Defaults are marked with asterisks (*).
```
##### ** SET INTERFACE TYPE?

```
YES -> Long Click
NO -> Short Click
```
```
RS232/USB* -> 1 Click
RS232 -> 2 Clicks
USB -> 3 Clicks
Enter code, then hold Button Down
At least 1 second to validate
```
```
** SET BAUD RATE?
YES -> Long Click
NO -> Short Click
```
```
115200 Baud -> 1 Click
57600 Baud -> 2 Clicks
38400 Baud -> 3 Clicks
19200 Baud -> 4 Clicks
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 59
```
```
More -> 5 Clicks
Enter code, then hold Button DOWN
At least 1 second to validate
```
```
9600 Baud* -> 1 Clicks
4800 Baud -> 2 Clicks
2400 Baud -> 3 Clicks
1200 Baud -> 4 clicks
Enter code, then hold Button DOWN
At least 1 second to validate
```
```
** SET NUMBER OF DATA BITS?
YES -> Long Click
NO -> Short Click
```
```
8 Data Bits* -> Long Click
7 Data Bits -> Short Click
```
```
** SET NUMBER OF STOP BITS?
YES -> Long Click
NO -> Short Click
```
```
1 Stop Bits* -> Long Click
2 Stop Bits -> Short Click
```
```
** SET PARITY?
YES -> Long Click
NO -> Short Click
```
```
No Parity* -> 1 Click
Even Parity -> 2 Clicks
Odd Parity -> 3 Clicks
Enter code, then hold Button DOWN
At least 1 second to validate
```
```
** SET FLOW CONTROL METHOD?
YES -> Long Click
NO -> Short Click
```
```
Software (XON/XOFF) -> Long Click
Hardware (DTR/DSR)* -> Short Click
```
```
** SET DATA RECEPTION ERRORS OPTION?
YES -> Long Click
NO -> Short Click
```
```
Ignore Errors -> Long Click
Print ‘?’* -> Short Click
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
```
Receive Buffer Size Option
This function allows the user to set the buffer size to a single line or a 4 K buffer.
```
```
Press the Paper Feed Button for the option you want.
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 60
```
##### ** SET RECEIVE BUFFER SIZE?

```
YES -> Long Click
NO -> Short Click
```
```
4K Buffer* -> Long Click
One Line -> Short Click
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
```
Save Parameters
This function allows to save the selected communication settings or return to the
communication settings to select additional options.
```
```
Press the Paper Feed Button for the option you want.
```
```
Save new parameters?
YES -> Long Click
NO, MODIFY -> Short Click
```
#### Diagnostic Modes

```
This function allows the user to put the printer into the following diagnostic modes:
OFF, Normal Mode: this is the normal operating mode of the printer.
Datascope Mode: the receipt printer prints incoming commands and data in hexadecimal format.
Slip test Mode: the slip printer prints two code pages.
Receipt Test Mode: the receipt printer prints two code pages.
MICR Test Mode: the receipt printer prints all characters recognized by the MICR.
Check Flip Test Mode: the check flip mechanism will flip an inserted check.
Print Head Gap Adjustment Mode: the slip printer prints several lines of rolling ascii even receipt
cover is open.
The diagnostic modes are enabled or disabled by using the Configuration Menu. See
“Configuration the Printer,” for instructions on how to enter the Configuration Menu.
```
```
Press the Paper Feed Button for the diagnostic mode you want.
```
```
** SET DIAGNOSTICS MODE?
YES -> Long Click
NO -> Short Click
```
```
OFF, Normal Mode* -> 1 Click
Data Scope Mode -> 2 Clicks
Slip Test Mode -> 3 Clicks
Receipt Test Mode -> 4 Clicks
More Options -> 7 Clicks
Enter code, then hold Button DOWN
At least 1 second to validate
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 61
```
```
MICR Test mode -> 1 Click
Check Flip Test mode -> 2 Clicks
Print Head Test Mode -> 3 Clicks
Enter code, then hold Button DOWN
At least 1 second to validate
```
```
Datascope Mode
Datascope Mode allows the user to test the printer’s communications. When in Datascope
Mode the printer receives all communications, but instead of executing the commands it
prints them out on receipt paper as hexadecimal numbers in the order received. For
example, the ASCII character “A” is printed as the hexadecimal number 41 an so on.
To run the Datascope Mode:
```
1. Enter the Configuration Menu. See “Configuring the Printer” for instruction on how to
    enter the Configuration Menu.
2. After you have enabled the Datascope Mode through the Configuration Menu, exit the
    Configuration Menu.
3. Run a transaction from the host computer.
    All commands and data sent from the host computer will be printed as hexadecimal
    numbers as shown in the illustration.
30 31 32 33 34 35 36 37 38 39 40 41 : 0 1 2 3 4 5 6 7 8 9 @ A
41 42 43 44 45 46 47 48 49 50 51 52 : A B C D E F G H I J K L

```
To exit the Datascope Mode:
```
1. Enter the Configuration Menu again
2. Disable the Datascope Mode
3. Exit the Configuration Menu
The printer is in Normal Mode and can communicate with the host computer.

```
Slip Test Mode
To run the Slip Test Mode:
```
1. Enable the Slip Test Mode through the Configuration Menu, (See “Configuring the
    Printer,” for instructions on how to enter Configuration Menu). Then exit the
    Configuration Menu.
2. Insert a slip into the slip station.
3. Push the Paper Feed Button
4. All code pages will be printed.
5. Go to step 2 again to repeat this test.
To exit the Slip Test Mode:
1. Enter the Configuration Menu again.
2. Disable the Slip Test Mode.


7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 62
```
3. Exit the Configuration Menu.
The printer is in the Normal Mode and can communicate with the host computer.

```
Receipt Test Mode
To run the Receipt Test Mode:
```
1. Enable the Receipt Test Mode through the Configuration Menu. See “Configuring the
    Printer,” for instructions on how to enter the Configuration Menu.
2. Push Paper Feed Button and the receipt station will print all code pages.
3. The test ends with a cut.
4. Go to step 2 again to repeat this test.
To exit the Receipt Test Mode:
1. Enter the Configuration Menu again.
2. Disable the Receipt Test Mode
3. Exit the Configuration Menu
The printer is in Normal Mode and can communicate with the host computer.

```
MICR Test Mode
MICR Test Mode allows the user to test whether the MICR is operating correctly. When
the printer is in this mode the MICR reads characters on a cheque as usual,but instead of
transmitting the values to the software it prints on receipt paper.
To run the MICR Test Mode:
```
1. Enter the Configuration Menu. See “Configuring the Printer,” for instructions on how
    to enter the Configuration Menu.
2. After enabling the MICR Test Mode through the Configuration Menu, exit the
    Configuration Menu.
3. Insert a check into the slip station. (See “Verifying and Validating Checks” section.)
4. The printer waits until a check is inserted and detected before the platen closes and
    the characters are read by the MICR check reader. The decoded data is printed on
    receipt paper, the platen is opened, and the test is re-started.
5. The printed numbers should match the numbers on the check. If the MICR check
    reader misreads a character, the test prints question mark “?”. If the MICR check
    reader is unable to read any characters, the test prints “NO MICR DATA TO
    DECODE.”

```
To exit the MICR Test Mode:
```
1. Enter the Configuration Menu again.
2. Disable the MICR Test Mode.
3. Exit the Configuration Menu.
    The printer is in the Normal Mode and can communicate with the host computer.

```
*** GOOD READ ***
MICR Data:
5001234UT33456789T 123 67 5
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 63
```
```
Check Flip Test Mode
To run the Check Flip Test Mode:
```
1. Enable the Check Flip Test Mode through the Configuration Menu (See “Configuring
    the Printer,” for instruction on how to enter the Configuration Menu), then exit the
    Configuration Menu.
2. Insert a check as if validating the check, lengthwise and face down into the slip
    station. (See “Verifying and Validating Checks” section to insert check.)
    A check must be used – if any other slip or form is inserted the printer will not
    conduct.
3. Push Paper Feed Button.
4. The check then goes through the flip routine only – no printing takes place.
To exit the Check Flip Test Model:
1. Enter the Configuration Menu again.
2. Disable the Check Flip Test Mode.
3. Exit the Configuration Menu
The printer is in Normal Mode and can communicate with the host computer.

```
Print Head Gap Adjustment Mode
Print Head Gap Adjustment Test Mode prints several lines of ‘H’ character. This is the slip
print testing during the print head gap adjustment. During adjustment, some covers will
be removed from the printer, even in this condition, slip printing need to be run when
paper is inserted. Print Head Gap Adjustment Test Mode is enabled and disabled using
the Configuration Menu.
To run the Print Head Gap Adjustment Test Mode:
```
1. Enable the Print Head Gap Test Mode through the Configuration Menu, (“See
    Configuring the Printer,” for instructions on how to enter the Configuration Menu.
2. Insert a slip into the slip station.

```
Extended Slip
Table
```
##### LED

```
Guide
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 64
```
3. Push Paper Feed Button.
4. Several lines of Rolling ASCII character will be printed.
Note: Printing will take place even when receipt cover is open.
5. Go to step 2 again to repeat this test.

```
To exit the Print Head Gap Adjustment Test Mode:
```
1. Enter the Configuration Menu again.
2. Disable the Print Head Gap Adjustment Test Mode.
3. Exit the Configuration Menu.
The printer is in Normal Mode and can communicate with the host computer.

```
Save Parameters
This function allows to save the selected diagnostics modes or return to the diagnostics
mode to select additional options.
```
```
Press the Paper Feed Button for the option you want.
```
```
Save new parameters?
YES -> Long Click
NO, MODIFY -> Short Click
```
#### Emulation/Software Options

```
Printer Emulations
Printer emulations determine the commands that are available to the printer. They are set
by using the Configuration Menu. (See “Configuring the Printer,” for instructions on how
to enter the Configuration Menu.). The available options are:
7158 Native Mode
7156 Mode
7150 Mode
7167 Mode
Press the Paper Feed Button for the emulation you want.
```
```
** SET EMULATION?
YES -> Long Click
NO -> Short Click
```
```
7158 Mode* -> 1 Click
7156 Mode -> 2 Clicks
7150 Mode -> 3 Clicks
7167 Native Mode -> 4 Clicks
```
```
Enter code, then hold Button DOWN
At least 1 second to validate
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 65
```
```
Printer ID Selections
Printer ID Selections determines the print ID that is returned from the printer. This is set
by using the Configuration Menu. (See “Configuring the Printer,” for instructions on how
to enter the Configuration Menu.). The available options are:
```
```
7158 Native ID
Emulated Print ID
7167 Native ID
```
```
Press the Paper Feed Button for the emulation you want.
```
```
** SET PRINTER ID MODE?
YES -> Long Click
NO -> Short Click
```
```
7158 Mode ID* -> 1 Click
Emulated Printer ID -> 2 Clicks
7167 Native ID -> 3 Clicks
Enter code, then hold Button DOWN
At least 1 second to validate
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection
```
```
Default Lines Per Inch
This function allows the user to set the default lines per inch printed by the thermal
printer to 6, 7.52 or 8.13. (See “Configuring the Printer” for instructions on how to enter
the Configuration Menu to change this setting.)
```
```
Press the Paper Feed Button for the lines per inch you want.
```
```
** SET DEFAULT LINES PER INCH?
YES -> Long Click
NO -> Short Click
```
```
8.13 Lines per Inch -> 1 Click
7.52 Lines per Inch* -> 2 Clicks
6 Lines per Inch -> 3 Clicks
Enter code, then hold Button DOWN
At least 1 second to validate
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
```
Carriage Return Usage
This function allows the printer to ignore or use the Carriage Return (hexadecimal 0D)
command depending on the application. Some applicatons expect the command to be
ignored while others use the command as a print command. (See “Configuring the
Printer” for instructions on how to enter the Configuration Menu to change this setting.)
```
```
Press the Paper Feed Button for the carriage return usage you want.
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 66
```
##### ** SET CARRIAGE RETURN USAGE?

```
YES -> Long Click
NO -> Short Click
```
```
Ignore CR -> Long Click
Use CR as Print Cmd* -> Short Click
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
```
Asian Mode*
This function makes it possible for the user to select an Asian character for the printer. (See
“Configuring the Printer” for instructions on how to enter the Configuration Menu to
change this setting.)
Note: For Asian code pages, only one (either 932, 936, 949 or 950)will exist in the
firmware.
```
```
Press the Paper Feed Button for the Asian mode you want.
```
```
** SET ASIAN MODE?
YES -> Long Click
NO -> Short Click
```
```
Asian Mode On -> Long Click
Asian Mode Off* -> Short Click
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
```
Slip Printing Width
This function allows for the 7167 printer to be set in a mode that allows for the printer to
drop the left 21 columns of data. For example if the printer was connected to an
application that was sending data for a 7158 printer which supports 66 columns of print
the 7167 printer could replace the 7158 without application changes.
```
```
Press the Paper Feed Button for the slip printing width option you want.
```
```
** SET SLIP PRINTING WIDTH?
YES -> Long Click
NO -> Short Click
```
```
7167 MODE* -> Long Click
7158/7156 MODE -> Short Click
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
* Not supported by 7167-1035 and 7167-2035


7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 67
```
```
Receipt Synchronization Mode
The standard mode for synchronization allows for verification of each line printed to the
host. When the receipt synchronization is disabled the printer will allow for maximum
print speed and ignore the verificaiton of each line printed.
```
```
Press the Paper Feed Button for the receipt synchronization mode option you want.
```
```
** SET RECEIPT SYNCHRONIZATON MODE?
YES -> Long Click
NO -> Short Click
```
```
Enable Receipt Sync.* -> Long Click
Disable Receipt Sync. ->Short Click
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
```
Platen Waiting Time
This function makes it possible for the user to select whether to select wait time which
paper detect from. (See “Configuring the Printer” for instructions on how to enter the
Configuration Menu to change this setting.)
```
```
Press the Paper Feed Button for the platen waiting time option you want.
```
```
** SET PLATEN WAITING TIME?
YES -> Long Click
NO -> Short Click
```
```
No Extra Time* -> 1 Click
Extra 1 sec -> 2 Clicks
Extra 2 sec -> 3 Clicks
```
```
Save Parameters
This function allows to save the selected emulations/software settings or return to the
emulations/software settings to select additional options.
```
```
Press the Paper Feed Button for the option you want.
```
```
Save new parameters?
YES -> Long Click
NO, MODIFY -> Short Click
```
#### Hardware Options..............................................................................................................

```
Print Density
This function makes it possible to adjust the energy level of the print head to darken the
printout. An adjustment should only be made when necessary. The factory setting is 100%.
Warning : Choose an energy level no higher than necessary to achieve a dark printout.
Failure to observe this rule may result in a printer service call or voiding of the printer
warranty. Consult your NCR technical support specialist if you have any questions.
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 68
```
```
Press the Paper Feed Button for the print density you want.
```
```
** SET PRINT DENSITY?
YES -> Long Click
NO -> Short Click
```
```
100 %* -> 1 Click
110 % -> 2 Clicks
120 % -> 3 Clicks
Enter code, then hold Button DOWN
At least 1 second to validate
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
```
Maximum Power Option
This function allows the user to set the maximum power for the printer to 75W or 55W.
```
```
Press the Paper Feed Button for the option you want.
```
```
** SET MAX POWER OPTION?
YES -> Long Click
NO -> Short Click
```
```
55W Power Supply* -> Long Click
75W Power Supply -> Short Click
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
```
Paper Low Sensor
Paper Low Sensor makes it possible to enable or disable the paper low sensor for
particular printer configurations.
```
```
Press the Paper Feed Button for the option you want.
```
```
** SET PAPER LOW SENSOR OPTION?
YES -> Long Click
NO -> Short Click
```
```
Enable Paper Low Sensor* -> Long Click
Disable Paper Low Sensor -> Short Clicks
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
```
Paper Width
This function allows the user to set the default paper width for the receipt thermal printer
to 58mm or 80mm wide.
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 69
```
```
Press the Paper Feed Button for the paper width option you want.
```
```
** SET PAPER WIDTH?
YES -> Long Click
NO -> Short Click
```
```
Paper Width = 80 mm* -> 1 Click
Paper Width = 58 mm -> 2 Clicks
Enter code, then hold Button DOWN
At least 1 second to validate
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
```
Knife Option
This option makes it possible to set the Knife Option if it is installed in the printer. This
setting should only be changed is the option is added or removed.
```
```
Press the Paper Feed Button for the option you want.
```
```
** SET KNIFE OPTION?
YES -> Long Click
NO -> Short Click
```
```
Enable Knife* -> Long
Disable Knife -> Short
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
#### MICR Commands............................................................................................................

```
This function makes it possible to set the MICR Option if it is installed in the printer. This
setting should only be changed if the option is added or removed.
```
```
Press the Paper Feed Button for the option you want.
```
```
** SET MICR OPTION?
YES -> Long Click
NO -> Short Click
```
```
Enable MICR* -> Long
Disable MICR -> Short
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
```
Check Flip Option
This function makes it possible to set the Check Flip Option if it is installed in the printer.
This setting should only be changed if the option is added or removed.
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 70
```
```
Press the Paper Feed Button for the option you want.
```
```
** SET CHECK FLIP OPTION?
YES -> Long Click
NO -> Short Click
```
```
Enable Check Flip* -> Long
Disable Check Flip -> Short
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
```
Color Paper Option
This function allows the user to set the color paper for the receipt thermal printer to one
color paper or two color paper.
```
```
Press the Paper Feed Button for the option you want.
```
```
** SET COLOR PAPER OPTION?
YES -> Long Click
NO -> Short Click
```
```
Monochrome* -> Long Click
Color Paper -> Short Click
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
```
MICR Dual Pass Option
This function allows the user to set the dual pass MICR option.
```
```
Press the Paper Feed Button for the MICR dual pass option you want.
```
```
** SET MICR DUAL PASS OPTION?
YES -> Long Click
NO -> Short Click
```
```
Enable Dual Pass -> Long Click
Disable Dual Pass* -> Short Click
```
```
Scan Option
This function allows the user to set Scan option either enabled or disabled.
```
```
Press the Paper Feed Button for the option you want.
```
```
** SET SCAN OPTION?
YES -> Long Click
NO -> Short Click
```
```
Enable Scan* -> Long Click
Disable Scan -> Short Click
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 71
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
```
Save Parameters
This function allows to save the selected hardware settings or return to the hardware
options to select additional options.
```
```
Press the Paper Feed Button for the option you want.
```
```
Save new parameters?
YES -> Long Click
NO, MODIFY -> Short Click
```
#### Default Code Page

```
This function makes it possible to select the default code page.
```
```
These are the code pages available for printing:
Code page 437 (US English)
Code page 850 (Multilingual)
Code page 852 (Slavic)
Code page 858 (with Euo symbol)
Code page 860 (Portuguese)
Code page 862 (Hebrew)
Code page 863 (French Canadian)
Code page 864 (Arabic)
Code page 865 (Nordic)
Code page 866 (Cyrillic)
Code page 874 (Thai)
Code page 1252 (Windows Latin #1)
Code page Katakana
Code page 932 (MS Japan)^ *
Space page
Note: For Asian code pages, code page 936, 949, or 950 replaces code page 932. Only one
Asian code page (either 932, 936, 949, 950) will exist in firmware.
```
```
Press the Paper Feed Button for the Default Code Page you want.
```
```
** SET CODE PAGE?
YES -> Long Click
NO -> Short Click
```
```
FOR 7158 Mode:
```
```
Code Page 437* -> 1 Click
Code Page 850 -> 2 Clicks
Code Page 852 -> 3 Clicks
```
* Not supported by 7167-1035 and 7167-2035


7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 72
```
```
Code Page 858 -> 4 Clicks
More Options -> 5 Clicks
Enter code, then hold Button DOWN
At least 1 second to validate
```
```
Code Page 860 -> 1 Click
Code Page 862 -> 2 Clicks
Code Page 863 -> 3 Clicks
Code Page 864 -> 4 Clicks
More Options -> 5 Clicks
Enter code, then hold Button DOWN
At least 1 second to validate
```
```
Code Page 865 -> 1 Click
Code Page 866 -> 2 Clicks
Code Page 874 -> 3 Clicks
Code Page 1252 -> 4 Clicks
More Options -> 5 Clicks
Enter code, then hold Button DOWN
At least 1 second to validate
```
```
Code Page Katakana -> 1 Click
Code Page 932* -> 2 Clicks
Enter code, then hold Button DOWN
At least 1 second to validate
```
```
FOR 7156 Mode:
```
```
Code Page 437* -> 1 Click
Code Page 850 -> 2 Clicks
Enter code, then hold Button DOWN
At least 1 second to validate
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
For Asian code pages*, code page 936, 949 or 950 replaces code page 932 in the above
shown menu. Only one Asian code page (Either 932, 936, 949 or 950) will exist in
firmware.
```
```
Save Parameters
This function allows to save the selected default code page selecton or return to the default
code page selecton to select additional options.
```
```
Press the Paper Feed Button for the option you want.
```
```
Save new parameters?
YES -> Long Click
NO, MODIFY -> Short Click
```
* Not supported by 7167-1035 and 7167-2035


7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 73
```
```
EEPROM to Default Settings
This selection resets the configuration to the Default Settings.
```
```
Caution: Be extremely careful changing any of the printer settings to avoid inadvertently
changing other settings that might affect the performance of the printer.
```
##### ** RESET EEPROM TO DEFAULT VALUES?

```
YES -> Long Click
NO -> Short Click
```
```
Note: Press the Paper Feed Button for at least one second to validate the selection.
```
```
Save Parameters
This function allows to save the selected default code page selecton or return to the default
code page selecton to select additional options.
```
```
Press the Paper Feed Button for the option you want.
```
```
Save new parameters?
YES -> Long Click
NO, MODIFY -> Short Click
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 74
```
### Level 2 Diagnostics....................................................................................................................

```
Level 2 diagnostics run during normal printer operation. When the following conditions
occur, the printer automatically turns off the appropriate motor, disables printing to
prevent damage, and turns on the green LED (flashes the green LED if the receipt print
head is too hot or the voltages are out of range):
Paper out
Cover open
Knife unable to go back to home position
Print head too hot
Power supply voltage out of range
Slip or flip motor jam
```
```
See “Chapter 3: Solving Problems” for more information about other conditions that may
occur and how to correct them.
```
```
Status LED Behaviour
Power Off Off
Firmware Download Very Fast Blink
Level 0 Diagnostics No Blink
Receipt Paper Low Slow Blink
Temperature Error No Blink
Voltage Error No Blink
Cover Open Fast Blink
Receipt Paper Out Fast Blink
Knife Jam Fast Blink, then Slow Blink
Slip Cover Open Fast Blink
Flip Cover Open Fast Blink
Receipt Cover Open Fast Blink
Slip Motor Jam Fast Blink
Flip Motor Jam Fast Blink
Slip Ribbon Carriage Error Fast Blink
All other states On
```

7167 Owner’s Manual Chapter 4: Diagnostics

```
November 2003 75
```
### Level 3 Diagnostics....................................................................................................................

```
Level 3 diagnostics keeps track of the following tallies and prints them on the receipt
during the receipt test. See “Sample Print Test” later in this chapter.
Serial number
Model number
CRC number
Number of receipt lines printed
Number of knife cuts
Number of slip lines
Number of slip characters
Number of MICR reads
Number of hours printer is on
Number of flash cycles
Maximum temperature reached
Number of cutter jams
Number of times the door is open
```

7167 Owner’s Manual Chapter 5: Communication

```
November 2003 75
```
Chapter 5: Communication

### Communication Overview

```
In order for a receipt to be printed, a program must be in place that translates the data
from the host computer into a language that the printer can understand. This program
must tell the printer exactly how to print each character. This chapter describes how to
create such a program or modify an existing one.
```
#### Interface

```
In order for the printer to communicate with the host, a communication link must be set
up. The 7167 supports the industry standard RS-232C communication interface. This
interface has a protocol associated with it that the host computer must understand and
adhere. The priner also supports USB communications.
Only when the interface parameters are matched and the proper protocol is used will the
host and the printer be able to communicate. See the section, “RS-232C Interface” on the
next page for a description of the protocol associated with the RS-232C interface.
```
#### Sending Commands...........................................................................................................

```
Once the communication link is established, commands can be sent to the printer. This
section describes how to send commands to the printer using DOS and BASIC. This
section does not take into account the necessary protocol, but is meant as a general
introduction to how the printer functions.
```
```
Using DOS to Send Commands
One way of getting commands to the printer is to send them directly from DOS. For
example, the command
COPY CON: COM1:
This sets the computer up such that the Hex code corresponding to any key that was
pressed would be sent to the RS-232C communication port COM1 when the COPY mode
is exited. If the printer is connected to COM1, then the data will go to the printer.
Exit the COPY mode by typing
CTRL Z
and then pressing the ENTER key. This directs the data from any print command to the
proper port, commands can be sent from any software program.
```

7167 Owner’s Manual Chapter 5: Communication

```
November 2003 76
```
```
Using BASIC to Send Commands
In BASIC, printer commands are sent as a string of characters preceded by the LPRINT
command. For example,
LPRINT CHR$(&H0A)
sends the hexadecimal number 0A to the printer, which causes the printer to print the
contents of its print buffer. Previously sent commands tell the printer exactly how this
data should appear on the paper. For example,
LPRINT CHR$(&H12); "ABC"; CHR$(&H0A)
sends the Hex numbers 12 41 42 43 0A to the printer. This causes the printer to set itself to
double wide mode (12), load the print buffer with “ABC” (41 42 43), and finally, print
(0A). Again, the communication link that the BASIC program outputs to must be matched
to that of the printer.
```
### RS-232C Interface

```
The RS-232C interface uses either XON/XOFF or DTR/DSR protocol. For XON/XOFF, a
particular character is sent back and forth between the host and the printer to regulate the
communication. For DTR/DSR, changes in the DTR/DSR signal coordinate the data flow.
The RS-232C version of the 7167 offers the standard options which are selectable in the
Diagnostic mode. See “Diagnostics: Communications Interface Settings” later in this book.
```
#### Print Speed and Timing

```
The fast speed of the printer requires the application to send data to the printer at least as
fast as it is printed. This application must also allow receipt lines to be buffered ahead at
the printer, so the printer can print each line immediately after the preceding line, without
stopping to wait for more data. Ideally, the application will send all the data for an entire
receipt without pausing between characters or lines transmitted.
If the application sends data at 9600 baud and pauses between lines for as little as 50
milliseconds, the printer will never be able to print at full speed. But, if the application
sends data at 19.2 K baud and does not pause between lines, the printer will be able to
print at its full speed of 1020 lines/minute.
The table shows that with a pause of 50 milliseconds after each line, the transmit time
equals or exceeds the print time, slowing down the printer, regardless of the baud rate.
```
```
Char./Line Lines/Receipt Transmit Time: (9600 Baud) Transmit Time: (19.2 K Baud) Print Time
20 20 1.4 Seconds 1.2 Seconds 0.5 Seconds
20 40 2.8 Seconds 2.4 Seconds 1.0 Seconds
44 20 1.88 Seconds 1.44 Seconds 1.1 Seconds
44 40 3.76 Seconds 2.88 Seconds 2.2 Seconds
The next table shows that with no delay between lines, the transmit time is much less than
the print time, allowing the printer to print at full speed.
```
```
Char./Line Lines/Receipt Transmit Time: (9600 Baud) Transmit Time: (19.2 K Baud) Print Time
20 20 0.4 Seconds 0.2 Seconds 0.5 Seconds
20 40 0.8 Seconds 0.4 Seconds 1.0 Seconds
44 20 0.88 Seconds 0.44 Seconds 1.1 Seconds
44 40 1.76 Seconds 0.88 Seconds 2.2 Seconds
```

7167 Owner’s Manual Chapter 5: Communication

```
November 2003 77
```
#### XON/XOFF Protocol.........................................................................................................

```
The XON/XOFF characters coordinate the information transfer between the printer and
the host computer. The printer sends an XON character when it is ready to receive data
and it sends an XOFF character when it cannot accept any more data. The software on the
host computer must monitor the communication link as shown in the following flowchart
in order to send data at the appropriate times.
If XON/XOFF has been selected, the printer also toggles the DTR signal, as described in
the next section, but it does not look at the DSR signal to transmit data.
```
```
XON character = Hex 11.
```
```
XOFF character = Hex 13.
```
#### DTR/DSR Protocol............................................................................................................

```
The DTR signal is used to control data transmission to the printer. It is driven low when
the printer is ready to recieve data and driven high when it cannot accept any more data.
Data is transmitted from the printer after it confirms that the DSR signal is low.
```
#### RS-232C Technical Specifications

```
This section describes the pin settings for the connectors and the RS-232C interface
parameters. The RS-232C parameters are selectable in the Diagnostic mode. See
“Diagnostics: Communications Interface Settings” in chapter 4 for the position of the DIP
switches. The RS-232C parameters must match those of the host.
```

7167 Owner’s Manual Chapter 5: Communication

```
November 2003 78
```
Connectors

#### Cash Drawer Connector and Pin Assignments

```
The illustration shows the RS-232C communication connector and pin assignments. The
connector is a 9-pin male D-shell connector and is located in the hollow cavity under the
printer at the rear.
```
#### RS-232C 9-Pin to 9-Pin Cable Diagram............................................................................

```
Note: This information is provided for testing and troubleshooting only.
```
```
Host
```
```
7167
Printer
```

7167 Owner’s Manual Chapter 5: Communication

```
November 2003 79
```
#### USB Cable Connector

```
The following illustration is for the USB Type B communication connector and pin assignment.
```
```
Pin No Signal
1 +5 V – USB
2 Data -
3 Data +
4 Ground
```
#### Power Cable Connector

```
The illustration shows the power cable connector and pin assignments. The power cable
connector is a 3-pin DIN plug and is located in the hollow cavity under the printer at the
rear.
```
```
Printer View End
```
```
2 1
```
```
3 4
```

7167 Owner’s Manual Chapter 5: Communication

```
November 2003 80
```
#### Cash Drawer Connector and Pin Assignments

```
The following illustration shows the pin out designation for the cash drawer connectors.
The following table provides the pinout assignments for cash drawers one and two. The
cash drawer connectors are located at the rear of the printer.
```
```
Pin 1 Pin 6
```
```
Pin Number Cash Drawer 1 Connector
```
```
1 Frame Ground
```
```
2 Drawer 1 Solenoid
```
```
3 Drawer 1 Status Switch
```
```
4 +24 Volts (to Solenoid +)
```
```
5 Drawer 2 Solenoid
```
```
6 Ground (Status Switch Return)
```

7167 Owner’s Manual Chapter 5: Communication

```
November 2003 81
```
```
Switch Settings
The DIP switches are located on the PC board at the back of the printer as shown in the
illustration in “Level 1 Diagnostics” in chapter 4. The switches are used to put the printer
into various modes for printer configuration set up.
```
```
Use a paper clip or other pointed object to set the switches.
```
1. Set the switches to the desired settings shown in the table.
2. Reset the printer.
**Caution:** Setting switch 1 to On puts the printer in level 1 diagnostics (setup mode) where
other functions and tests can be changed.

```
DIP Switch Settings for RS-232C Parameters
Switch 1
Setting
```
```
Switch 2 Setting Printer State
```
##### OFF (0) OFF (0)

```
On-line Mode (default)
```
##### ON(1) OFF (0)

```
Diagnostic Mode
```
##### OFF (0) ON (1)

```
Flash Download Mode
```
##### ON (1) ON (1)

```
Vendor Adjustment Mode
```
#### Setting Extra RS-232C Options.........................................................................................

```
The following extra options are available for the RS-232C Interface:
Data errors
```
- Print “?” for data errors (default)
- Ignore data errors



7167 Owner’s Manual Chapter 6: Commands

83 November 2003

Chapter 6: Commands

### Introduction

```
The different features and functions provided by the printer are controlled by
sending commands from the host computer to the printer. This section describes the
commands that are supported by the printer. The printer commands are made up of
one or more bytes of data starting with a command control code followed by its
supporting parameters.
```
```
Commands control all operations and functions of the printer. This includes
selecting the size and placement of characters and graphics on the receipt or the slip
and feeding and cutting the paper. Unless otherwise noted, any of the commands
may be used in any combination to communicate with the printer from a program in
a host computer.
```
```
In order to allow the graceful handling of commands that may be available in other
printers but are not available in this printer, some commands will be listed and
described but identified as "not implemented." If the printer receives one of these
"not implemented" commands, the command and its supporting operands will be
discarded. Any other data bytes, including unrecognized commands, are sent to the
print buffer as data, and the printer will attempt to print the data when it is
instructed to print the buffer.
```
### List of Commands and Location

```
This section presents groups of lists of the hexadecimal command codes,
parameters, and the command names. A page reference is provided for the page
on which the command is more fully described. If this document is being viewed
online, the page reference will be linked to the actual page and may clicked to go
to that page.
```
```
The first section lists all of the commands. The following lists are separated into
functional category groupings.
```
```
All commands listed in bold or italics are new or have additional functionality
when compared to the NCR 7156. Commands in italics are supported by model
7167-1035 and 7167-2035. These two models can not support commands in bold
italics.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 84
```
#### By Command Code

```
All items in BOLD are new or have additional functionality when compared to the 7156.
All items in italic letters are commands for scanner function and are supported only by
model 7167-1035 and 7167-2035. Items in bold italic are Asian mode commands and are
not supported by model 7167-1035 and 7167-2035.
```
```
Hexadecimal Command
Code and Operands
Command Name
```
```
Page
```
```
09 Horizontal Tab 126
```
```
0A Print and Feed Paper One Line 117
```
```
0C Print and Return to Standard Mode 193
```
```
0C Print and Eject Slip 117
```
```
0D Print and Carriage Return 118
```
```
10 Clear Printer 102
```
```
10 04 n Real Time Status Transmission (DLE Sequence) 177
10 05 n Real Time Request to Printer (GS Sequence) 180
```
```
11 Close Form 103
```
```
12 Select Double-Wide Characters 134
```
```
13 Select Single-Wide Characters 134
```
```
14 n Feed n Print Lines 118
```
```
15 n Feed n Dot Rows 119
```
```
16 n Add n Extra Dot Rows 119
```
```
17 Print 120
```
```
18 Open Form 103
```
```
18 Cancel Print Data in Page Mode 194
19 Perform Full Knife Cut 104
```
```
1A Perform Partial Knife Cut 104
```
```
1B (+ *.bmp) Download BMP Logo 154
```
```
1B 07 Generate Tone 105
1B 0C Print Data in Page Mode 194
```
```
1B 12 Select 90 Degree Counter-Clockwise Rotated
Print
```
##### 135

```
1B 14 n Set Column 126
```
```
1B 16 n Select Pitch (Column Width) 135
1B 20 n Set Character Right-Side Spacing 136
```

7167 Owner’s Manual Chapter 6: Commands

85 November 2003

```
Hexadecimal Command
Code and Operands
Command Name
```
```
Page
```
```
1B 21 n Select Print Modes 138
```
```
1B 24 n1 n2 Set Absolute Starting Position 127
```
```
1B 25 n Select or Cancel User-Defined Character Set 139
```
```
1B 26 3 c1 c2...dn Define User-Defined Characters 140
```
```
1B 27 m a0 a1 a2
d1 ... dm
```
```
Write to User Data Storage 212
```
```
1B 2A m n1 n2
d1 ... dn
```
```
Select Bit Image Mode 155
```
```
1B 2D n Select or Cancel Underline Mode 142
```
```
1B 32 Set Line Spacing to 1/6 Inch 121
```
```
1B 33 n Set Line Spacing 121
```
```
1B 34 m a0 a1 a2 Read from User Data Storage 213
```
```
1B 3A 30 30 30 Copy Character Set from ROM to RAM 142
```
```
1B 3C Return Home 105
```
```
1B 3D n Select Peripheral Device (For Multi-Drop) 105
1B 3F n Cancel User-defined Characters 143
```
```
1B 40 Initialize Printer 106
1B 43 n Set Slip Paper Eject Length 106
1B 44 [ n ] k 00 Set Horizontal Tabs 128
1B 45 n Select or Cancel Emphasized Mode 143
1B 47 Select Double Strike (7156 Emulation) 144
1B 48 Cancel Double Strike 145
1B 49 n Set or Cancel Italic Print 145
1B 4A n Print and Feed Paper 122
1B 4B n Print and Reverse Feed Paper 122
1B 4C Select Page Mode 195
1B 4C n1 n2 d1...dn Select Double Density Graphics
(7156 Emulation)
```
##### 158

```
1B 52 n Select International Character Set 146
1B 53 Select Standard Mode 196
1B 54 n Select Print Direction in Page Mode 197
1B 55 n Select or Cancel Unidirectional Printing Mode 147
1B 56 n Select or Cancel 90 Degrees Clockwise Rotated 147
1B 57 n1, n2,...n8 Set Printing Area in Page Mode 198
1B 59 n1 n2 d1...dn Select Double Density Graphics 158
1B 5B 7D Switch to Flash Download Mode 249
1B 5C n1 n2 Set Relative Print Position 129
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 86
```
```
Hexadecimal Command
Code and Operands
Command Name
```
```
Page
```
```
1B 61 n Select Justification 130
1B 63 30 n Select Receipt or Slip for Printing; Slip for
MICR Read
```
##### 106

```
1B 63 31 n Select Receipt or Slip for Setting Line Spacing 108
1B 63 34 n Select Sensors to Stop Printing 109
1B 63 35 n Enable or Disable Panel Buttons 110
1B 64 n Print and Feed n Lines 123
1B 63 37 n Enable or Disable Slip Paper End Feeding Stop 111
```
```
1B 65 n Print and Reverse Feed n Lines 123
1B 66 m n Set Slip Paper Waiting Time 112
1B 69 Perform Full Knife Cut 104
1B 6A k Read from Non-Volatile Memory 214
1B 6D Perform Partial Cut 104
1B 70 n p1 p2 Generate Pulse to Open Cash Drawer 113
1B 72 n Select Print Color 148
1B 73 n1 n2 k Write to Non-Volatile Memory (NVRAM) 214
1B 74 n Select International Character Set 146
1B 75 0 Transmit Peripheral Device Status 164
1B 76 Transmit Printer Status 164
1B 77 01 Read MICR Data and Transmit 203
1B 77 46 Check Flip 212
1B 77 50 Define Parsing Format, Save in NVRAM 204
1B 77 52 Reread MICR Data 203
1B 77 70 Define Parsing Format, Do Not Save
Permanently
```
##### 204

```
1B 7A n Select or Cancel Parallel Printing Mode on R&J 114
1B 7B n Select or Cancel Upside Down Printing Mode 148
1C Select Slip Station 114
1C 21 n Select print modes for Kanji characters 221
1C 28 67 pL pH 28 Scanning Threshold 225
1C 28 67 pL pH 29 Scanning Area 226
1C 28 67 pL pH 32 Compression Mode 226
1C 28 67 pL pH 38 Deletes Cropping Area 227
1C 28 67 pL pH 39 Set Cropping Area 228
1C 28 67 pL pH 3C Transmission Format 229
1C 28 67 pL pH 50 Transmits Threshold Level 230
1C 28 67 pL pH 51 Transmits Scanning Area 231
1C 28 67 pL pH 5A Transmits Compression Method 232
1C 28 67 pL pH 61 Transmits the cropping area 233
```

7167 Owner’s Manual Chapter 6: Commands

87 November 2003

```
Hexadecimal Command
Code and Operands
Command Name
```
```
Page
```
```
1C 28 67 pL pH 64 Transmits the File Format 235
1C 28 67 pL pH 65 Select Scanning mode 236
1C 28 67 pL pH 66 Transmits scanning mode 236
1C 2D n Turn underline mode ON/OFF for Kanji 222
1C 32 c1 c2 d1...dn Define user-defined Kanji characters 222
1C 53 n1 n2 Set Kanji character spacing 223
1F 56 n Send Printer Software Version 173
1c 57 n Set quadruple mode ON/OFF for Kanji 224
1D 00 Request Printer ID 250
1D 01 Return Segment Number Status of Flash
Memory
```
##### 251

```
1D 02 n Select Flash Memory Sector to Download 251
1D 03 n Real Time Request to Printer (DLE Sequence) 180
1D 04 n Real Time Status Transmission (GS Sequence) 177
1D 05 Real Time Printer Status Transmission 182
1D 06 Get Firmware CRC 252
1D 07 Return Microprocessor CRC 252
1D 0E Erase the Flash Memory 252
1D 0F Return Main Program Flash CRC 253
1D 10 n Erase Selected Flash Sector 253
1D 11 al ah cl ch d1...dn Download to Active Flash Sector 254
1D 14 n Reverse Feed n Lines 124
1D 15 n Reverse Feed n Dots 124
1D 21 n Select Character Size 149
1D 22 n Select Memory Type (SRAM/Flash) Where to
Save Logos or User-Defined Fonts
```
##### 215

```
1D 22 55 n1 n2 Flash Allocation 216
1D 23 n Select the Current Logo (Downloaded Bit
Image)
```
##### 158

```
1D 24 nL nH Set Absolute Vertical Print Position in Page
Mode
```
##### 199

```
1D 28 47 pL pH 41 Executes Scan 236
1D 28 47 pL pH 42 Transmits Scan Data from Working Buffer 244
1D 28 47 pL pH 44 Print Scanned Image 248
1D 28 47 pL pH 45 Execute Shading Correction 248
1D 28 47 pL pH 46 Store Image into Flash ROM 246
1D 28 47 pL pH 47 Clear All Scan Image Files in Flash ROM 247
1D 28 47 pL pH 49 Transmits Scan Data from Flash ROM 245
1D 28 47 pL pH 4A Reverse Feed to top of form 249
1D 2A n1 n2 d1...d n] Define Downloaded Bit Image 159
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 88
```
```
Hexadecimal Command
Code and Operands
Command Name
```
```
Page
```
```
1D 2F m Print Downloaded Bit Image 161
1D 3A Start or End Macro Definition 201
1D 40 n Erase User Flash Sector 217
1D 42 n Select or Cancel White/Black Reverse Print
Mode
```
##### 150

```
1D 48 n Select Printing Position for HRI Characters 187
1D 49 n Transmit Printer ID 165
1D 49 40 n Transmit Printer ID, Remote Diagnostics
Extension
```
##### 167

```
1D 4C nL nH Set Left Margin 131
1D 50 x y Set Horizontal and Vertical Minimum Motion
Units
```
##### 125

```
1D 56 m Select Cut Mode and Cut Paper 114
1D 56 m n Select Cut Mode and Cut Paper 114
1D 57 nL nH Set Printing Area Width 132
1D 5C nL nH Set Relative Vertical Print Position in Page
Mode
```
##### 200

```
1D 5E r t m Execute Macro 202
1D 61 n Select or Cancel Automatic Status Back 183
1D 66 n Select Pitch for HRI Characters 188
1D 68 n Select Bar Code Height 188
1D 6B m d1... Print Bar Code 189
1D 6B m n d1...dn Print Bar Code 189
1D 72 n Transmit Status 168
1D 77 n Select Bar Code Width 192
1D FF Reboot Printer 255
1E Select Receipt Station 116
1F 04 n Convert 6 Dots/mm Bitmap to 8 Dots/mm
Bitmap
```
##### 162

```
1F 05 n Select Superscript or Subscript Modes 151
IF 11 [m n],[m n]...[m
n] 0FFH
```
```
Printer Setting Change 218
```
```
1F 56 Send Printer Software Version 173
1F 74 Print Test Form 116
```

7167 Owner’s Manual Chapter 6: Commands

89 November 2003

#### Printer Function Commands

```
Hexadecimal Command
Code and Operands
Command Name
Page
10 Clear Printer 102
```
```
11 Close Form 103
```
```
18 Open Form 103
```
```
19 Perform Full Knife Cut 104
1A Perform Partial Knife Cut 104
```
```
1B 07 Generate Tone 105
```
```
1B 3C Return Home 105
```
```
1B 3D Select Peripheral Device (for Multi-Drop) 105
```
```
1B 40 Initialize Printer 106
```
```
1B 43 n Set Slip Paper Eject Length 106
```
```
1B 63 30 n Select Receipt or Slip for Printing; Slip for MICR
Read
```
##### 106

```
1B 63 31 n Select Receipt or Slip for Setting Line Spacing 108
```
```
1B 63 34 n Select Sensors to Stop Printing 109
```
```
1B 63 35 n Enable or Disable Panel Buttons 110
```
```
1B 63 37 n Enable or Disable Slip Paper End Feeding Stop 111
```
```
1B 66 m n Set Slip Paper Waiting Time 112
```
```
1B 69 Perform Full Knife Cut 104
```
```
1B 6D Perform Partial Knife Cut 104
```
```
1B 70 n p1 p2 Generate Pulse to Open Cash Drawer 113
```
```
1B 7A n Select or Cancel Parallel Printing Mode on R&J 114
```
```
1C Select Slip Station 114
```
```
1D 56 m Select Cut Mode and Cut Paper 114
```
```
1D 56 m n Select Cut Mode and Cut Paper 114
```
```
1E Select Receipt Station 116
1F 74 Print Test Form 116
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 90
```
#### Vertical Positioning and Print............................................................................................

```
Hexadecimal Command
Code and Operands
Command Name
Page
0A Print and Feed Paper One Line 117
```
```
0C Print and Return to Standard Mode/Print and
Eject Slip
```
##### 117

```
0D Print and Carriage Return 118
```
```
14 n Feed n Print Lines 118
```
```
15 n Feed n Dot Rows 119
```
```
16 n Add n Extra Dot Rows 119
```
```
17 Print 120
```
```
1B 32 Set Line Spacing to 1/6 Inch 121
```
```
1B 33 n Set Line Spacing 121
```
```
1B 4A n Print and Feed Paper 122
1B 4B n Print and Reverse Feed Paper 123
```
```
1B 64 n Print and Feed n Lines 124
```
```
1B 65 n Print and Reverse Feed n Lines 123
```
```
1D 14 n Reverse Feed n Lines 124
```
```
1D 15 n Reverse Feed n Dots 124
```
```
1D 50 x y Set Horizontal and Vertical Minimum Motion
Units
```
##### 125

#### Horizontal Positioning Commands....................................................................................

```
Hexadecimal Command
Code and Operands
Command
Page
09 Horizontal Tab 126
```
```
1B 14 n Set Column 126
```
```
1B 24 n1 n2 Set Absolute Starting Position 127
1B 44 [n] k 00 Set Horizontal Tabs 128
```
```
1B 5C n1 n2 Set Relative Print Position 129
```
```
1B 61 n Select Justification 130
```
```
1D 4C nL nH Set Left Margin 131
```
```
1D 57 nL nH Set Printing Area Width 132
```

7167 Owner’s Manual Chapter 6: Commands

91 November 2003


7167 Owner’s Manual Chapter 6: Commands

```
November 2003 92
```
#### Print Characteristic Commands

```
Hexadecimal Command
Code and Operands
Command
Page
12 Select Double-Wide Characters 134
```
```
13 Select Single-Wide Characters 134
```
```
1B 12 Select 90 Degree Counter-Clockwise Rotated Print 135
```
```
1B 16 n Select Pitch (Column Width) 135
```
```
1B 20 n Set Character Right-Side Spacing 136
```
```
1B 21 n Select Print Modes 138
```
```
1B 25 n Select or Cancel User-Defined Character Set 139
```
```
1B 26 s c1 c2 d1...dn Define User-Defined Characters 140
```
```
1B 2D n Select or Cancel Underline Mode 142
1B 3A 30 30 30 Copy Character Set from ROM to RAM 142
```
```
1B 3F n Cancel User-Defined Characters 143
```
```
1B 45 n Select or Cancel Emphasized Mode 143
```
```
1B 47 Select Double Strike (7156 Emulation Mode) 144
```
```
1B 47 n Select Double Strike (7158/7167 Native Modes) 144
```
```
1B 48 Cancel Double Strike 145
```
```
1B 49 n Select or Cancel Italic Print 145
1B 52 n Select International Character Set 146
```
```
1B 55 n Select or Cancel Unidirectional Printing Mode 147
```
```
1B 56 n Select or Cancel 90 Degrees Clockwise Rotated
Print
```
##### 147

```
1B 72 n Select Print Color^148
1B 74 n Select International Character Set 146
```
```
1B 7B n Select or Cancel Upside Down Printing Mode 148
```
```
1D 21 n Select Character Size 149
1D 42 n Select or Cancel White/Black Reverse Print
Mode
```
##### 150

```
1F 05 n Select Superscript or Subscript Modes 151
```

7167 Owner’s Manual Chapter 6: Commands

93 November 2003

#### Graphics Commands

```
Hexadecimal Command
Code and Operands
Command
Page
1B (+*.bmp) Download BMP Logo 154
```
```
1B 2A m n1 n2 d1...dn Select Bit Image Mode 155
```
```
1B 4C n1 n2 d1...dn Select Double-Density Graphics (in 7156
Emulation Mode)
```
##### 158

```
1B 59 n1 n2 d1...dn Select Double-Density Graphics 158
1D 23 n Select Current Logo (Downloaded Bit Image) 158
```
```
1D 2A n1 n2 d1...dn] Define Downloaded Bit Image 159
```
```
1D 2F m Print Downloaded Bit Image 161
```
```
1F 04 n Convert 6 Dots/mm Bitmap to 8 Dots/mm
Bitmap
```
##### 162

#### Status Commands

```
Hexadecimal Command
Code and Operands
Command
Page
1B 75 0 Transmit Peripheral Device Status 164
1B 76 Transmit Printer Status 164
1D 49 n Transmit Printer ID 165
1D 49 40 n Transmit Printer ID, Remote Diagnostics
Extension
```
##### 167

```
1D 72 n Transmit Status 168
1F 56 n Send Printer Software Version 173
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 94
```
#### Real Time Commands

```
Hexadecimal Command
Code and Operands
Command
Page
10 04 n Real Time Status Transmission (DLE Sequence) 177
```
```
10 05 n Real Time Request to Printer (GS Sequence) 180
```
```
1D 03 n Real Time Request to Printer (DLE Sequence) 180
```
```
1D 04 n Real Time Status Transmission (GS Sequence) 177
```
```
1D 05 Real Time Printer Status Transmission 182
```
#### Auto Status Back Commands

```
Hexadecimal Command
Code and Operands
Command
Page
1D 61 n Select or Cancel Auto Status Back 182
```
#### Bar Code Commands.........................................................................................................

```
Hexadecimal Command
Code and Operands
Command
Page
1D 48 n Select Printing Position for HRI Characters 187
```
```
1D 66 n Select Pitch for HRI Characters 188
```
```
1D 68 n Select Bar Code Height 188
```
```
1D 6B m d1...dk 00
or
1D 6B m n d1...dn
```
```
Print Bar Code 189
```
```
1D 77 n Select Bar Code Width 192
```

7167 Owner’s Manual Chapter 6: Commands

95 November 2003

#### Page Mode Commands

```
Hexadecimal Command
Code and Operands
Command
Page
0C Print and Return to Standard Mode/Print and
Eject Slip
```
##### 193

```
18 Cancel Print Data in Page Mode 194
```
```
1B 0C Print Data in Page Mode 194
```
```
1B 4C Select Page Mode 195
```
```
1B 53 Select Standard Mode 196
```
```
1B 54 n Select Print Direction in Page Mode 197
```
```
1B 57 n1, n2...n8] Set printing Area in Page Mode 198
```
```
1D 24 nL nH Set Absolute Vertical Print Position in Page Mode 199
```
```
1D 5C nL nH Set Relative Vertical Print Position in Page Mode 200
```
#### Graphics Commands

```
Hexadecimal Command
Code and Operands
Command
Page
1D 3A Start or End Macro Definition 201
```
```
1D 5E r t m Execute Macro 202
```
#### MICR Check Reader Commands

```
MICR Reading
Hexadecimal Command
Code and Operands
Command
Page
1B 77 01 Read MICR Data and Transmit 203
```
```
1B 77 52 Reread MICR Data 203
```
#### MICR Parsing..................................................................................................................

```
Hexadecimal Command
Code and Operands
Command
Page
1B 77 50 Define Parsing Format, Save in NVRAM 204
```
```
1B 77 70 Define Parsing Format, Do Not Save Permanently 204
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 96
```
Check Flip Command

```
Hexadecimal Command
Code and Operands
Command
Page
1B 77 46 Check Flip Command 212
```
#### User Data Storage Commands...........................................................................................

```
Hexadecimal Command
Code and Operands
Command
Page
1B 27 m addr d1...dm Write to User Data Storage 212
1B 34 m addr Read from User Data Storage 213
```
```
1B 6A k Read from Non-Volatile Memory 214
```
```
1B 73 n1 n2 k Write to Non-Volatile Memory (NVRAM) 214
```
```
1D 22 n Select Memory Type (SRAM/Flash) Where to
Save Logos or User-Defined Fonts
```
##### 215

```
1D 22 55 n1 n2 Flash Allocation 216
```
```
1D 40 n Erase User Flash Sector 217
```
```
IF 11 [m n],[m n]...[m
n] 0FFH
```
```
Printer Setting Change^218^
```
#### Asian Character Commands

```
Hexadecimal Command
Code and Operands
Command
Page
1C 21 n Select print modes for Kanji characters 221
```
```
1C 2D n Turn underline mode ON/OFF for Kanji^222
```
```
1C 32 c1 c2
d1...dn
```
```
Define user-defined Kanji characters^222
```
```
1C 53 n1 n2 Set Kanji character spacing^223
```
```
1c 57 n Set quadruple mode ON/OFF for Kanji^224
```

7167 Owner’s Manual Chapter 6: Commands

97 November 2003

#### Scanner Function Commands

```
Hexadecimal Command
Code and Operands
Command
Page
1C 28 67 pL pH 28 Scanning Threshold 225
```
```
1C 28 67 pL pH 29 Scanning Area 226
```
```
1C 28 67 pL pH 32 Compression Mode 226
```
```
1C 28 67 pL pH 38 Deletes Cropping Area 227
```
```
1C 28 67 pL pH 39 Set Cropping Area 228
```
```
1C 28 67 pL pH 3C Transmission Format 229
```
```
1C 28 67 pL pH 50 Transmits Threshold Level 230
```
```
1C 28 67 pL pH 51 Transmits Scanning Area 231
1C 28 67 pL pH 5A Transmits Compression Method 232
```
```
1C 28 67 pL pH 61 Transmits the cropping area 233
```
_1C 28 67 pL pH 64_ (^) _Transmits the File Format_ 235
_1C 28 67 pL pH 65 Select Scanning mode_ 236
_1C 28 67 pL pH 66 Transmits scanning mode_ 236
_1D 28 47 pL pH 41 Executes Scan_ 236
_1D 28 47 pL pH 42 Transmits Scan Data from Working Buffer_ 244
_1D 28 47 pL pH 44 Print Scanned Image_ 248
_1D 28 47 pL pH 45 Execute Shading Correction_ 248
_1D 28 47 pL pH 46 Store Image into Flash ROM_ 246
_1D 28 47 pL pH 47_ Clear All Scan Image Files in Flash ROM
_(Function 71 of GS ( G command )_

##### 247

```
1D 28 47 pL pH 49 Transmits Scan Data from Flash ROM 245
```
```
1D 28 47 pL pH 4A Reverse Feed to top of form 249
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 98
```
#### Flash Download Commands..............................................................................................

```
Hexadecimal Command
Code and Operands
Command
Page
1B 5B 7D Switch Flash Download Mode 249
```
```
1D 00 Request Printer ID 250
```
```
1D 01 Return Segment Number Status of Flash Memory 251
```
```
1D 02 n Select Flash Memory Sector to Download 251
```
```
1D 06 Get Firmware 252
1D 07 Return Microprocessor CRC 252
```
```
1D 0E Erase the Flash Memory 252
```
```
1D 0F Return Main Program Flash CRC 252
```
```
1D 10 n Erase Selected Flash Sector 253
```
```
1D 11 aL aH cL cH
d1...dn
```
```
Download to Active Flash Sector 254
```
```
1D FF Reboot the Printer 255
```

7167 Owner’s Manual Chapter 6: Commands

99 November 2003

```
Comparison Chart
The following table details the list of commands whose behavior differs from the NCR
7156 because of the physical differences of a 6 dots/mm head (7156) versus an 8 dots/mm
head (7167). Where the 7156 made movements in n/152 inch increments, the 7167 makes
n/203 inch movements.
```
```
Command Description Difference between a 7156 and a
7167 configured in 7156 Emulation
Mode.
15 n Feed n Dot Rows This command will move
the paper on the receipt in
n/203 inch steps instead of
n/152 inch steps.
16 n Add n Extra Dot Rows The dot rows will be
measured in n/203 inches
versus n/152 inches.
1B 20 n Set Right-Side Character
Spacing
```
```
This command sets the right
side spacing to “n”
horizontal motion units. By
default, these units are in
terms of 1/203 inches versus
1/152 inches.
1B 24 n1 n2 Set Absolute Starting Position For graphics commands, the
position is scaled to best
match the previous product.
In text mode, the equivalent
character position is
calculated.
1B 26 s c1 c2 n1 d1...nn
dn ]
```
```
Define User-Defined
Character Set
```
```
Since the dots on the new
print head are smaller, user-
defined characters that were
used on the previous 7156
printer will appear smaller
on the 7156 printer.
1B 2A m n1 n2 d1...dn Select Bit Image Mode In 7156 Emulation Mode,
graphics are scaled to best
match the size of the graphic
in the 7156 printer.
1B 33 n Set Line Spacing This command uses n in
terms of n/360 inches. Since
the previous product had a
fundamental step of 1/180
inch and the new product
has a fundamental step of
1/203 inch, the actual line
spacing will not exactly
match the requested
spacing.
1B 4A n Print and Feed Paper (Same as above)
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 100
```
```
Command Description Difference between a 7156 and a
7167 configured in 7156 Emulation
Mode.
1B 59 n1 n2 d1...dn Select Double-Density
Graphics
```
```
In 7156 Emulation Mode, the
printer scales the graphics to
provide the best match.
1B 5C n1 n2 Set Relative Print Position The parameter to this
command is in units of dots.
However, the command
moves and aligns to
character positions. In 7156
Emulation Mode, this
command calculates how
many character positions to
move based on the 7156’s
character width in dots (10)
versus the 7167’s width (13).
1B 61 n Select Justification This command does true dot
resolution alignment for
centering versus character-
aligned centering.
1D 2A n1 n2 d1...dn ] Define Downloaded Bit
Image
```
```
In 7156 Emulation Mode,
this command scales the
incoming data to provide a
best match to the size of the
image as it printed on the
7156 printer.
1D 2F m Print Downloaded Bit Image (Same as above)
```

7167 Owner’s Manual Chapter 6: Commands

101 November 2003

```
Command Descriptions
This section provides the detailed description of the commands. These commands
are separated into groups according to their function or use. The previous sections
can be used as an index for the following sections.
```
```
The following lists and describes the headings used to present the elements of the
commands in the descriptions in this section. Each command code is presented in
three formats: ASCII, hexadecimal, and decimal. Choose the format that best suits
the programming implementation. The printer interprets the 8-bit bytes it gets
through its communication interface; it does not care what format the program
lists them in.
```
```
Name: Name of Command
```
**ASCII:** (^) The ASCII representation of the command control code
followed by its operands.
**Hexadecimal:** The hexadecimal representation of the command control code
followed by its operands.
**Decimal:** The decimal representation of the command control code
followed by its operands.
**Operand** **_n_** **:** (^) A description of the command operand. Other command
operands may be m, p1, p2, x, or y.
**Range of** **_n_** **:** The upper and lower limits or list of possible values of the
command operand. The values are listed as decimal values
unless specified otherwise.
**Default of** **_n_** **:** The command operand default value after printer reset or
startup.
**Description:** A brief description of the use of the command.
**Formulas:** Any formulas used for this command.
**Example:** Coding example of how to send the command in Visual Basic.
This code assumes we are doing output to an opened and
ready device called "MSCOMM1." The examples use the
hexadecimal command code formats; the ASCII or decimal
formats could also be used in VB. In commands that use an
operand, a specific value is used, and the result of using the
selected value for the operand is described.
**Exceptions:** Describes any exceptions to this command, e.g., incompatible
commands.


7167 Owner’s Manual Chapter 6: Commands

```
November 2003 102
```
```
Related
Information:
```
```
Describes related information for this command, e.g., bit
information.
```
#### Printer Function Commands

```
The printer function commands control the following basic printer functions and are
described in order of their hexadecimal codes:
```
1. Station Select
2. Platen Control
3. Resetting the printer
4. Cutting the paper
5. Opening the cash drawers

```
Clear Printer
ASCII: DLE
```
```
Hexadecimal: 10
```
```
Decimal: 16
```
```
Clears the print line buffer without printing and sets the printer to the following
condition:
```
1. Receipt station is selected
2. Double-Wide command (0x12) is cancelled
3. Line Spacing, Pitch, and User-Defined Character Sets are maintained at current
    selections (RAM is not affected)
4. Single-Wide, Single-High, Non-Rotated, and Left-Aligned characters are set
5. Printer is restarted and error status is cleared if a fault condition existed
6. Printing position is set to column one
7. Slip platen is opened
8. Slip print head is homed
9. Knife is homed
    Example:
    MSComm1.Output = Chr$(&H10)
    Exceptions:
    A DLE command followed by a hexadecimal 04 or 05 is interpreted as a “real time command”.

#### Real Time Commands


7167 Owner’s Manual Chapter 6: Commands

103 November 2003

```
Close Form
ASCII: DC1
```
```
Hexadecimal: 11
```
```
Decimal: 17
```
```
Closes the feed roller and platen and retracts the forms arm stop to the forms stop
position. If the printer is reset or the Clear command (0x10) is received, the feed roller and
platen are opened.
This command executes if the platen is already closed. This command is processed
regardless of which station is selected.
Example:
MSComm1.Output = Chr$(&H11)
```
```
Open Form
ASCII: CAN
```
```
Hexadecimal: 18
```
```
Decimal: 24
```
```
When the printer is in 7156 Emulation Mode or in non-Page Mode, this command opens
the feed roller and platen so that a form may be inserted (default position).
This command has the same code as the Cancel Print Data in Page Mode command, which
is only executed in Page Mode.
This command executes if the platen is already open. This command executes (opens the
feed roller and platen) regardless of which station is selected.
Example:
MSComm1.Output = Chr$(&H18)
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 104
```
```
Perform Partial Knife Cut
ASCII : EM or ESC i
```
```
Hexadecimal : 19 or 1B 69
```
```
Decimal: 25 or 27 105
```
```
Cuts the receipt, leaving .20 inch (5 mm) of paper. This command is implemented the
same as Partial Knife Cut (1A, 1B 6D). There are two codes for this command. Both codes
perform the same function.
A Line Feed is executed first if the print buffer is not empty.
This command is executed (cuts the receipt) regardless of which station is selected.
Example:
MSComm1.Output = Chr$(&H19) or
MSComm1.Output = Chr$(&H1B) & Chr$(&H69)
```
```
Perform Partial Knife Cut
ASCII : SUB or ESC m
```
```
Hexadecimal : 1A or 1B 6D
```
```
Decimal: 26 or 27 109
```
```
Cuts the receipt, leaving .20 inch (5 mm) of paper. This command is implemented the
same as Full Knife Cut (19, 1B 69) which results in a partial knife cut. There are two codes
for this command and both perform the same function.
This command is processed regardless of which station is selected.
Example:
MSComm1.Output = Chr$(&H1A) or
MSComm1.Output = Chr$(&H1B) & Chr$(&H6D)
Exceptions:
A line Feed is executed first if the printer buffer is not empty.
This command is executed )cuts the receipt) regardless of which station is selected.
```

7167 Owner’s Manual Chapter 6: Commands

105 November 2003

```
Generate Tone
ASCII: ESC BEL
```
```
Hexadecimal: 1B 07
```
```
Decimal: 27 7
```
```
Generates an audible tone. This allows the application to provide an audible tone to the
operator.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H07)
```
```
Return Home
ASCII: ESC <
```
```
Hexadecimal: 1B 3C
```
```
Decimal: 27 60
```
```
Moves the impact print head (unless it is already in the home position) to the home
position.
This command is processed regardless of station, either receipt unit or slip unit.
Related Information:
The printer is able to detect carriage motor jams, eliminating the need to home the print
head after each slip transaction.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H3C)
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 106
```
```
Initialize Printer
ASCII: ESC @
```
```
Hexadecimal: 1B 40
```
```
Decimal: 27 64
```
```
Default: Receipt Slip
```
```
Character Pitch: 15.6 CPI 13.9 CPI
```
```
Column Width: 44 characters (80mm)
32 characters (58mm)
```
```
45 characters
```
```
Extra Dot Rows: 2 3
```
```
Character Set: Code Page 437 Code Page 437
```
```
Printing Position: Column One Column One
```
```
Clears the print line buffer and resets the printer to the default settings for the startup
configuration (refer to Default settings above.)
Single-Wide, Single-High, Non-Rotated, and Left-Aligned characters are set and User-
defined characters or logo graphics are cleared (Flash Memory is not affected). Tabs are
reset to default settings. Receipt selection state is selected.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H40)
```
```
Set Slip Paper Eject Length
ASCII : ESC C n
```
```
Hexadecimal : 1B 43 n
```
```
Decimal: 27 67 n^
```
```
Value of n : 0 to 255
```
```
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H43) & Chr$(n)
Exception:
This command is ignored.
```

7167 Owner’s Manual Chapter 6: Commands

107 November 2003

```
Select Receipt or Slip for Printing; Slip for MICR Read
ASCII : ESC c 0 n
```
```
Hexadecimal : 1B 63 30 n
```
```
Decimal: 27 99 48 n
```
```
Value of n : 0 Journal selected
```
```
1, 2, 3 Receipt selected
```
```
4 Slip selected
```
```
Default of n : 1
```
```
Selects the station for printing. When the slip station is selected, the printer waits (based
on the slip waiting time setting [ie: 1B 66 m n]) for the paper to be inserted. When the slip
station has already been selected and the selection is changed, the form feed roller is
opened.
If the station has already been selected and it is re-selected, no action takes place.
Example:
This statement selects the receipt for printing:
MSComm1.Output = Chr$(&H1B) & Chr$(&H63) & Chr$(&H30) & Chr$(&H01)
Exceptions:
Receiving the command discards unprinted data in the buffer, forcing a “beginning of
line” state.
When n is out of range this command and it’s supporting operands are discarded.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 108
```
```
Select Receipt or Slip for Setting Line Spacing
ASCII : ESC c 1 n
```
```
Hexadecimal : 1B 63 31 n
```
```
Decimal: 27 99 49 n
```
```
Value of n: 0 Journal selected
```
```
1, 2, 3 Select receipt
```
```
4 Select Slip
```
```
Default of n : 1
```
```
Selects which station receives the effects of the following commands:
```
1. Select Default Line Spacing (1B 32)
2. Set Line Spacing (1B 33)
3. Add _n_ extra dot rows (16 _n_ )
    Example:
    This statement selects the slip station for line spacing commands:
    MSComm1.Output = Chr$(&H1B) & Chr$(&H63) & Chr$(&H31) & Chr$(&H04)
Exceptions:
This n is out of range this command it’s supporting operands are discaraded.


7167 Owner’s Manual Chapter 6: Commands

109 November 2003

```
Select Sensors to Stop Printing
ASCII : ESC c 4 n
```
```
Hexadecimal : 1B 63 34 n
```
```
Decimal: 27 99 52 n^
```
```
Value of n :
```
```
If this bit of n is 1 Function Performed
Bit 0, or bit 1 Stop Receipt on Receipt Low
```
```
Bit 4 Stop Slip if Trailing Edge Uncovered
```
```
Bit 5 Stop Slip if Leading Edge Uncovered
```
```
Default: 0
Determines which sensor causes the printer to stop printing on the respective station. The
command does not affect the paper out sensor on the receipt station, which will
automatically stop the printer when the paper is depleted.
Example:
This statement causes the receipt to stop on paper low and the slip to stop if the leading edge I
s uncovered (bits 0 and 5 equal to 1 yields hexadecimal 21 - binary 00100001):
MSComm1.Output = Chr$(&H1B) & Chr$(&H63) & Chr$(&H34) & Chr$(&H21)
All other bits are ignored.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 110
```
```
Enable or Disable Panel Buttons
ASCII : ESC c 5 n
```
```
Hexadecimal : 1B 63 35 n
```
```
Decimal: 27 99 53 n
```
```
Value of n : 0 = Enable
```
```
1 = Disable
```
```
Default:
0 (Enable)
```
```
Enables or disables the Paper Feed Button. If the last bit is 0, the Paper Feed Button is
enabled. If the last bit is 1, the Paper Feed Button is disabled so pressing the paper feed
button will result in no response.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H63) & Chr$(&H35) & Chr$(n)
```
```
Related Information:
Functions that require using the Paper Feed Button (except for the Execute Macro [1D 5E]
command) cannot be used when it is disabled with this command.
```

7167 Owner’s Manual Chapter 6: Commands

111 November 2003

```
Enable or Disable Slip Paper End Feeding Stop
ASCII : ESC c 7 n
```
```
Hexadecimal : 1B 63 37 n
```
```
Decimal: 27 99 55 n
```
```
Value of n : 0 = Enable
```
```
1 = Disable
```
```
Default:
0 (Enable)
```
```
Enables or disables the the slip paper end feeding stop function. When this feature is
enabled the printer will print a line but will not perform a line feed when the slip paper
end is detected.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H63) & Chr$(&H37) & Chr$(n)
Related Information:
When either the trailing edge sensor or the leading edge sensor does not sense the paper
the printer recongnizes this as a paper end condition.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 112
```
```
Set Slip Paper Waiting Time
ASCII : ESC f m n
```
```
Hexadecimal : 1B 66 m n
```
```
Decimal: 27 102 m n^
```
```
Value of m : Minutes
```
```
Value of n : Tenths of seconds
```
```
Sets the time (in m minutes) that the printer waits for a slip to be inserted into the slip
station. It also sets the time ( n x 0.1 seconds) that the printer waits to close the platen and
start printing once the slip has been inserted. The printer reads that a slip is inserted when
the leading edge and trailing edge sensors are covered. The LED on the slip table is lit
(green) when both sensors are covered.
If a slip is not inserted in the time specified, the receipt station is selected for the next
function. If m = 0, the printer waits forever for a slip to be inserted. The times set by this
command are used only by the command, Select Receipt or Slip for Printing, Slip for MICR
Read (1B 63 30 n ), with n set to 04.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H66) & Chr$(m) & Chr$(n)
```

7167 Owner’s Manual Chapter 6: Commands

113 November 2003

```
Generate Pulse to Open Cash Drawer
ASCII: ESC p n p 1 p 2
```
```
Hexadecimal: 1B 70 n p 1 p 2
```
```
Decimal: 27 112 n p 1 p 2
```
```
Value of n : 0, 48 = Drawer 1
```
```
1, 49 = Drawer 2
```
```
Value of p1 : 0 - 255
```
```
Value of p2 : 0 - 255
```
```
Sends a pulse to open the cash drawer.
Formulas:
The value for either p1 or p2 is the hexadecimal number multiplied by 2 msec to equal the
total time.
```
1. On time = _p1_ x 2 msec
2. Off time = _p2_ x 2 msec
    Example:
    MSComm1.Output = Chr$(&H1B) & Chr$(&H70) & Chr$(n) & Chr$(n)
Related Information:
The off-time is the delay before the printer performs the next operation.
The recommend time for NCR cash drawers is 110 msec on time.

```
Refer to cash drawer specifications for required on and off times.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 114
```
```
Select or Cancel Parallel Printing Mode on Receipt and Journal
ASCII : ESC z n
```
```
Hexadecimal : 1B 7A n
```
```
Decimal: 27 122 n
```
```
Because there is no journal station on the printer this command is not implemented and is
ignored if received. The command and its supporting operands will be discaraded.
```
#### Slip Station

##### ASCII: FS

```
Hexadecimal: 1C
```
```
Decimal: 28
```
```
Selects the Slip Station for all functions. The receipt station is the default setting after the
printer is initialized or the Clear Printer (0x10) command is received. The Hex command:
1B 63 30 n , where n = 4 will also select the slip station.
Example:
MSComm1.Output = Chr$(&H1C)
Exceptions:
This command is ignored if Asian mode is On by diagnostic setting.
```
```
Select Cut Mode and Cut Paper
ASCII : GS V m or GS V m n
```
```
Hexadecimal : 1D 56 m or 1D 56 m n
```
```
Decimal: 29 86 m or 29 86 m n
```
```
Value of m : Selects the mode as shown in the table
```
```
Value of n : Determines cutting position only if m is 65 or 66.
```

7167 Owner’s Manual Chapter 6: Commands

115 November 2003

```
m Feed and Cut Mode
0, 48 Full cut (no extra feed). Partial cut on the 7158/7167.
```
```
1, 49 Partial cut (no extra feed).
```
```
65 Feeds paper to cutting position + ( n times vertical motion unit),
and cuts the paper completely.
```
```
66 Feeds paper to cutting position + ( n times vertical motion unit),
and performs a partial cut.
```
```
Range of m : 0, 48; 1, 49
```
```
65, 66 (when used with n )
```
```
Range of n : 0 - 255
```
```
Default of n : 0
```
```
Default of m : 0
```
```
Selects a mode for cutting paper and cuts the paper. There are two formats for this
command, one requiring one parameter m , the other requiring two parameters, m and n.
The format is indicated by the parameter m.
Formulas: n times the vertical motion unit is used to determine the cutting position to the
distance that the paper is fed.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H56) & Chr$(m) & Chr$(n)
Exceptions:
If m is out of the specified range, the command is ignored.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 116
```
```
Select Receipt Station
ASCII: RS
```
```
Hexadecimal: 1E
```
```
Decimal: 30
```
```
Selects the Receipt Station for all functions. The receipt station is the default setting after
the printer is initialized or the Clear Printer (0x10) command is received. The Hex
command: 1B 63 30 n , where n = 1, 2, 3 will also select the receipt station.
Example:
MSComm1.Output = Chr$(&H1E)
```
```
Print Test Form
ASCII: US t
```
```
Hexadecimal: 1F 74
```
```
Decimal: 31 116
```
```
Prints the current printer configuration settings on the receipt.
Disabled in page mode.
Example:
MSComm1.Output = Chr$(&H1F) & Chr$(&H74)
```

7167 Owner’s Manual Chapter 6: Commands

117 November 2003

#### Vertical Positioning and Print Commands.......................................................................

```
The vertical positioning and print commands control the vertical print positions of
characters on the receipt and slip.
```
```
Print and Feed Paper One Line
ASCII: LF
```
```
Hexadecimal: 0A
```
```
Decimal:^10
```
```
Prints one line from the buffer and feeds paper one line.
Example:
MSComm1.Output = Chr$(&H0A)
Related Information:
Carriage Return + Line Feed, prints and feeds only one line.
```
```
Print and Eject Slip
ASCII: FF
```
```
Hexadecimal: 0C
```
```
Decimal: 12
```
```
Prints data from the buffer to the slip station and if the paper sensor is covered, reverses
the slip out the front of the printer far enough to be accessible to the operator. The impact
station opens the platen in all cases.
This command has the same code as the Print and Return to Standard Mode command,
which is executed only when the printer is in Page Mode. When the printer is not in Page
Mode this command executes the print and eject slip function.
Example:
MSComm1.Output = Chr$(&H0C)
Exceptions:
This command is ignored if the receipt station is the current station.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 118
```
```
Print and Carriage Return
ASCII: CR
```
```
Hexadecimal: 0D
```
```
Decimal: 13
```
```
Prints one line from the buffer and feeds paper one line. The printer can be set through the
configuration menu to ignore or use this command. Some applications expect the
command to be ignored while others use it as print command.
Example:
MSComm1.Output = Chr$(&H0D)
Related Information:
See Ignoring/Using the Carriage Return in Diagnostics for more information.
Carriage Return + Line Feed, prints and feeds only one line.
```
```
Feed n Print Lines
ASCII: DC4 n
```
```
Hexadecimal: 14 n
```
```
Decimal: 20 n
```
```
Value of n : The number of lines to feed at current line height
setting.
```
```
Range of n : 0 – 127 7156 Emulation Mode
```
```
0 – 255 7158 Native Mode or 7167 Native Mode
```
```
Feeds paper n lines at the current line height without printing.
Ignored on receipt if the current line is not empty.
Example:
MSComm1.Output = Chr$(&H14) & Chr$(n)
```

7167 Owner’s Manual Chapter 6: Commands

119 November 2003

```
Feed n Dot Rows
ASCII: NAK n
```
```
Hexadecimal: 15 n
```
```
Decimal: 21 n
```
```
Value of n : Receipt Slip
```
```
n /203 inch n /72 inch
```
```
Range of n : 0 – 127 7156 Emulation Mode
```
```
0 – 255 7158 Native Mode or 7167 Native Mode
```
```
Feeds paper n dot rows without printing. Receipt moves n rows if the print buffer is
empty.
Example:
MSComm1.Output = Chr$(&H15) & Chr$(n)
```
```
Add n Extra Dot Rows
ASCII: SYN n
```
```
Hexadecimal: 16 n
```
```
Decimal: 22 n
```
```
Value of n : Receipt Slip
```
```
n /203 inch n /72 inch
```
```
Range of n: 0 - 12
```
```
Default: Receipt Slip
```
##### 3 3

```
Adds n extra dot rows to the character height to increase space between print lines or
decrease number of lines per inch.
Formulas:
The following table shows the relationship between the number of lines per inch and each
extra dot row(s) added for both the receipt and slip stations:
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 120
```
```
Receipt Station Slip Station
Extra Rows Lines Per
Inch
```
```
Dot Rows Extra Rows Lines Per
Inch
```
```
Dot Rows
```
##### 0 8.47 24 0 10.29 7

##### 1 8.13 25 1 9.00 8

##### 2 7.81 26 2 8.00 9

##### 3 7.52 27 3 7.20 10

##### 4 7.25 28 4 6.55 11

##### 5 7.00 29 5 6.00 12

##### 6 6.77 30 6 5.54 13

##### 7 6.55 31 7 5.14 14

##### 8 6.35 32 8 4.80 15

##### 9 6.16 33 9 4.50 16

##### 10 5.98 34 10 4.24 17

##### 11 5.81 35 11 4.00 18

##### 12 5.64 36 12 3.79 19

```
Example:
MSComm1.Output = Chr$(&H16) & Chr$(n)
```
```
Print
ASCII: ETB
```
```
Hexadecimal: 17
```
```
Decimal: 23
```
```
Prints one line from the buffer and feeds paper one line. Executes LF on receipt. Executes
LF on slip if previous character was not a CR.
Example:
MSComm1.Output = Chr$(&H17)
```

7167 Owner’s Manual Chapter 6: Commands

121 November 2003

```
Set Line Spacing to 1/6 Inch
ASCII: ESC 2
```
```
Hexadecimal: 1B 32
```
```
Decimal: 27 50
```
```
Default: 0.13 Inch (3.33 mm)
```
```
Sets the default line spacing to 1/6 of an inch (4.25 mm).
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H32)
```
```
Set Line Spacing
ASCII : ESC 3 n
```
```
Hexadecimal : 1B 33 n
```
```
Decimal: 27 51 n
```
```
Value of n : n /406 inches on receipt
```
```
n /144 inches in slip
```
```
Range of n : 0 – 255
```
```
Default: Receipt .13 inch (3.37 mm or 7.52 lines per inch, 3 extra
dot rows.).
```
```
Slip 14 inch (7.2 lines per inch, 3 extra dot rows.)
```
```
Sets the line spacing for the receipt and for the slip. For the receipt the spacing is set to
n/406 inches. For the slip, the line spacing is set to n/144 inches. The line spacing equals
the character height when n is too small.
If the Set Horizontal and Vertical Minimum Motion Units command (1D 50) is used to
change the horizontal and vertical minimum motion unit, the parameters of this command
(Set Line Spacing) will be interpreted accordingly.
Related Information:
For more information, see the description of the Set Horizontal and Vertical Minimum
Motion Units command in this document.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 122
```
```
Print and Feed Paper
ASCII : ESC J n
```
```
Hexadecimal : 1B 4A n
```
```
Decimal: 27 74 n
```
```
Value of n : n/ 203 inches receipt
```
```
n /144 inches slip
```
```
Range of n : 0 - 255
```
```
Prints one line from the buffer and feeds the paper.
On the receipt station, the line height equals the character height when n is too small. This
does not apply to the slip station. Use n = 0 to print a line without feeding the paper. This
allows the printer to print on the last line of the slip (at .59 inches from the trailing edge)
and still retain the slip in the feed rollers for reverse feeding the paper back out of the slip
station.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H4A) & Chr$(n)
Related Information:
For more information, see the description of the Set Horizontal and Vertical Minimum
Motion Units command in this document.
```
```
Print and Reverse Feed Paper
ASCII : ESC K n
```
```
Hexadecimal : 1B 4B n
```
```
Decimal: 27 75 n
```
```
Value of n : Slip = n/ 144 of an inch
```
```
Range of n : 0 - 255
```
```
Prints one line from the buffer and reverse feeds the paper n /144 of an inch on the slip
station.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H4B) & Chr$(n)
Exceptions:
The receipt station cannot be reverse fed.
```

7167 Owner’s Manual Chapter 6: Commands

123 November 2003

```
Print and Feed n Lines
ASCII : ESC d n
```
```
Hexadecimal : 1B 64 n
```
```
Decimal: 27 100 n
```
```
Value of n : Number of lines to be printed and fed.
```
```
Range of n : 1 – 255
```
```
(0 is interpreted as 1 on the receipt station)
```
```
Prints one line from the buffer and feeds paper n lines at the current line height.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H64) & Chr$(n)
```
```
Print and Reverse Feed n Lines
ASCII : ESC e n
```
```
Hexadecimal : 1B 65 n
```
```
Decimal: 27 101 n
```
```
Value of n : The number of lines on the slip station to be reverse fed.
```
```
Range of n : 0 – 255
```
```
Prints one line from the buffer and reverse feeds the paper n lines on the slip station. The
receipt station cannot be reverse fed.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H65) & Chr$(n)
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 124
```
```
Reverse Feed n Lines
ASCII : GS DC4 n
```
```
Hexadecimal : 1D 14 n
```
```
Decimal: 29 20 n
```
```
Range of n : 0 – 127 7156 Emulation Mode
```
```
0 – 255 7158 Native Mode or 7167 Native Mode
```
```
Reverses the paper feed in the slip station by n lines at the current spacing. The next
character feed command returns the paper feed back to the normal feed direction. This
command is ignored if slip is not the selected station. Current spacing is not a factor.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H14) & Chr$(n)
```
```
Reverse Feed n Dots
ASCII : GS NAK n
```
```
Hexadecimal : 1D 15 n
```
```
Decimal: 29 21 n
```
```
Value of n : n dots at 1/72 inch
```
```
Range of n : 0 – 127 7156 Emulation Mode
```
```
0 – 255 7158 Native Mode or 7167 Native Mode
```
```
Reverses the paper feed in the slip station by n dots at 1/72 inch (NCR 7150™ command).
This command is ignored if receipt station is selected.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H15) & Chr$(n)
```

7167 Owner’s Manual Chapter 6: Commands

125 November 2003

```
Set Horizontal and Vertical Minimum Motion Units
ASCII: GS P x y
```
```
Hexadecimal: 1D 50 x y
```
```
Decimal: 29 80 x y
```
```
Value of x : Horizontal
```
```
Value of y : Vertical
```
```
Range of x : 0 - 255
```
```
Range of y : 0 - 255
```
```
Default: of x : 203
```
```
Default: of y : 203
```
```
Sets the horizontal and vertical motion units to 1/ x inch and 1/ y inch respectively.
When x or y is set to 0, the default setting for that motion unit is used.
The default horizontal motion is x = 203.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H50) & Chr$(x) & Chr$(y)
Exceptions:
This command is ignored if slip station is selected.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 126
```
#### Horizontal Positioning Commands..................................................................................

```
The horizontal positioning commands control the horizontal print positions of characters
on the receipt and slip.
```
```
Horizontal Tab
ASCII: HT
```
```
Hexadecimal: 09
```
```
Decimal: 9
```
```
Moves the print position to the next tab position set by the Set Horizontal Tab Positions
(1B 44 n 1 n 2 ... 00) command. The print position is reset to column one after each line.
Tab treats the left margin as column one, therefore changes to the left margin will move
the tab positions.
When there are no tabs defined to the right of the current position, or if the next tab is past
the right margin, line feed is executed (both slip and receipt.) HT has no effect in page
mode. Printer initialization sets 32 tabs at column 9, 17, 25, ... (Every 8 characters)
Example:
MSComm1.Output = Chr$(&H09)
```
```
Set Column
ASCII : ESC DC4 n
```
```
Hexadecimal : 1B 14 n
```
```
Decimal: 27 20 n
```
```
Value of n : Receipt Slip
```
```
1 - 44 (Standard,80 mm) 1 - 45 (Standard)
```
```
1 - 56 (Compressed,80 mm) 1 - 55 (Compressed)
```
```
1 - 32 (Standard,58mm)
```
```
1 - 42 (Compressed, 58mm)
```
```
Default of n : 1
```

7167 Owner’s Manual Chapter 6: Commands

127 November 2003

```
Prints the first character of the next print line in column n. It must be sent for each line not
printed at column one. The value of n is set to one after each line.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H14) & Chr$(n)
Exceptions:
The command cannot be used with Single- or Double-Density graphics.
```
```
Set Absolute Starting Position
ASCII: ESC $ n1 n2
```
```
Hexadecimal: 1B 24 n1 n2
```
**Decimal:** (^) 27 36 _n1 n2_
**Value of** **_n_** **:** Number of dots to be moved from the beginning of the
line.
**Value of** **_n1:_** Remainder after dividing _n_ by 256.
**Value of** **_n2:_** Integer after dividing _n_ by 256.
The values for _n_ 1 and _n_ 2 are two bytes in low byte, high byte word orientation.
Sets the print starting position to the specified number of dots (up to the right margin)
from the beginning of the line. The print starting position is reset to the first column after
each line.
**Formulas:**
Determine the value of _n_ by multiplying the column for the absolute starting position by
10 (slip, or receipt standard pitch) or 8 (receipt compressed pitch). The example shows
how to calculate column 29 (10 dots per column) as the absolute starting position.
28 x 10 = 280 dots (beginning of column 29)
280/256 = 1, remainder of 24
_n_ 1 = 24 _n_ 2 = 1
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H24) & Chr$(n1) & Chr$(n2)
Related Information:
This command is also used in the graphics mode on the receipt. See Graphics Commands
in this chapter for more information.
If the Set Horizontal and Vertical Minimum Motion Units command (1D 50) is used to
change the horizontal and vertical minimum motion unit, the parameters of this command
(Set Absolute Print Position) will be interpreted accordingly. For more information, see the
description of the Set Horizontal and Vertical Minimum Motion Units command (1D 50)
in this document.


7167 Owner’s Manual Chapter 6: Commands

```
November 2003 128
```
Set Horizontal Tabs
**ASCII** : ESC D _[n] k_ NUL

```
Hexadecimal : 1B 44 [n] k 00
```
```
Decimal: 27 68 [n] k 0
```
```
Value of n : Column for tab minus one.
```
```
n is always less than or equal to the current selected column
width.
```
```
Value of k : 0 - 32
```
```
Default: Every 8 characters from column. 1 (9, 17, 25, etc.) for normal
print.
```
```
Sets up to 32 horizontal tab positions n columns from column one, but does not move the
print position. See the Horizontal Tab (09) command.
The tab positions remain unchanged if the character widths are changed after the tabs are
set. This command ends with hexadecimal 00; hexadecimal 1B 44 00 clears all tabs. Tabs
assumed to be in strictly ascending order. A tab out of order terminates the command
string as if it were 00, and remaining tab values are taken as normal data.
Formulas:
Set the tab positions in ascending order and put Hex 00 at the end.
Hex 1B 44 00 (number of tabs not specified) clears all tab positions.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H44) & Chr$(&H00)
Exceptions:
The tabs cannot be set higher than the column width of the current pitch.
```

7167 Owner’s Manual Chapter 6: Commands

129 November 2003

```
Set Relative Print Position
ASCII: ESC \ n1 n2^
```
```
Hexadecimal: 1B 5C n1 n2^
```
```
Decimal: 27 92 n1 n2^
```
```
Value of n :
```
```
To Move the Relative Starting Position Right of the Current Position by n dots:
n 1 = Remainder after dividing n by 256.
n 2 = Integer after dividing n by 256.
The values for n 1 and n 2 are two bytes in low byte, high byte word orientation.
To Move the Relative Starting Position Left of the Current Position by n dots:
n 1 = Remainder after dividing (65,536- n ) by 256
n 2 = Integer after dividing (65,536- n ) by 256
The values for n 1 and n 2 are two bytes in low byte, high byte word orientation.
Moves the print starting position the specified number of dots either right (up to the right
margin) or left (up to the left margin) of the current position. The print starting position is
reset to the first column after each line.
Formulas:
To move to the left:
Determine the value of n by multiplying the number of columns to move left of the current
position by 13 (receipt standard pitch) or 10 (slip or receipt compressed pitch). The
example shows how to set the relative position two columns in standard pitch (10 dots per
column) to the left of the current position.
2 x 10 = 20 dots (two columns to be moved left of the current position)
65,536-20 = 65516
65,516/256 = 255, remainder of 236
n1 = 236 n2 = 255
To move to the right:
Determine the value of n by multiplying the number of columns to move right of the
current position by 10 (slip or receipt standard pitch) or 8 (receipt compressed pitch). The
example shows how to set the relative position two columns in standard pitch (10 dots per
column) to the right of the current position.
2 x 10 = 20 dots (two columns to be moved right of the current position)
20/256 = 0, remainder of 20
n1 = 20 n 2 = 0
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H5C) & Chr$(n1) & Chr$(n2)
Related Information:
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 130
```
```
If the Set Horizontal and Vertical Minimum Motion Units command (1D 50) is used to
change the horizontal and vertical minimum motion unit, the parameters of this command
(Set Relative Print Position) will be interpreted accordingly. For more information, see the
description of the Set Horizontal and Vertical Minimum Motion Units command (1D 50)
in this document.
Compatibility Information (7167 receipt vs. 7156 receipt)
There is a difference in the normal behavior of this command in 7158 Native Mode/7167
Native Mode as compared to the original 7156. The difference exists when the command is
used to move to the left. The 7156 processes the whole print string prior to putting it in the
buffer for the print head. This method of processing allows the 7156 to backup in the print
string and replace characters and their associated attributes when a “Set Relative Print
Position” command instructs the printer to move the print position to the left.
In order to improve the speed of printing, the 7167 moves the data into a buffer for the
print head when it receives it. When the “Set Relative Print Position” command contains a
move to the left, this causes the new data to overstrike the previous data. This behavior
can be used to an application’s advantage to provide the ability to create compound
characters on the receipt station.
```
```
Select Justification
ASCII : ESC a n
```
```
Hexadecimal : 1B 61 n
```
```
Decimal: 27 97 n
```
```
Value of n : 0, 48 = Left Aligned
```
```
1, 49 = Center Aligned
```
```
2, 50 = Right Aligned
```
```
Range of n : 0 – 2, 48-50
```
```
Default: 0 (Left aligned)
```
```
Specifies the alignment of the characters, graphics, logos, and bar codes on the receipt
station.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H61) & Chr$(n)
Exceptions:
The command is valid only when input at the beginning of a line.
```

7167 Owner’s Manual Chapter 6: Commands

131 November 2003

```
Set Left Margin
ASCII : GS L nL nH
```
```
Hexadecimal : 1D 4C nL nH
```
```
Decimal: 29 76 nL nH
```
```
Range of nL : 0 - 255
```
```
Range of nH : 0 - 255
```
```
Default: 80 mm width 576 dots (the maximum printable area)
```
```
58 mm width 424 dots (the maximum printable area)
```
```
Sets the left margin of the printing area. The left margin is set to ((( nH X 256) + nL ) times
horizontal motion unit) inches. The horizontal motion units are set by the Set Horizontal
and Vertical Minimum Motion Units command (1D 50), described in this manual.
The width of the printing area is set by the Set Printing Area Width command (1D 57),
which follows this command. See the Set Printing Area Width command (1D 57) in this
document for a description of that command.
If the setting exceeds the printable area, the maximum value of the printable area is used.
The maximum printable area is 576 dots. See the illustration.
Formulas:
To set the left margin to one inch at the default horizontal motion unit of 1/203 inches,
send the four-byte string:
GS L 203 0
Or, to set the left margin to two inches at the default horizontal motion unit of 1/203 units
per inch, send the four-byte string:
GS L 150 1
Where 2 inches = 406/203, and 406 = (1 X 256) + 150.
```
```
←⎯⎯- Printable area: 576 dots for 80 mm width, 424 dots for 58 mm width
⎯⎯⎯→
```
```
←⎯⎯Left margin⎯⎯⎯→ ←⎯⎯⎯Printing area width⎯⎯⎯⎯⎯→
```
```
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H4C) & Chr$(nL) & Chr$(nH)
Exceptions:
The command is effective only at the beginning of a line.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 132
```
```
This command is ignored if the line buffer is not empty, and only effects the Receipt
interface.
```
```
Set Printing Area Width
ASCII : GS W nL nH
```
```
Hexadecimal : 1D 57 nL nH
```
```
Decimal: 29 87 nL nH
```
```
Range of nL : 0 – 255
```
```
Range of nH : 0 - 255
```
```
Default: 80 mm width 576 dots (the maximum printable area)
```
```
58 mm width 424 dots (the maximum printable area)
```
```
Sets the width of the printing area. If the setting exceeds the printable area, the maximum
value of the printable area is used.
The width of the printing area is set to ((( nH X 256) + nL ) times horizontal motion unit)
inches. The horizontal motion units are set by the Set Horizontal and Vertical Minimum
Motion Units command (1D 50).
The width of the printing area follows the Set Left Margin command (1D 4C).
See the Set Left Margin command (1D 4C...) earlier in this document for a description.
Formulas:
To set the width of the printing area to one inch at the default horizontal motion unit of
1/203 inches, send the four-byte string:
GS W 203 0
Or, to set the width of the printing area to two inches at the default horizontal motion unit
of 1/203 units per inch, send the four-byte string:
GS W 150 1
Where 2 inches = 406/203, and 406 = (1 X 256) + 150.
```
```
←⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ Printable area 576 dots⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯→
```
```
←⎯⎯Left margin⎯⎯⎯→ ←⎯⎯⎯Printing area width⎯⎯⎯⎯⎯→
```
```
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H57) & Chr$(nL) & Chr$(nH)
Exceptions:
This command is effective only at the beginning of a line.
```

7167 Owner’s Manual Chapter 6: Commands

133 November 2003

```
This command is ignored if the line buffer is not empty, and only effects the Receipt
interface.
If the setting exceeds the printable area, the maximum value of the printable area is used.
The maximum printable area is 576 dots for 80 mm paper width and 424 dots for 58 mm
paper width. See the illustration in the Set Left Margin command (1D 4C).
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 134
```
#### Print Characteristic Commands

```
These commands control what the printed information looks like: selection of character
sets, definition of custom-defined characters, and setting of margins. The commands are
described in order of their hexadecimal codes
```
```
Select Double-Wide Characters
ASCII: DC2
```
```
Hexadecimal:^12
```
```
Decimal: 18
```
```
Prints double-wide characters. The printer is reset to single-wide mode after a line has
been printed or the Clear Printer (0x10) command is received. Double-wide characters
may be used in the same line with single-wide characters.
Example:
MSComm1.Output = Chr$(&H12)
```
```
Select Single-Wide Characters
ASCII: DC3
```
```
Hexadecimal: 13
```
```
Decimal: 19
```
```
Prints single-wide characters. Single-wide characters may be used in the same line with
double-wide characters.
Example:
MSComm1.Output = Chr$(&H13)
```

7167 Owner’s Manual Chapter 6: Commands

135 November 2003

```
Select 90 Degree Counter-Clockwise Rotated Print
ASCII : ESC DC2
```
```
Hexadecimal : 1B 12
```
```
Decimal: 27 18
```
```
Rotates characters 90 degrees counter-clockwise. The command remains in effect until the
printer is reset or until a Clear Printer (0x10), Select or Cancel Upside-Down Print (1B 7B),
or Select or Cancel Rotated Print (1B 56) command is received.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H12)
Exceptions:
This command is valid only at the beginning of a line.
Rotated print and non-rotated print characters cannot be used together in the same line.
Related Information:
See Summary of Rotated Printing in this chapter.
```
```
Select Pitch (Column Width)
ASCII : ESC SYN n
```
```
Hexadecimal : 1B 16 n
```
```
Decimal: 27 22 n
```
```
Value of n : 0 = Standard Pitch
```
```
1 = Compressed Pitch
```
```
Default: 0 (Standard pitch)
```
```
Selects the character pitch for a print line.
Formulas:
The following table provides the print characteristics for both pitches on the receipt and
slip stations.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 136
```
```
Pitch
```
```
Receipt
Columns
```
```
Receipt
CPI
```
```
Slip
Columns
```
```
Slip
CPI
Standard 44 for 80 mm
paper
```
##### 15.6 45 13.9

```
32 for 58 mm
paper
Compressed 56 for 80 mm
paper
```
##### 20.3 55 17.1

```
42 for 58 mm
paper
```
```
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H16) & Chr$(n)
Related Information:
See “Technical Specifications” for descriptions of character pitches (print modes).
```

7167 Owner’s Manual Chapter 6: Commands

137 November 2003

```
Set Character Right-Side Spacing
ASCII : ESC SP n
```
```
Hexadecimal : 1B 20 n
```
```
Decimal: 27 32 n
```
```
Range of n : 0 - 32
```
```
Default: 0
```
```
Sets the right side character spacing to [ n x horizontal or vertical motion units]. Values for
this command are set independently in Standard and Page Mode.
The units of horizontal and vertical motion are specified by the Set Horizontal and Vertical
Minimum Motion Units (1D 50...) command. Changes in the horizontal or vertical units
do not affect the current right side character spacing. When the horizontal or vertical
motion unit is changed by the Set Horizontal and Vertical Minimum Motion Units (1D
50...) command the value must be in even units and not less than the minimum amount of
horizontal movement.
In Standard Mode the horizontal motion unit is used.
In Page Mode the horizontal or vertical motion unit differs and depends on the starting
position of the printable area. When the starting printing position is the upper left or lower
right of the printable area (set by Select Print Direction in Page Mode, 1B 54 n) the
horizontal motion unit ( x ) is used. When the starting printing position is the upper right or
lower left of the printable area (set by Select Print Direction in Page Mode, 1B 54 n) the
vertical motion unit ( y ) is used.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H20) & Chr$(n)
Exception:
This command is ignored in 7156 Emulation Mode and is only valid on the receipt station.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 138
```
```
Select Print Modes
ASCII : ESC! n
```
```
Hexadecimal : 1B 21 n
```
```
Decimal: 27 33 n^
```
```
Value of n : Pitch selection (standard, compressed, double high, or
double wide.)
```
```
Bit Function 0 1
Bit 0 Pitch Standard Pitch
```
```
1
15.6 CPI (Receipt)
44 Col/Line (80 mm)
32 Col/Line (58 mm)
13.9 CPI (Slip)
45 Col/Line
```
```
Compressed Pitch
20.3 CPI (Receipt)
56 Col/Line (80 mm)
42 Col/Line (58 mm)
17.1 CPI (Slip)
55 Col/Line
Bit 3 Emphasized
Mode
```
```
Canceled Set
```
```
Bit 4 Double-
high^2
```
```
Canceled Set
```
```
Bit 5 Double-wide Canceled Set
Bit 7 Underlined
Mode
```
```
Canceled Set
```
```
Bits 1, 2, 6 are not used.
```
(^1) Standard and compressed pitch cannot be used together in the same line.
(^2) Double-high characters cannot be used with normal characters in the same
line, nor can they be used on the slip station.
**Default:** 0 (for bits 0, 3, 4, 5, 7)
Selects the print mode: standard, compressed, double high, or double wide.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H21) & Chr$(n)
Related Information:


7167 Owner’s Manual Chapter 6: Commands

139 November 2003

```
The bits in this command perform the same function as the standalone functions:
```
```
1B 16 n Select Pitch
```
```
1B 45 n Emphasized
```
```
12 Double-wide
```
```
13 Single-wide
```
```
1B 2D n Underline
```
```
Select or Cancel User-Defined Character Set
ASCII : ESC % n
```
```
Hexadecimal : 1B 25 n
```
```
Decimal: 27 37 n^
```
```
Value of n : 0= Code Page 437
```
```
1= User-defined (RAM character set)
```
```
2= Code Page 850
```
```
Range: 0 - 2
```
```
Default:
0 (Code Page 437)
```
```
Selects the character set. When an undefined RAM character is selected, the
Code Page 437 character is used. See the Printing Specification Guide for the character sets.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H25) & Chr$(n)
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 140
```
```
Define User-Defined Characters
Receipt Slip
```
```
ASCII: ESC & 3 c 1 c 2 n 1 d 1 ... n n d n ESC & 0 c 1 c 2 d 1 ... d n
```
```
Hexadecimal: 1B 26 3 c 1 c 2 n 1 d 1 ... n n d n 1B 26 0 c 1 c 2 d 1 ... d n
```
```
Decimal: 27 38 3 c 1 c 2 n 1 d 1 ... n n d n 27 38 0 c 1 c 2 d 1 ... d n
```
```
Defines and enters downloaded characters into RAM or Flash. The command may be used
to overwrite single characters. User-defined characters are available until power is turned
off or the Initialize Printer command (1B 40) is received.
Any invalid byte ( s , c 1, c 2, n 1) aborts the command.
User-defined character sets for both slip and receipt may be used at the same time. The
command clears bit image logo data from RAM. The illustration below provides a sample
of a character cell.
```
```
Defining User-Defined Characters for the Slip and Receipt Station
Defines and enters downloaded characters into RAM.
```
```
Top of Character Top of Character
```
```
Receipt Characters (1B 26 3) Slip Characters (1B 26 0)
```
```
Most Significant
Bit Is Not Printed
```
```
d
10
```
```
dn
```
```
MSB
```
```
LSB
```
```
d1 d4
```
```
dn
```
```
MSB
```
```
LSB
```
```
d1
```
```
d2
```
```
d3
```
```
d4
```
```
d5
```
```
dn
```

7167 Owner’s Manual Chapter 6: Commands

141 November 2003

```
Values and Ranges:
Receipt
c = the ASCII codes of the first ( c 1) and last ( c 2) characters respectively
c 1 = Hex 20-FF (Hex 20 is always printed as a space)
```
```
c 2 = Hex 20-FF (Hex 20 is always printed as a space)
To define only one character, use the same code for both c 1 and c 2.
n = the number of dot columns for the nth character as specified by n 1 ... n n
n = 1-10 (standard pitch), 12 and less accepted but ignored
n = 1-8 (compressed pitch), 12 and less accepted but ignored
d = the column data for the nth character as specified by d 1 ... d n
The number of bytes for a particular character cell is 3 x n 1.
The bytes are printed down and across each cell.
Slip
c = the ASCII codes of the first ( c 1) and last ( c 2) characters respectively
c 1 = Hex 20-FF (Hex 20 is always printed as a space)
c 2 = Hex 20-FF (Hex 20 is always printed as a space)
To define only one character, use the same code for both c 1 and c 2.
d = the column data for the nth character as specified by d 1 ... d n
Each character is defined by 12 bytes (only bytes 2-11 are printed.)
Each byte is one 7-dot high column (full- or half-dot column.)
Overlapped dots are not printed
The data must contain [( c 2 - c 1 + 1) x 12] bytes
Related Information:
See 1D 22 n (Select Memory Type Where to Save User-Defined Fonts.)
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 142
```
```
Select or Cancel Underline Mode
ASCII : ESC - n
```
```
Hexadecimal : 1B 2D n
```
```
Decimal: 27 45 n
```
```
Value of n : 0, 48 = Cancel underline mode^
```
```
1, 49 = Select underline mode
```
```
Default of n : 0 (Cancels underline mode)^
```
```
Turns underline mode on or off. Underlines cannot be printed for spaces set by the
Horizontal Tab, Set Absolute Start Position, or Set Relative Print Position commands.
This command and the Select Print Mode(s) command (1B 21) turn underline on and off in
the same way.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H2D) & Chr$(n)
Exceptions:
This command is ignored if n is out of the specified range.
This command is only available in 7158 Native Mode and 7167 Native Mode.
```
```
Copy Character Set from ROM to RAM
ASCII : ESC : 0 0 0
```
```
Hexadecimal : 1B 3A 30 30 30
```
```
Decimal: 27 58 48 48 48
```
```
Default: Code Page 437
```
```
Copies characters in the active ROM set to RAM. Use this command to re-initialize the
User-Defined Character Set. Code Page 437 is copied by default at initialization.
The command is ignored if current font is the user font.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H3A) & Chr$(&H30) & Chr$(&H30)
& Chr$(&H30)
Related Information:
```

7167 Owner’s Manual Chapter 6: Commands

143 November 2003

```
To modify characters in one of the character set variations, such as Rotated Print, select
one of the Rotated Print commands, copy to RAM, then use the Define User-Defined
Character Set command (1B 26).
```
```
Cancel User-Defined Characters
ASCII : ESC? n
```
```
Hexadecimal : 1B 3F n
```
```
Decimal: 27 63 n
```
```
Value of n : Specified character code
```
```
Range of n : 32 - 255
```
```
Cancels the pattern defined for the character code specified by n. After the user-defined
character is canceled, the corresponding pattern from Code Page 437 is printed.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H3F) & Chr$(n)
Exceptions:
This command is ignored if n is out of range or if the user-defined character is not defined.
```
```
Select or Cancel Emphasized Mode
ASCII : ESC E n
```
```
Hexadecimal : 1B 45 n
```
```
Decimal: 27 69
```
```
Value of n : 0 (bit 0), not selected
```
```
1 (bit 0), selected
```
```
Range of n : 0 - 255
```
```
Default:
0 (bit 0)
```
```
Starts or stops emphasized printing on slip and receipt. In Emphasized Mode on the slip,
each line is printed twice to improve penetration of multi-part forms and increase print
contrast. The second pass is printed the same direction as the first to ensure accuracy of
the overprint. Printing speed decreases due to the second printing pass.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 144
```
```
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H45) & Chr$(n)
Exceptions:
Only the lowest bit of n is effective.
Emphasized printing cannot be used with bit-images or downloaded bit-images.
Related Information:
This command and the Select Print Mode(s) command (1B 21) function identically.
```
```
Select Double Strike
7156 Emulation 7158 Native and
7167 Native Mode
```
```
ASCII : ESC G ESC G n
```
```
Hexadecimal : 1B 47 1B 47 n
```
```
Decimal: 27 71 27 71 n
```
```
Value of n : 0 = Off
```
```
1 = On
```
```
Turns double strike mode on for the slip station. Overprints a second pass of the print line
on the slip station to improve penetration of multi-part forms and increase print contrast.
The second pass is printed the same direction as the first to ensure accuracy of the
overprint. The printer is reset to the standard print mode after a line has been printed or
after a Clear Printer (0x10) command is received.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H47) & Chr$(n)
Exceptions:
These settings do not apply in Page Mode. However they can be set or cleared in Page
Mode.
Double-strike printing cannot be used with bit-images or downloaded bit-images.
This command functions the same as the 7156 when the printer is in 7156 Emulation
Mode. In Native Mode, the command takes a parameter to enable and disable it.
Related Information:
Printer output is the same as in Emphasized Mode.
```

7167 Owner’s Manual Chapter 6: Commands

145 November 2003

```
Cancel Double Strike
ASCII: ESC H
```
```
Hexadecimal: 1B 48
```
```
Decimal: 27 72
```
```
Turns off double strike mode on the slip station in 7156 Emulation Mode.
This command is ignored in the 7158 Native Mode and 7167 Native Mode.
This command works on both slip and receipt stations.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H48)
```
```
Select or Cancel Italic Print
ASCII : ESC I n
```
```
Hexadecimal : 1B 49 n
```
```
Decimal: 27 73 n
```
```
Value of n : 0 = Off
```
```
1 = On
```
```
(When 0 and 1 are the Least Significant Bit, LSB)
```
```
Default: 0 (Off)
```
```
Turns Italic print mode on or off. This command is only available in 7158 Native Mode
and 7167 Native Mode.. Italic print mode is available for built-in, user-defined characters.
This command only works on the receipt station.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H49) & Chr$(n)
Exceptions:
Only the lowest bit of n is valid. This command is only valid for the receipt station in 7158
Native Mode and 7167 Native Mode..
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 146
```
```
Select International Character Set
ASCII : ESC R n or ESC t n
```
```
Hexadecimal : 1B 52 n or 1B 74 n
```
```
Decimal: 27 82 n or 27 116 n
```
(^) 7158 Native Mode and
7167 Native Mode.
7156 Emulation
**Value of** **_n_** **:** 0 = Code Page 437 US English 0 = Code Page 437
1 = Code Page 850 Multilingual 1 = Code Page 850
2 = Code Page 852 Slavic
3 = Code Page 860 Portuguese
4 = Code Page 863 French Canadian
5 = Code Page 865 Nordic
6 = Code Page 858 Multilingual with Euro Symbol
7 = Code Page 866 Cyrillic
8 = Code Page 1252 Windows Latin I
9 = Code Page 862 Hebrew
20 = Code Page Katakana
21 = Code Page 874 Thailand
22 = Code Page 864 Arabic
128 = Code Page 932 Kanji^2
129 = Code Page 936 Simple Chinese^1
130 = Code Page Korean^1
131 = Code Page Traditional Chinese^1
(^2) Not supported by 7167-1035 and 7167-2035


7167 Owner’s Manual Chapter 6: Commands

147 November 2003

```
Selects the character set to be used. See Print Specifications for the character sets.
There are two codes for this command. Both codes perform the same function.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H52) & Chr$(n)
Related Information:
This command may also be known as Select Character Code Table.
```
```
Select Character Code Table
See the previous command, Select International Character Set.
```
```
Select or Cancel Unidirectional Printing Mode
ASCII : ESC U n
```
```
Hexadecimal : 1B 55 n
```
```
Decimal: 27 85 n
```
```
Value of n : 0 = select bi-directional
```
```
1 = select unidirectional
```
```
Default: 0 (bi-directional)
```
```
Toggles between unidirectional and bi-directional printing on the slip station.
Unidirectional printing increases column alignment and provides higher quality printing.
Printing is normally bi-directional because of the faster speed.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H55) & Chr$(n)
```
```
Select or Cancel 90 Degrees Clockwise Rotated Print
ASCII : ESC V n
```
```
Hexadecimal : 1B 56 n
```
```
Decimal: 27 86 n
```
```
Value of n : 0 = Cancel
```
```
1 = Set
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 148
```
```
Default: 0 (Cancel)
```
```
Rotates characters 90 degrees clockwise. The command remains in effect until the printer is
reset or the Clear Printer (0x10) command is received. See Summary of Rotated Printing in
this chapter.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H56) & Chr$(n)
```
```
Select Print Color
ASCII : ESC r n
```
```
Hexadecimal : 1B 72 n
```
```
Decimal: 27 114 n
```
```
Value of n : 0 = Black
```
```
1 = 2nd Color
```
```
Default: 0 (Black)
```
```
Selects color printing. Color printing is valid for character, graphics, logo, and barcodes.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H72) & Chr$(n)
Exceptions:
The command is valid only for receipt station.
```
```
Select or Cancel Upside Down Printing Mode
ASCII : ESC { n
```
```
Hexadecimal : 1B 7B n
```
```
Decimal: 27 123 n
```
```
Value of n : 0 = Cancel
```
```
1 = Set
```
```
Default: 0 (Cancel)
```
```
Prints upside-down characters. The character order is inverted in the buffer so text is
readable. The command remains in effect until the Rotated Print (1B 12) command is
```

7167 Owner’s Manual Chapter 6: Commands

149 November 2003

```
received. Only bit 0 is used. Bits 1-7 are not used. See Summary of Rotated Printing in this
document for more information.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H7B) & Chr$(n)
Exceptions:
The command is valid only at the beginning of a line.
The Rotated Print command (1B 12) cancels this command.
```
```
Select Character Size
ASCII : GS! n
```
```
Hexadecimal : 1D 21 n
```
```
Decimal: 29 33 n^
```
```
Value of n : 1 - 8 = vertical number of times normal font
```
```
1 – 8 = horizontal number of times normal font
```
```
Range of n : 00 – 07, 10 – 17, ... 70 – 77
```
```
Default of n : 0
```
```
Selects the character height using bits 0 to 2 and selects the character width using bits 4 to
7, as follows:
```
```
Character Width Selection
Hex Decimal Width
00 0 1 (normal)
10 16 2 (two times width)
20 32 3 (three times width)
30 48 4 (four times width)
40 64 5 (five times width)
50 80 6 (six times width)
60 96 7 (seven times width)
70 112 8 (eight times width)
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 150
```
```
Character Height Selection
Hex Decimal Height
00 0 1 (normal)
01 1 2 (two times height)
02 2 3 (three times height
03 3 4 (four times height)
04 4 5 (five times height)
05 5 6 (six times height)
06 6 7 (seven times height)
07 7 8 (eight times height)
```
```
This command is effective for all characters (except for HRI characters).
In Standard Mode, the vertical direction is the paper feed direction, and the horizontal
direction is perpendicular to the paper feed direction. However, when character
orientation changes in 90 degree clockwise-rotation mode, the relationship between
vertical and horizontal directions is reversed.
In Page Mode, vertical and horizontal directions are based on the character orientation.
When characters are enlarged with different sizes on one line, all the characters on the line
are aligned at the baseline.
The Select Print Mode (1B 21 n) command can also select or cancel double-width and
double-height modes. However, the setting of the last received command is effective.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H21) & Chr$(n)
Exceptions:
If n is out of the defined range, this command is ignored. This command is only valid for
the receipt station.
This is only available in 7158 Native Mode and 7167 Native Mode..
```
```
Select or Cancel White/Black Reverse Print Mode
ASCII : GS B n
```
```
Hexadecimal : 1D 42 n
```
```
Decimal: 29 66 n
```
```
Value of n : 0 = Off
```
```
Range of n : 1 = On(Only the lowest bit is used.)
```
```
Default of n : 0 – 255
```
```
0 (Off)
```

7167 Owner’s Manual Chapter 6: Commands

151 November 2003

```
Turns on White/Black reverse printing mode. This command is only available in 7158
Native Mode and 7167 Native Mode.. In White/Black reverse printing mode, print dots
and non-print dots are reversed, which means that white characters are formed by
printing a black background. When the White/Black reverse printing mode is selected it is
also applied to character spacing which is set by Right-Side Character Spacing (1B 20).
This command can be used with built-in characters and user-defined characters, but does
not affect the space between lines.
White/Black Reverse Print Mode does not affect bit image, downloaded bit image, bar
code, HRI characters, and spacing skipped by Horizontal Tab (09), Set Absolute Starting
Position (1B 24...), and Set Relative Print Position (1B 5C).
White/Black reverse mode has a higher priority than Underline Mode. When Underline
Mode is on and White/Black Reverse Print Mode is selected, Underline Mode is disabled,
but not canceled.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H42) & Chr$(n)
Exceptions:
This command is only valid on the receipt station.
This is only available in 7158 Native Mode and 7167 Native Mode..
```
```
Select or Cancel Smoothing Mode
ASCII: GS b n
```
```
Hexadecimal: 1D 62 n
```
```
Decimal: 29 98 n
```
```
This command is ignored.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H62) & Chr$(n)
```
```
Select Superscript or Subscript Modes
ASCII: US ENQ n
```
```
Hexadecimal: 1F 05 n
```
```
Decimal: 31 05 n
```
```
Value of n : 0 = Normal character size
```
```
1 = Select subscript size
```
```
2 = Select superscript size
```
```
Default: 0 (normal size)
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 152
```
```
Turns superscript or subscript modes on or off. This attribute may be combined with other
characters size settings commands ( 12, 13, 1B 21 n , 1D 21 n , ...)
This command is only available on the receipt station in 7158 Native Mode and 7167
Native Mode..
Example:
MSComm1.Output = Chr$(&H1F) & Chr$(&H05) & Chr$(n)
Exceptions:
This command is ignored if n is out of the specified range.
This is only available in 7158 Native Mode and 7167 Native Mode..
```

7167 Owner’s Manual Chapter 6: Commands

153 November 2003

```
Summary of Rotated Printing
The table shows the combinations of Set/Cancel Upside-Down Print, Set/Cancel Rotated
Print (clockwise), and Rotated Print (counterclockwise). Rotated CCW is mutually
exclusive with the other two commands. Unintended consequences may result when
rotated CCW is mixed with other commands.
The samples of the print show only the normal size characters. Double-wide and double-
high characters are printed in the same orientation (double-high characters cannot be
printed on the slip station). They may also be mixed on the same line.
```
```
Upside Down
(1B 7B n)
```
```
Rotated CW
(1B 56 n)
```
```
Rotated CCW
(1B 12)
```
```
Resulting Output
```
Canceled Canceled Cleared ABC

```
Canceled Set X ABC
```
```
Set Canceled X ABC
```
```
Set Set X CBA
```
```
X X Set ABC
```
```
Note: The following print modes cannot be mixed on the same line:
```
1. Standard and compressed pitch
2. Vertical (normal) and rotated
3. Right-side up and upside down
4. Single high (normal) and double high


7167 Owner’s Manual Chapter 6: Commands

```
November 2003 154
```
#### Status Commands

```
These commands are used to enter and print graphics data and are described in order of
their hexadecimal codes.
```
```
Download BMP Logo
ASCII: ESC (+*.BMP file data)
```
```
Hexadecimal: 1B (+*.BMP file data)
```
```
Decimal: 27 (+*.BMP file data)
```
```
Value: Maximum width = 576
```
```
Maximum height = 512
```
```
Enters a BMP file data into RAM or Flash.
This command is used by sending the file data of a monochrome BMP file preceded by a
0 x 1B. The bit map is stored in the printer in the same manner as a down loaded bit
image.
The downloaded BMP file can be printed by using the Print Downloaded Bit Image (1D 2F
m) command.
Example:
```
1. MSComm1.Output = Chr$(&H1B)
2. Open bitmapfile For Binary As filehandle
3. filecontent = Input(LOF(filehandle), filehandle)
4. MSComm1.Output = filecontent & vbLf
5. This last step is to use the print downloaded image command to print
Exceptions:
BMP file images that are not monochrome are ignored. This command is only valid for the
receipt station.
This is only available in 7158 Native Mode and 7167 Native Mode..
Related Information:
See 1D 22 n (Select Memory Type to save logos.)

```
For the 7158 native mode and 7167 Native Mode. of operation, if multiple logos are to be
defined and used, this command should be preceded by the Select Current Logo
command to define the number by which this downloaded logo is to be referenced.
```

7167 Owner’s Manual Chapter 6: Commands

155 November 2003

```
Select Bit Image Mode
ASCII: ESC * m n 1 n 2 d 1 ... d n
```
```
Hexadecimal: 1B 2A m n 1 n 2 d 1 ... d n
```
```
Decimal: 27 42 m n 1 n 2 d 1 ... d n
```
```
Sets the print resolution and enters one line of graphics data into the print buffer. Excess
data is accepted but ignored. Any print command is required to print the data, after which
the printer returns to normal processing mode.
See the illustration graphic representation of the bit image.
In 7156 Emulation Mode, slip graphics are only 7- bit (MSB not printed.) In 7158 Native
Mode and 7167 Native Mode., slip graphics are 8-bit.
Values:
Receipt Station
Value
of m
```
```
Mode No. of Dots
(Vertical)
```
```
No. of Dots (Horizontal) Number of
Dots/Line
0 8 Dot Single
Density
```
##### 8 (68 DPI) 0-288 (101DPI,

```
80mm)
0-212 (101DPI,
58mm)
```
```
8x288 (80mm)
8x212 (58mm)
```
```
1 8 Dot Double
Density
```
##### 8 (68 DPI) 0-576 (101DPI,

```
80mm)
0-424 (101DPI,
58mm)
```
```
8x576 (80mm)
8x424 (58mm)
```
```
32 24 Dot Single
Density
```
##### 24 (203 DPI) 0-288 (101DPI,

```
80mm)
0-212 (101DPI,
58mm)
```
```
24x288
(80mm)
24x212
(58mm)
33 24 Dot
Double
Density
```
##### 24 (203 DPI) 0-576 (101DPI,

```
80mm)
0-424 (101DPI,
58mm)
```
```
24x576
(80mm)
24x424
(58mm)
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 156
```
```
Slip Station
Value
of m
```
```
Mode No. of Dots**
(Vertical)
```
```
No. of Dots (Horizontal) Number of
Dots/Line
0 7 Dot Single
Density
```
```
7 (72 DPI) 224 (69.5 DPI) 7 x 224
```
```
1* 7 Dot Double
Density
```
```
7 (72 DPI) 448 (139 DPI) 7 x 448
```
```
32, 33 Not Available
on Slip
In single density, one byte (7 dots) is printed in each full dot column; in
double density, one byte is printed in each half/full dot column.
*Adjacent horizontal dots (overlapping dots) are not printed on the slip.
**In 7158 Native Mode and 7167 Native Mode.. There are 8 vertical dots.
```
```
Value of n (8-Dot
Single-Density Mode)
```
```
Value of n (24-Dot
Single-Density Mode)
Value of d
n1 + (256 x n2) 3 x [n1 + (256 x n2)] Number of Bytes of Data*
*Printed left to right (8-dot mode); Printed down then across (24-dot mode).
```
```
Formulas:
8 Dot Single Density n 1 + (256 x n 2)
24 Dot Single Density 3 x [ n 1 + (256 x n 2)]
```
```
Top of Bit Image
```
```
8-Dot Single-DensityMode—Receipt and Slip Receipt Slip
```
```
Most Significant
Bit Is Not Printed
In A756 Emulation
```
```
d1 d2 d3 d4 dn dn
```
```
MSB
```
```
LSB
```
```
dn
```
```
MSB
```
```
LSB
```

7167 Owner’s Manual Chapter 6: Commands

157 November 2003

```
Top of Bit Image
```
```
24-Dot Single-Density Mode—Receipt Only
```
```
dn
```
```
MSB
```
```
LSB
```
```
d1
```
```
d2
```
```
d3
```
```
d4 d7
```
```
d5
```
```
d6 dn
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 158
```
```
Select Double-Density Graphics
ASCII: ESC Y n 1 n 2 d 1 ... d n or ESC L n 1 n 2 d 1 ... d n
Hexadecimal: 1B 59 n 1 n 2 d 1 ... d n or 1B 4C n 1 n 2 d 1 ... d n
Decimal: 27 89 n 1 n 2 d 1 ... d n or 27 76 n 1 n 2 d 1 ... d n
```
```
Value of n :
```
```
Value of n (8-Dot Single
Density Mode)
```
```
Value of n (24-Dot Single
Density Mode)
Value of d
n 1 + (256 x n 2) 3 x [ n 1 + (256 x n 2)] Number of Bytes of Data
(Printed Down, Then
Across)
```
```
Enters one line of 7 (slip in 7156 mode) or 8-dot double-density graphics into the print
buffer. Any print command is required to print the line, after which the printer returns to
normal processing mode. The number of bytes sent is represented by the formulas in the
table.
Each bit corresponds to one horizontal dot. Compare to Set Bit Image Mode (1B 2A, m=1)
earlier in this document.
Exception:
1B 4C n 1 n 2 d 1 ... d n is only valid in 7156 Emulation Mode.
```
```
Select the Current Logo (Downloaded Bit Image)
ASCII: GS # n
```
```
Hexadecimal: 1D 23 n
```
```
Decimal: 29 35 n
```
```
Range of n : 0 – 255
```
```
Selects a logo to be defined or printed. The active logo n remains in use until this
command is sent again with a different logo n.
When this command precedes a logo definition, that definition is stored in Flash Memory
as logo n. If there is already a different definition in Flash Memory for logo n , the first is
inactivated and the new definition is used. The inactive definition is not erased from Flash
and continues to take up space in Flash Memory.
When this command precedes a logo print command and n is different from the
previously active logo selected, the printer retrieves the logo definition for n from Flash
Memory and prints it. If there is no definition for logo n , then no logo is printed.
In the case of a previously existing application that expects only one possible logo, the
printer will not receive the Select Current Logo (1D 23 n ) command. In this case, the
printer assigns 0 as the active logo identifier. It automatically stores any new logo
definition in Flash Memory as logo 0, inactivating any previous logo 0 definition. If the
Flash Memory space available for logos fills up with inactive logo 0 definitions, the
```

7167 Owner’s Manual Chapter 6: Commands

159 November 2003

```
firmware erases the old definitions at the next power cycle. This is the only case in which
the printer erases Flash Memory without an application command.
In the case of a new application using multiple logos, the Select Current Logo (1D 23 n )
command is used. After that, the printer no longer automatically erases the logo definition
Flash Memory page when it fills with multiple definitions. A new application using
multiple logos, writing a user-defined character set into Flash Memory, or both, is
responsible for erasing the logo and user-defined character set Flash Memory page when
the logo area is full or before a new character set is defined.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H23) & Chr$(n)
Exceptions:
This command is only valid for the receipt station. However, it will be processed correctly
regardless of whether the receipt station is currently selected.
```
```
Define Downloaded Bit Image
ASCII: GS * n^1 n^2 d 1 ... d n]
```
```
Hexadecimal: 1D 2A n^1 n^2 d 1 ... d n]
```
```
Decimal: 29 42 n^1 n^2 d 1 ... d n
```
```
Value of n1 : See the following table.
```
```
Value of n2 : See the following table.
```
```
Value of d : See the following table.
```
```
Value of n1 Value of n2 Value of d
1-72 (8 x n 1 = Number of
Horizontal Dot Columns)
```
```
1-64 (Number of Vertical
Bytes)*
```
```
Bytes of Data
(Printed Down
Then Across)
*The number of bytes sent is represented by the following formula:
n = 8 x n 1 x n 2 ( n 1 x n 2 must be less than or equal to 4608).
```
```
Enters a downloaded bit image (such as a logo) into RAM or Flash with the number of
dots specified by n 1 and n 2 in 7156 Emulation, unless loaded into Flash. The downloaded
bit image is available until power is turned off, another bit image is defined, or either
Initialize Printer (1B 40), or Define User-Defined Character Set (1B 26), command is
received.
By default, 7156 Emulation loads downloaded bit image to SRAM, while 7158 Native
Mode and 7167 Native Mode loads them to Flash.
See the illustration on the following page for a graphic representation of the downloaded
bit image.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 160
```
```
d1
```
```
d2
```
```
d dn
```
```
Top of Graphic
```
```
dn
```
```
MSB
```
```
LSB
```
```
Column Column
One 72 x 8 Max.
```
```
Row
One
```
```
Row 64
Max. 64
```
```
65
```
```
d
```
```
Exceptions:
See the illustration for the Print Downloaded Bit Image command (1D 2F) for a
representation of the bit image.
Related Information:
See 1D 22 n (Select Memory Type to store logos) and 1D 23 n (Select the Current Logo.)
For the 7158 native mode and 7167 Native Mode of operation, if multiple logos are to be
defined and used, this command should be preceded by the Sleect Current Logo
command to define the number by which this dowloaded logo is to be referenced.
```

7167 Owner’s Manual Chapter 6: Commands

161 November 2003

```
Print Downloaded Bit Image
ASCII : GS / m
```
```
Hexadecimal : 1D 2F m
```
```
Decimal: 29 47 m
```
```
Value and Range of m :
```
```
Value of m Print Mode Vertical DPI^1 Horizontal DPI*
0
1
2
3
```
```
Normal
Double Wide
Double High
Quadruple
```
##### 203

##### 203

##### 101

##### 101

##### 203

##### 101

##### 203

##### 101

(^1) Dot density measured in dots per inch
Prints a downloaded bit image in RAM or Flash on the receipt station at a density
specified by _m_. It is ignored if any data is in the print buffer, if the downloaded bit image
is undefined, or if the data defined exceeds one line.
See the illustration for a representation of the bit image.
d1
d2
d dn
Top ofGraphic
dn
MSB
LSB
Column Column
One 72 x 8 Max.
Row
One
Row 64
Max. 64
65
d
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H2F) & Chr$(m)
Related Information:
See 1D 22 n (Select Memory Type to store logos) and 1D 23 n (Select the Current Logo.)


7167 Owner’s Manual Chapter 6: Commands

```
November 2003 162
```
```
Convert 6 Dots/mm Bitmap to 8 Dots/mm Bitmap
ASCII: US EOT n^
```
```
Hexadecimal: 1F 04 n^
```
```
Decimal: 31 04 n^
```
```
Value: 0 = Off
```
```
1 = On
```
```
Default: 0 (Off)
```
```
Selects or cancels 6 dot/mm in 7158 Emulation Mode and 7167 Native Mode.
When the 6 dot/mm emulation is selected, logos and graphics are expanded horizontally
and vertically to emulate their size on a 6 dot/mm printer. The horizontal positioning
commands also emulate positioning on a 6 dot/mm printer.
Example:
MSComm1.Output = Chr$(&H1F) & Chr$(&H04) & Chr$(n)
Exception:
This command is available in 7158 Native Mode and 7167 Native Mode only.
```

7167 Owner’s Manual Chapter 6: Commands

163 November 2003

#### Auto Status Back Commands

```
Status Command Introduction
The 7167 has three methods of providing status to the application. These methods are
through Batch Status Commands, Real Time Status Commands, and Auto Status Back. An
application may use one or more of these methods to understand the current status of the
printer. A brief description of each of these methods follows.
Batch Status Commands – These commands are sent to the printer and stored in the
printer’s buffer. Once the printer has processed all the previous commands these
commands are processed and the proper status is returned to the application. In the event
a condition causes the printer to go BUSY, it stops processing commands from the printer
buffer. If a Batch Status Command remained in the buffer during this busy condition, it
would not be processed. In fact, no Batch Commands are processed while the printer is in
this state.
Real-Time Commands – These commands are sent to the printer and are NOT stored in
the printer’s buffer. Instead, they are acted on immediately (regardless of the printer’s
BUSY status) and their response (if any) is returned to the application. This gives the
application the ability to query the printer when it is in a busy state in order to correct
whatever fault has occurred.
Auto Status Back – This mechanism allows the application developer to program the
printer to automatically respond with a four byte status when certain conditions in the
printer change.
Please see the subsequent sections for a more detailed description of these status
commands. At the end of this Status Commands section is a page entitled “Recognizing
Data from the Printer”. This describes how to interpret what command or setting (in the
case of Auto Status Back) triggered a response from the printer.
```
```
Batch Mode
For RS-232C printers, these commands enable the printer to communicate with the host
computer following the selected handshaking protocol, either DTR/DSR or XON/XOFF.
They are stored in the printer's data buffer as they are received, and are handled by the
firmware in the order in which they are received.
When a fault occurs, the printer will go busy at the RS-232C interface and not respond to
any of the Batch Mode Printer Status commands. If the fault causing the busy condition
can be cleared, such as by loading paper, or letting the thermal print head cool down, the
printer will resume processing the data in its receive buffer.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 164
```
```
Transmit Peripheral Device Status
ASCII : ESC u 0
```
```
Hexadecimal : 1B 75 0
```
```
Decimal: 27 117 0
```
```
Bit 0 Bit 1
```
```
Return Value: 1 = Drawer 1 closed 1 = Drawer 2 closed
```
```
0 = Drawer 1 open 0 = Drawer 2 open
```
```
(Bits 2-7 are not used)
```
```
Transmits current status of the cash drawers. One byte is sent to the host computer. In
DTR/DSR protocol the printer waits for DSR = SPACE. If a drawer is not connected, the
status will indicate it is closed.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H75) & Chr$(&H0)
```

7167 Owner’s Manual Chapter 6: Commands

165 November 2003

```
Transmit Printer Status
ASCII : ESC v
```
```
Hexadecimal : 1B 76
```
```
Decimal: 27 118
```
```
Sends status data to the host computer. The printer sends one byte to the host computer
when it is not busy or in a fault condition. In DTR/DSR protocol, the printer waits for DSR
= SPACE.
```
```
Status Byte (RS-232C)
Bit Function 0 Signifies 1 Signifies
0 Receipt Paper Ok Low
1 Receipt Cover or Front Cover Closed Open
2 Receipt Paper Ok Out
3 Knife or Slip Ok Jam
4 Always Zero
5 Slip Leading Edge Sensor Not Covered Covered
6 Slip Trailing Edge Sensor Not Covered Covered
7 Thermal Head Temp or Voltage Ok Out of Range
```
```
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H76)
Related Information:
See Real Time Commands, in this document for details about fault condition reporting.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 166
```
```
Transmit Printer ID
ASCII GS I n
```
```
Hexadecimal 1D 49 n
```
```
Decimal 29 73 n
```
```
Value of n 1, 49 = Printer model ID
```
```
2, 50 = Type ID
```
```
3, 51 = ROM version ID
```
```
4, 52 = Logo definition
```
```
Transmits the printer ID specified by n as follows:
N Printer ID Specification ID (hexadecimal)
1, 49 Printer model ID NCR 7167 0xA1 (7167 Native Mode)
1, 49 Printer model ID NCR 7158 0x28 (7158 Native Mode)
1, 49 Printer model ID NCR 7156 0x26 (7156 Emulation)
1, 49 Printer model ID NCR 7150 0x02 (7150 Mode)
2, 50 Type ID Installed options Refer to the table below
3, 51 ROM version ID ROM version 0x00
4, 52 Logo Definition Logo Definition Refer to table below
```
```
Type ID (n=2)
Bit Off/On Hex Decimal Function
0 Off 00 0 No two-byte character code installed.
On 01 1 Two-byte character code installed.
1 Off 00 0 No knife installed.
On 02 2 Knife installed.
2 - - - Undefined
3 Off 00 0 No MICR installed.
On 08 8 MICR installed.
4 Off 00 0 Not used. Fixed to Off.
5 - - - Undefined
6 - - - Undefined
7 Off 00 0 Not used. Fixed to Off.
```

7167 Owner’s Manual Chapter 6: Commands

167 November 2003

```
Type ID (n=4)
Bit Off/On Hex Decimal Function
0 Off 00 0 No logo definition loaded by application.
On 01 1 Logo loaded by application.
1 - - - Undefined
2 - - - Undefined
3 - - - Undefined
4 Off 00 0 Not used. Fixed to Off.
5 - - - Undefined
6 - - - Undefined
7 Off 00 0 Not used. Fixed to Off.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H49) & Chr$(n)
```
```
Transmit Printer ID, Remote Diagnostics Extension
ASCII : GS I @ n
```
```
Hexadecimal : 1D 49 40 n
```
```
Decimal: 29 73 64 n
```
```
Values of n : Refer to table above
```
```
Range of n : 32 – 255
```
```
(not all defined but reserved)
```
```
Performs the remote diagnostic function specified by n.
Eighteen remote diagnostic items are defined: eight printer ID items and ten printer tally
items. A group of four remote diagnostic functions is assigned to each diagnostic item.
Most of the diagnostic items are maintained in non-volatile memory (NVRAM), but some
are maintained in read-only memory (ROM).
The table that follows describes the variables.
The first item group in the table includes an example of data to send and to receive. Data
sent from the host to write to NVRAM must contain all digits required by the remote
diagnostic item. All data must be ASCII. The printer returns all ASCII data. It is preceded
by the parameter n to identify the diagnostic item and is followed by a Carriage Return
(0D) to signify the end of the data.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 168
```
```
The command performs the remote diagnostic function specified by n as described in the
following table.
```
```
Value of n Remote Diagnostic Item Function
ASC Hex Dec
Space 20 32 Serial #,
10 digit ASCII
```
```
Write to NVRAM
Example, send 14 bytes to printer: GS I @
0x20 1234567890
! 21 33 Serial # ,
10 digit ASCII
```
```
Write to NVRAM, and print on receipt to
verify
Example, send 14 bytes to printer: GS I @
! 1234567890
This will print on receipt: Serial # written:
1234567890
“ 22 34 Serial # Not available, cannot clear Serial # item
# 23 35 Serial # Return Serial #, preceded by n to identify
Printer returns 12 bytes in above example:
#1234567890<CR>
$ 24 36 Class/model #,
15 digit ASCII
```
```
Write to NVRAM
```
```
% 25 37 Class/model # Write to NVRAM, and print on receipt to
verify
‘ 27 39 Class/model # Return Class/model #, returns 17 bytes
+ 2B 43 Boot firmware part
#, 12 digit ASCII
```
```
Return Boot firmware part #, returns 14
bytes
/ 2F 47 Boot firmware
CRC, 4 digit ASCII
```
```
Return Boot firmware CRC, returns 6
bytes
3 33 51 Flash firmware part
#, 12 digit ASCII
```
```
Return Flash firmware part #, returns 14
bytes
7 37 55 Flash firmware
CRC, 4 digit ASCII
```
```
Return Flash firmware CRC, returns 6
bytes
Ç 80 128 Receipt lines tally,
8 digit ASCII
numeric,
max 99,999,999
```
```
Write to NVRAM
Example, send 12 bytes to printer: GS I @
Ç00010000
To set receipt lines tally to 10,000
ü 81 129 Receipt lines tally Write to NVRAM, and print on receipt to
verify
Example, send 12 bytes to printer: GS I @
ü00010000
This will print on receipt: Receipt tally
written: 10,000
é 82 130 Receipt lines tally Clear receipt lines tally to 0
â 83 131 Receipt lines tally Return receipt lines tally, preceded by n
to identify
Printer returns 10 bytes in above example:
â00010000<CR>
```

7167 Owner’s Manual Chapter 6: Commands

169 November 2003

```
Value of n Remote Diagnostic Item Function
ASC Hex Dec
ä 84 132 Knife cut tally,
8 digit ASCII
numeric,
max 99,999,999
```
```
Write to NVRAM
```
```
à 85 133 Knife cut tally Write to NVRAM, and print on receipt to
verify
å 86 134 Knife cut tally Clear knife cut tally to 0
ç 87 135 Knife cut tally Return knife cut tally, returns 10 bytes
ê 88 136 Slip character tally,
8 digit ASCII
numeric,
max 99,999,999
```
```
Write to NVRAM
```
```
ë 89 137 Slip character tally Write to NVRAM, and print on receipt to
verify
è 8A 138 Slip character tally Clear slip character tally to 0
ï 8B 139 Slip character tally Return slip character tally, returns 10
bytes
î 8C 140 MICR read tally,
8 digit ASCII
numeric, max
99,999,999
```
```
Write to NVRAM
```
```
ì 8D 141 MICR read tally Write to NVRAM, and print on receipt to
verify
Ä 8E 142 MICR read tally Clear MICR read tally to 0
Å 8F 143 MICR read tally Return MICR read tally, returns 10 bytes
É 90 144 Hours on tally,
8 digit ASCII
numeric,
max 99,999,999
```
```
Write to NVRAM
```
```
æ 91 145 Hours on tally Write to NVRAM, and print on receipt to
verify
Æ 92 146 Hours on tally Clear Hours on tally to 0
ô 93 147 Hours on tally Return Hours on tally, returns 10 bytes
ù 97 151 Boot firmware
version
```
```
Return Boot firmware version, returns 6
bytes
ú A3 163 Flash firmware
version
```
```
Return Flash firmware version, returns 6
bytes
ñ A4 164 Flash cycles tally,
8 digit ASCII
numeric,
max 99,999,999
```
```
Write to NVRAM
```
```
Ñ A5 165 Flash cycles tally Write to NVRAM, and print on receipt to
verify
```
a (^) A6 166 Flash cycles tally Clear Flash cycles cut tally to 0


7167 Owner’s Manual Chapter 6: Commands

```
November 2003 170
```
```
Value of n Remote Diagnostic Item Function
ASC Hex Dec
```
ο (^) A7 167 Flash cycles tally Return Flash cycles cut tally, returns 10
bytes
¿ A8 168 Knife jams tally,
8 digit ASCII
numeric,
max 99,999,999
Write to NVRAM
┌ (^) A9 169 Knife jams tally Write to NVRAM, and print on receipt to
verify
┐ (^) AA 170 Knife jams tally Clear Knife jams tally to 0
½ AB 171 Knife jams tally Return Knife jams tally, returns 10 bytes
¼ AC 172 Cover openings
tally, 8 digit ASCII
numeric,
max 99,999,999
Write to NVRAM
¡ AD 173 Cover openings
tally
Write to NVRAM, and print on receipt to
verify
« AE 174 Cover openings
tally
Clear Cover openings tally to 0
» AF 175 Cover openings
tally
Return Cover openings tally, returns 10
bytes
█ (^) B2 178 Max Temperature
tally
Clear Max temp tally
| B3 179 Max Temperature
tally
Return Max Temperature tally, returns 10
bytes
┤ (^) B4 180 Slip lines tally,
8 digit ASCII
numeric,
max 99,999,999
Write to NVRAM
╡ (^) B5 181 Slip lines tally Write to NVRAM, and print on receipt to
verify
╢ (^) B6 182 Slip lines tally Clear Slip lines tally to 0
╖ (^) B7 183 Slip lines tally Return Slip Lines tally, returns 10 bytes
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H49) & Chr$(&H40) & Chr$(n) & CHR$(&H0D)


7167 Owner’s Manual Chapter 6: Commands

171 November 2003

```
Transmit Status
ASCII : GS r n
```
```
Hexadecimal
:
```
```
1D 72 n
```
```
Decimal: 29 114 n
```
**Value of** **_n_** **:** (^) 1, 49 = printer status
2, 50 = cash drawer status
3, 51 = slip paper status
4, 52 = Flash Memory status
Transmits the status specified by _n_. This is a batch mode command which transmits the
response after all prior data in the receive buffer has been processed. There may be a time
lag between the printer receiving this command and transmitting the response, depending
on the receive buffer status.
When DTR/DSR RS232C communications handshaking control is selected, the printer
transmits the one byte response only when the host signal DSR indicates it is ready to
receive data.
When XON/XOFF RS232C communications handshaking control is selected, the printer
transmits the one byte response regardless of the host signal DSR.
When Auto Status Back (ASB) is enabled using the Enable/Disable Automatic Status Back
command (1D 61), the status transmitted by this command (Transmit Status) and the ASB
status must be differentiated according to the information found in Recognizing Data from
the Printer. This is found in the Real Time Commands section of this document.


7167 Owner’s Manual Chapter 6: Commands

```
November 2003 172
```
```
The status bytes to be transmitted are described in the following four tables.
```
```
Printer Status (n = 1 or n = 49)
Bit Off/On Hex Decimal Status for Transmit Status
0
Off
On
```
##### 00

##### 01

##### 0

##### 1

```
Receipt paper adequate.
Receipt paper low.
1
Off
On
```
##### 00

##### 02

##### 0

##### 2

```
Receipt paper adequate.
Receipt paper low.
2
Off
On
```
##### 00

##### 04

##### 0

##### 4

```
Receipt paper present.
Receipt paper exhausted.
3 Off
On
```
##### 00

##### 08

##### 0

##### 8

```
Receipt paper present.
Receipt paper exhausted.
4 Off 00 0 Not used. Fixed to off.
5 Off
On
```
##### 00

##### 20

##### 0

##### 32

```
Slip leading edge sensor: paper present
Slip leading edge sensor: no paper.
```
```
6 Off
On
```
##### 00

##### 40

##### 0

##### 64

```
Slip trailing edge sensor: paper present
Slip trailing edge sensor: no paper.
7 Off 00 0 Not used. Fixed to off.
```
```
Cash Drawer Status (n = 2 or n = 50)
Bit Off/On Hex Decimal Status for Transmit Status
0
Off
On
```
##### 00

##### 01

##### 0

##### 1

```
One or both cash drawers open.
Both cash drawers closed.
1
Off
On
```
##### 00

##### 02

##### 0

##### 2

```
One or both cash drawers open.
Both cash drawers closed.
2 - - - Undefined
3 - - - Undefined
4 Off 00 0 Not used. Fixed to off.
5 - - - Undefined
6 - - - Undefined
7 Off 00 0 Not used. Fixed to off.
```
```
Slip Paper Status (n = 3 or n = 51)
Value of Byte Returned Slip Status
0 There is no more printing space on the current slip,
or the slip paper is not selected.
1 to 8 Remaining print area on the current slip, in number
of lines, at the currently set line spacing, when the
trailing edge sensor has become uncovered.
Until the trailing edge sensor becomes uncovered the
value reported will be 6, because there are at least 6
lines remaining.
There can be 7 or 8 lines remaining when the slip line
spacing has been set to less than 7.2 lines per inch.
```

7167 Owner’s Manual Chapter 6: Commands

173 November 2003

```
Flash Memory Status (n = 4 or n = 52)
Bit Off/On Hex Decimal Status for Transmit Status
0 Off 00 0 Undefined. Fixed to off.
1 Off 00 0 Undefined. Fixed to off.
2 Off
On
```
##### 00

##### 04

##### 0

##### 4

```
User data storage write successful.
User data storage write failed. Specified area
not erased.
3 Off
On
```
##### 00

##### 08

##### 0

##### 8

```
Flash logo area adequate. Definition stored.
Flash logo area not adequate for recent
definition.
4 Off 00 0 Not used. Fixed to off.
5 Off
On
```
##### 00

##### 20

##### 0

##### 32

```
No thermal user-defined characters written to
Flash
Thermal user-defined characters written to
Flash.
6 Off
On
```
##### 00

##### 04

##### 0

##### 64

```
No impact user-defined characters written to
Flash.
Impact user-defined characters written to
Flash.
7 Off 00 0 Not used. Fixed to off.
```
```
Range of n : 1 – 4
49 - 52
```
```
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H72) & Chr$(n)
Exceptions:
When n is out of the specified range, the command is ignored.
```
```
Send Printer Software Version
ASCII : US V
```
```
Hexadecimal : 1F 56
```
**Decimal:** (^) 31 86
The printer returns 8 bytes containing the boot and Flash software version. The first 4
bytes returned are an ASCII string for the boot version. The second 4 bytes are an ASCII
string for the boot version. Example: for 1.234.56(8bytes), the boot version is 1.23 and the
Flash version is 4.56.
Example:
MSComm1.Output = Chr$(&H1F) & Chr$(&H56)


7167 Owner’s Manual Chapter 6: Commands

```
November 2003 174
```
```
Recognizing Data from the Printer
An application sending various Real Time and non-Real Time commands to which the
printer responds can determine which command a response belongs to by the table below.
Responses to Transmit Peripheral Device Status (1B 75) and Transmit Paper Sensor Status
(1B 76) are non-Real Time responses and will arrive in the order in which they were
solicited.
```
```
Batch Mode Response Response Recognized By:
ASCII HEX
```
```
ESC u 0 1B 75 0 0 0 0 0 0 0 x x Binary
ESC v 1B 76 0 0 0 0 0 x x x Binary
GS I n 1D 49 n 0 x x 0 x x x x Binary
GS r n 1D 72 n 0 x x 0 x x x x Binary
```
```
Real-Time Response
Response Recognized By:
ASCII HEX
```
```
GS EOT n 1D 04 n 0 x x 1 x x 1 0 Binary
DLE EOT
n
```
```
10 04 n 0 x x 1 x x 1 0 Binary
```
```
GS ENQ 1D 05 1 x x x x x x x Binary
XON 0 0 0 1 0 0 0 1 Binary
XOFF 0 0 0 1 0 0 1 1 Binary
```
```
Auto Status Back (ASB)
Response Recognized By:
ASB Byte 1 0 x x 1 x x 0 0 Binary
ASB Bytes 2-4 0 x x 0 x x x x Binary
```

7167 Owner’s Manual Chapter 6: Commands

175 November 2003

#### Real Time Commands

```
These commands provide an application interface to the printer even when the printer is
not handling other commands (RS-232C communication interface only):
```
1. Real Time Status Transmission (GS Sequence and DLE Sequence)
2. Real Time Request to Printer (GS Sequence and DLE Sequence)
3. Real Time Printer Status Transmission
The Batch Mode Printer Status commands are placed in the printer’s data buffer as they
are received and handled by the firmware in the order in which they are received. If the
paper exhausts while printing data that was in the buffer ahead of the status command,
the printer goes busy at the RS-232C interface and suspends processing the data in the
buffer until paper is reloaded. This is true for all error conditions: knife home error, slip
paper jam, thermal print head overheat, etc.
In addition, there is no way to restart the printer after a paper jam, or to cancel a slip
waiting condition when using the Wait for Slip command.
The Real Time commands are implemented in two ways to correct these problems. Both
implementations offer the same functionality; which one you choose depends on the
current usage of your application.

```
Preferred Implementation
For a new application the GS (1D) sequences are recommended to avoid possible
misinterpretation of a DLE (0x10) sequence as a Clear Printer (0x10 0, ASCII DLE NUL)
command.
An application using these GS (1D) sequences, does not need to distinguish for the printer
between the new real time commands and the Clear Printer command. This
implementation is ideal for an existing 7156 application that already uses the Clear Printer
command or for a new application being developed.
```
```
Alternate Implementation
The alternate implementation uses the DLE (0x10) sequences as implemented on other
printers. An application using these DLE (0x10) sequences and the original 7156 Clear
Printer command (0x10) must distinguish for the printer between the new real time
commands and the Clear Printer command by adding a NUL (0x00) to the Clear Printer
command.
An application using these DLE (0x10) sequences must also send the second byte of the
sequence within 100 milliseconds of the first, to prevent the first byte being mistaken for a
Clear Printer command.
```
```
Rules for Using Real Time Commands
Three situations must be understood when using real time commands.
First, the printer executes the Real Time command upon receiving it and will transmit
status regardless of the condition of the DSR signal.
Second, the printer transmits status whenever it recognizes a Real Time Status
Transmission command sequence, even if that sequence happens to occur naturally within
the data of another command, such as graphics data.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 176
```
```
In this case the sequence will also be handled correctly as the graphics data it is intended
to be when the graphics command is executed from the buffer.
Third, care must be taken not to insert a Real Time command into the data sequence of
another command that consists of two or more bytes.
In this case the printer will use the real time command sequence bytes instead of the other
command’s parameter bytes when finally executing that other command from the buffer;
the other command will NOT be executed correctly.
These three situations generally preclude use of standard DOS drivers for the serial
communication ports when using real time commands.
```
```
Moving Data Through the Buffer
Another consideration is that an application should take care not to let the buffer fill up
with real time commands when the printer is busy at the RS-232C interface. A busy
condition at the RS-232C interface can be determined by bit 3 of the response to 1D 05 or
1D 04 1 or 10 04 1. The reason for a particular busy condition can be determined by other
responses to 1D 04 n or 10 04 n.
Although the printer responds to Real Time commands when it is busy, it will place them
into the buffer behind any other data there, and flush them out in the order in which they
were received. When the printer is busy due simply to buffer full (that is, it can’t print data
as fast as it can receive it), then data continues to be processed out of the buffer at
approximately print speed and the Real Time commands will eventually get flushed out.
When the printer is busy due to an error condition, then data stops being processed out of
the buffer until the condition clears one way or another. In either case, but more quickly in
the case of an error condition, the buffer can fill with real time commands.
When the DLE sequences are being used, the last byte stored when the buffer fills up
could be the DLE code, with no room for the subsequent EOT or ENQ. When this lone
DLE byte is finally processed out of the buffer it will be interpreted as a Clear Printer
command.
Similarly, when the GS sequences are being used, the last byte stored when the buffer fills
up could be the GS code, with no room for the subsequent EOT or ETX or ENQ. When this
lone GS byte is finally processed out of the buffer it will use the next byte, whatever it is,
as the second byte in its GS sequence.
To guard against this situation, an application should determine the cause of a busy
condition and take appropriate action or pace further real time commands to avoid filling
the buffer. There are a minimum of 256 bytes available in the printer’s buffer when it goes
busy.
```

7167 Owner’s Manual Chapter 6: Commands

177 November 2003

```
Real Time Status Transmission
GS Sequence DLE Sequence
```
```
ASCII : GS EOT n DLE EOT n
```
```
Hexadecimal : 1D 04 n 10 04 n
```
```
Decimal: 29 4 n 16 4 n
```
```
Value of n : GS/DLE Sequence
```
```
1 = Transmit printer status
```
```
2 = Transmit RS-232C busy status
```
```
3 = Transmit error status
```
```
4 = Transmit receipt paper status
```
```
5 = Slip paper status
```
```
Transmits the selected one byte printer status specified by n in Real Time according to the
following parameters. This command includes two sequences: GS and DLE and using
either or will produce the same result.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H04) & Chr$(n)
Exceptions:
The command is ignored if n is out of range.
An application using the DLE sequence must send EOT within 100 milliseconds of DLE or
the printer will misinterpret the DLE and execute a Clear Printer command. Avoid this
possibility by using the 1D 04 n sequence, which is handled exactly the same as 10 04 n.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 178
```
```
Related Information:
```
1 = Transmit Printer Status

```
Bit Status Hex Decimal Function
0 Off 00 0 Fixed to Off
1 On 02 2 Fixed to On
2 Off
On
```
##### 00

##### 04

##### 0

##### 4

```
One or both cash drawers open
Both cash drawers closed
3 Off
On
```
##### 00

##### 08

##### 0

##### 8

```
Not busy at the RS-232C interface
Printer is Busy at the RS-232C interface
4 On 10 16 Fixed to On
5 Undefined
6 Undefined
7 Off 00 0 Fixed to Off
```
2 = Transmit RS-232C Busy Status

```
Bit Status Hex Decimal Function
0 Off 00 0 Fixed to Off
1 On 02 2 Fixed to On
2 Off
On
```
##### 00

##### 04

##### 0

##### 4

```
Both receipt and cassette doors closed
Receipt or cassette door open
3 Off
On
```
##### 00

##### 08

##### 0

##### 8

```
Paper Feed Button is not pressed
Paper Feed Button is pressed
4 On 10 16 Fixed to On
5 Off
On
```
##### 00

##### 20

##### 0

##### 32

```
Printing not stopped due to paper
condition
Printing stopped due to paper condition
6 Off
On
```
##### 00

##### 40

##### 0

##### 64

```
No error condition
Error condition exists in the printer
7 Off 00 0 Fixed to Off
```

7167 Owner’s Manual Chapter 6: Commands

179 November 2003

3 = Transmit Error Status

```
Bit Status Hex Decimal Function
0 Off 00 0 Fixed to Off
1 On 02 2 Fixed to On
2 Off
On
```
##### 00

##### 04

##### 0

##### 4

```
No slip motor or flip jam
Slip motor or flip jam occurred
3 Off
On
```
##### 00

##### 08

##### 0

##### 8

```
No knife error
Knife error occurred
4 On 10 16 Fixed to On
5 Off
On
```
##### 00

##### 20

##### 0

##### 32

```
No unrecoverable error
Unrecoverable error occurred
6 Off
```
```
On
```
##### 00

##### 40

##### 0

##### 64

```
Thermal print head temp./power
supply voltage are in range
Thermal print head temp./power
supply voltage are out of range
7 Off 00 0 Fixed to Off
```
4 = Transmit Receipt Paper Status

```
Bit Status Hex Decimal Function
0 Off 00 0 Fixed to Off
1 On 02 2 Fixed to On
2 Off
On
```
##### 00

##### 04

##### 0

##### 4

```
Receipt paper adequate
Receipt paper low
3 Off
On
```
##### 00

##### 08

##### 0

##### 8

```
Receipt paper adequate
Receipt paper low
4 On 10 16 Fixed to On
5 Off
On
```
##### 00

##### 20

##### 0

##### 32

```
Receipt paper present
Receipt paper exhausted
6 Off
On
```
##### 00

##### 40

##### 0

##### 64

```
Receipt paper present
Receipt paper exhausted
7 Off 00 0 Fixed to Off
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 180
```
5 = Transmit Slip Paper Status

```
Bit Status Hex Decimal Function
0 Off 00 0 Fixed to Off
1 On 02 2 Fixed to On
2 Off
On
```
##### 00

##### 04

##### 0

##### 4

```
Slip paper selected
Receipt paper selected
3 Off
On
```
##### 00

##### 08

##### 0

##### 8

```
Not waiting for slip
Waiting for slip
4 On 10 16 Fixed to On
5 Off
On
```
##### 00

##### 20

##### 0

##### 32

```
Slip leading edge sensor: paper preset
Slip leading edge sensor: no paper
6 Off
On
```
##### 00

##### 40

##### 0

##### 64

```
Slip trailing edge sensor: paper preset
Slip trailing edge sensor: no paper
7 Off 00 0 Fixed to Off
```
```
Real Time Request to Printer
GS Sequence DLE Sequence
```
```
ASCII : GS ETX n or DLE ENQ n
```
```
Hexadecimal : 1D 03 n or 10 05 n
```
```
Decimal: 29 3 n or 16 5 n
```
```
Value of n : 1 = Recover and restart
```
```
2 = Recover and clear buffers
```
```
3 = Cancel slip waiting
```
```
The printer responds to a request from the host specified by n. This command includes
two sequences: GS and DLE. The operations performed depend on the value of n,
according to the following parameters.
n = 1:
Restarts printing from the beginning of the line where an error occurred, after recovering
from the error. Print settings that are normally preserved from line to line, such as
character height and width, are still preserved with this command. This sequence is
ignored except when the printer is busy due to an error condition.
If the receipt is selected, this command will attempt recovery from a knife error. Other
errors associated with the receipt, such as paper out or print head overheating, can be
recovered from only by clearing the specific condition, such as loading paper or letting the
print head cool down.
```

7167 Owner’s Manual Chapter 6: Commands

181 November 2003

```
If the slip is selected, this command will attempt recovery from a slip motor or flip jam by
re-homing the print head and waiting for a slip to be inserted before restarting the print.
Other errors associated with the slip, such as cassette door open, can be recovered from
only by clearing the specific condition, such as closing the cassette door.
n = 2:
Recovers from an error after clearing the receive and print buffers. Print settings that are
normally preserved from line to line, such as character height and width, are still
preserved with this command. This sequence is ignored except when the printer is busy
due to an error condition.
If the slip was selected when the error occurred, the receipt becomes selected when the
buffers are cleared. When printing on the slip is to continue, the slip must be selected
again.
The same error recovery possibilities exist as for n = 1.
n = 3:
Cancels the slip waiting status. This sequence is ignored except when the printer is
waiting for a slip to be inserted.
When slip waiting is canceled, the receive and print buffers are cleared and the receipt is
selected. When printing on the slip is to continue, the slip must be selected again.
Exampleusing the GS sequence:
MSComm1.Output = Chr$(&H1D) & Chr$(&H03) & Chr$(n)
Exceptions:
The command is ignored if n is out of range
An application using the DLE sequence must send ENQ within 100 milliseconds of DLE or
the printer will misinterpret the DLE and execute a Clear Printer command. Avoid this
possibility by using the 1D 03 n sequence that is handled exactly the same as 10 05 n.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 182
```
```
Real Time Printer Status Transmission
ASCII: GS ENQ
```
```
Hexadecimal: 1D 05
```
```
Decimal: 29 5
```
```
Transmits one byte status of the printer in real time.
Value of Byte:
Bit Status Hex Decimal Function
0 Off
On
```
##### 00

##### 01

##### 0

##### 1

```
Receipt paper adequate
Receipt paper low
1 Off
On
```
##### 00

##### 02

##### 0

##### 2

```
Receipt paper adequate
Receipt paper low
2 Off
On
```
##### 00

##### 04

##### 0

##### 4

```
Both receipt and cassette doors closed
Receipt or cassette door open
3 Off
On
```
##### 00

##### 08

##### 0

##### 8

```
Not busy at the RS-232C interface
Printer is busy at the RS-232C interface
4 Off
On
```
##### 00

##### 1

##### 0

##### 16

```
One or both cash drawers open
Both cash drawers closed
5 Off
On
```
##### 00

##### 20

##### 0

##### 32

```
Paper present at both slip sensors
Paper not present at one or both slip
sensors
6 Off
On
```
##### 00

##### 40

##### 0

##### 64

```
No error condition
Error condition exists in the printer
7 On 00 0 Fixed to On
```
```
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H05)
```

7167 Owner’s Manual Chapter 6: Commands

183 November 2003

#### Auto Status Back Commands

```
Select or Cancel Automatic Status Back
ASCII : GS a n
```
```
Hexadecimal : 1D 61 n
```
```
Decimal: 29 97 n
```
```
Value of n : Status of ASB
```
```
Enables or disables automatic status back (ASB) and specifies the status items. This
command is a batch mode command; that is, it is processed after all prior data in the
receive buffer has been processed. There may be a time lag between the printer receiving
this command and changing the ASB response, depending on the receive buffer status.
If any of the status items listed are selected, ASB is enabled and the printer automatically
transmits 4 status bytes whenever the selected status changes. If no status is selected, ASB
is disabled. All four status bytes are transmitted without checking DSR.
If the error status is enabled, a change in the following conditions will trigger the ASB:
```
1. Cash Drawer
2. Receipt Cover
3. Knife Error
4. Out-of-Range Print head Temperature
5. Out-of-Range Voltage
6. Paper Exhaust Status
7. Slip Paper
The bits of _n_ are defined in the table.
    Bit Off/On Hex Decimal Status for ASB
    0
       Off
       On

##### 00

##### 01

##### 0

##### 1

```
Cash drawer status disabled.
Cash drawer status enabled.
1
Off
On
```
##### 00

##### 02

##### 0

##### 2

```
RS-232C Busy status disabled.
RS-232C Busy status enabled.
2
Off
On
```
##### 00

##### 04

##### 0

##### 4

```
Error status disabled.
Error status enabled.
3
Off
On
```
##### 00

##### 08

##### 0

##### 8

```
Receipt paper roll status disabled.
Receipt paper roll status enabled.
4 - - - Undefined
5
Off
On
```
##### 00

##### 20

##### 0

##### 32

```
Slip detector, slip paper status disabled.
Slip detector, slip paper status enabled.
6 - - - Undefined
7 - - - Undefined
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 184
```
```
Default: 0 (ASB disabled)
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H61) & Chr$(n)
Exceptions
If n = 0, ASB is disabled.
Related Information
When Auto Status Back (ASB) is enabled using this command, the status transmitted by
other commands and the ASB status are differentiated according to the information found
in Recognizing Data from the printer, (in the Real Time Commands section in this
chapter). The status bytes to be transmitted are described in the following four tables.
Byte 1 = printer information
Byte 2 = error information
Byte 3 = paper sensor information
Byte 4 = paper sensor information
```
```
First Byte (Printer Information)
Bit Off/On Hex Decimal Status for ASB
0 Off 00 0 Not used. Fixed to off.
1 Off 00 0 Not used. Fixed to off.
2
Off
On
```
##### 00

##### 04

##### 0

##### 4

```
One or both cash drawers open.
Both cash drawers closed.
3
Off
On
```
##### 00

##### 08

##### 0

##### 8

```
Not Busy at the RS232C interface.
Printer is Busy at the RS232C interface.
4 On 10 16 Not used. Fixed to on.
5
Off
On
```
##### 00

##### 20

##### 0

##### 32

```
Receipt cover closed.
Receipt cover open.
6
Off
On
```
##### 00

##### 40

##### 0

##### 64

```
Paper Feed Button is not pressed.
Paper Feed Button is pressed.
7 Off 00 0 Not used. Fixed to off.
```

7167 Owner’s Manual Chapter 6: Commands

185 November 2003

```
Second Byte (Error information)
Bit Off/On Hex Decimal Status for ASB
0 - - - Undefined
1 - - - Undefined
2 Off
On
```
##### 00

##### 04

##### 0

##### 4

```
No Mechanical Error
Mechanical Error Occurred
3
Off
On
```
##### 00

##### 08

##### 0

##### 8

```
No knife error.
Knife error occurred.
4 Off 00 0 Not used. Fixed to off.
5
Off
On
```
##### 00

##### 20

##### 0

##### 32

```
No unrecoverable error.
Unrecoverable error occurred.
6
Off
On
```
##### 00

##### 40

##### 0

##### 64

```
No recoverable error occurred
Recoverable error occurred:
Receipt cover open
Cassette cover open
Receipt paper exhausted
Thermal print head temp out of
range.
Power supply voltage out of range.
7 Off 00 0 Not used. Fixed to off.
```
```
Third Byte (Paper Sensor Information)
```
```
Bit Off/On Hex Decimal Status for ASB
0 Off
On
```
##### 00

##### 01

##### 0

##### 1

```
Receipt paper adequate
Receipt paper low
1 Off
On
```
##### 00

##### 02

##### 0

##### 2

```
Receipt paper adequate
Receipt paper low
2
Off
On
```
##### 00

##### 04

##### 0

##### 4

```
Receipt paper present.
Receipt paper exhausted.
3 Off
On
```
##### 00

##### 08

##### 0

##### 8

```
Receipt paper present
Receipt paper exhausted
4 Off 00 0 Not used. Fixed to off.
5 Off
On
```
##### 00

##### 20

##### 0

##### 32

```
Slip leading edge sensor: paper present
Slip leading edge sensor: no paper
6 Off
On
```
##### 00

##### 40

##### 0

##### 64

```
Slip trailing edge sensor: paper preset
Slip trailing edge sensor: no paper.
7 Off 00 0 Not used. Fixed to off.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 186
```
```
Fourth Byte (Paper Sensor Information)
Bit Off/On Hex Decimal Status for ASB
0 Off
On
```
##### 00

##### 01

##### 0

##### 1

```
Slip paper selected
Receipt paper selected
1 Off
On
```
##### 00

##### 02

##### 0

##### 2

```
Possible to print in slip
Not possible to print on slip because
no form has been inserted
2 - - - Undefined
3 - - - Undefined
4 Off 00 0 Not used. Fixed to off.
5 - - - Undefined
6 - - - Undefined
7 Off 00 0 Not used. Fixed to off.
```

7167 Owner’s Manual Chapter 6: Commands

187 November 2003

Bar Code Commands

```
These following describes the commands for the printing of bar codes and described in
the order of their hexadecimal codes.
Note: 7156 firmware can be set for module widths in bar codes ranging from 2
dots to 4 dots per module (DPM) for the narrow modules. The default is 3 DPM.
7167 firmware ranges from 1 dot per module to 5 dots per module (DPM) printed
on the receipt. The default is 2 DPM.
```
```
Select Printing Position for HRI Characters
ASCII : GS H n
```
```
Hexadecimal : 1D 48 n
```
```
Decimal: 29 72 n
```
```
Value of n : Printing position
```
```
0 = Not printed
```
```
1 = Above the bar code
```
```
2 = Below the bar code
```
```
3 = Both above and below the bar code
```
```
Default:
0 (Not printed)
```
```
Prints HRI (Human Readable Interface) characters above or below the bar code.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H48) & Chr$(n)
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 188
```
```
Select Pitch for HRI Characters
ASCII : GS f n
```
```
Hexadecimal : 1D 66 n
```
```
Decimal: 29 102 n
```
```
Value of n : Pitch
```
```
0 = Standard Pitch at 15.2 CPI on receipt
```
```
1 = Compressed Pitch at 19 CPI on receipt
```
```
Default: 0 (Standard Pitch at 15.2 CPI)
```
```
Selects standard or compressed font for printing Bar Code characters.
When slip is selected as the interface, HRI is always compressed.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H66) & Chr$(n)
```
```
Select Bar Code Height
ASCII : GS h n
```
```
Hexadecimal : 1D 68 n
```
```
Decimal: 29 104 n
```
```
Value of n : Number of dots
```
```
Range of n : 1 - 255
```
```
Default: 162
```
```
Sets the bar code height to n dots or n /8 mm ( n /203 inch) for receipt or
n /8.5 mm ( n /216 inch) for slip.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H68) & Chr$(n)
```

7167 Owner’s Manual Chapter 6: Commands

189 November 2003

Print Bar Code
First Variation Second Variation

```
ASCII : GS k m d1...dk NUL or GS k m n d1...dn
```
```
Hexadecimal : 1D 6B m d1...dk 00 or 1D 6B m n d1...dn
```
```
Decimal: 29 107 m d1...dk 0 or 29 107 m n d1...dn
```
```
0 = End of command.
```
```
Values:
```
```
First Variation: String terminated with NUL Character
```
```
m = 0 – 6, 10
```
```
d = 32 - 126 (see the table)
```
```
n = 1 - 255 (see the table)
```
```
Selects the bar code type and prints a bar code for the ASCII characters entered. If the
width of the bar code exceeds one line, the barcode is not printed.
There are two variations to this command. The first variation uses a NUL character to
terminate the string; the second uses a length byte at the beginning of the string to
compensate for the Code 128 bar code, which can accept a NUL character as part of the
data. With the second variation the length of byte is specified at the beginning of the
string.
Fixed-length codes can be aligned left, center, or right using the Align Positions command
(1B 61). Variable-length codes are always center aligned in 7156 Emulation. This function
is applicable to the receipt station only. Barcodes on the slip station are always right
justified.
The check digit is calculated for UPC and JAN (EAN) codes if it is not sent from the host
computer. Six-character zero-suppressed UPC-E tags are generated from full 11 or 12
characters sent from the host computer according to standard UPC-E rules. Start/Stop
characters are added for Code 39 if they are not included.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 190
```
```
m Bar Code D n, Length
```
```
0 UPC-A 48- 57 (ASCII numerals) Fixed Length: 11, 12
1 UPC-E 48- 57 Fixed Length: 11, 12
2 JAN13 (EAN13) 48- 57 Fixed Length: 12, 13
3 JAN8 (EAN8) 48- 57 Fixed Length: 7, 8
4 Code 39 48- 57,
65- 90 (ASCII alphabet),
32, 36, 37, 43, 45, 46, 47
(ASCII special characters)
d1 = dk = 42 (start/stop
code is supplied by
printer if necessary)
```
```
Variable Length
```
```
5 Interleaved 2 of 5
(ITF)
```
```
48- 57 Variable Length
(Even Number)
6 CODABAR
(NW-7)
```
```
65- 68, start code
48- 57, 36, 43, 45, 46, 47, 58
```
```
Variable Length
```
##### 10 PDF 417

```
(7158 Native Mode
and 7167 Native
Mode)
```
```
1-255 Variable Length
7158 Native Mode
and 7167 Native
Mode
```
```
Second Variation: Length of Byte Specified at Beginning of String
m = 65 - 73, 75 (see the table)
```
```
d =
0 - 127 (see the table)
```
```
n = 1 - 255 (see the table)
```
```
The value of m selects the bar code system as described in the table. When data is present
in the print buffer, the printer processes the data following m as normal data.
The variable d indicates the character code to be encoded into the specified bar code
system. See the table. If character code d cannot be encoded, the printer prints the bar code
data processed so far, and the following data is treated as normal data.
```

7167 Owner’s Manual Chapter 6: Commands

191 November 2003

```
m Bar Code D n, Length
65 UPC-A 48- 57 (ASCII numerals) Fixed Length: 11, 12
66 UPC-E 48- 57 Fixed Length: 11, 12
67 JAN13 (EAN13) 48- 57 Fixed Length: 12, 13
68 JAN8 (EAN8) 48- 57 Fixed Length: 7, 8
69 CODE 39 48- 57, 65- 90 (ASCII
alphabet),
32, 36, 37, 43, 45, 46, 47
(ASCII special characters)
d1 = dn = 42 (start/stop
code is supplied by
printer if necessary)
```
```
Variable
```
```
70 Interleaved 2 of 5
(ITF)
```
```
48- 57 Variable
(Even Number)
71 CODABAR
(NW-7)
```
```
65- 68, start code 48- 57,
36, 43, 45, 46, 47, 58
```
```
Variable
```
```
72 Code 93 0 - 127 Variable
(7158 Native Mode
and 7167 Native
Mode only)
73 Code 128 0-105
d1 = 103-105 (must be a
Start code)
d2 = 0-102 (data bytes)
(Stop code is provided by
the printer)
```
```
Variable
```
```
75 PDF417 0 – 255 Variable Length
(7158 Native Mode
only and 7167
Native Mode)
```
```
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H6B) & Chr$(m) & "123456789012" & Chr$(0)
```
```
The above command will print the number above or below the bar code, depending on
which parameter for m that specify.
Exceptions:
Illegal data cancels this command.
The command is valid only at the beginning of a line.
PDF 417 format cannot be printed on the slip.
Barcodes on the Slip are always right justified.
PDF417 and Code 93 are only available in 7158 Native Mode and 7167 Native Mode.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 192
```
```
Select Bar Code Width
ASCII : GS w n
```
```
Hexadecimal : 1D 77 n
```
```
Decimal: 29 119 n
```
```
Value of n : 1, 2, 3, 4, 5
```
```
Default: 3 for receipt; 2 for slip
```
```
Sets the bar code width to n dots.
Formulas:
n + 1 /8 mm ( n + 1 /203 inch) for receipt, n + 1/5.7 mm (n + 1/144 inch) for slip.
Slip module sizing: n must be even (it is rounded up if odd) and the size of modules is n +
1/5.7 mm (n + 1/144 inch).
```
```
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H77) & Chr$(n)
```

7167 Owner’s Manual Chapter 6: Commands

193 November 2003

#### Page Mode Commands

```
Page Mode is one of two modes, which the 7167 printer uses to operate. Standard Mode is
typical of how most printers operate by printing data as it is received and feeding paper as
the various paper feed commands are received. Page Mode is different in that it processes
or prepares the data as a “page” in memory before it prints it. Think of this as a virtual
page. The page can be any area within certain parameters that you define. Once the printer
receives the (0x0C) command, it prints the page and returns the printer to Standard Mode.
The Select Page Mode command (1B 4C) puts the printer into Page Mode. Any commands
that are received are interpreted as Page Mode commands. Several commands react
differently when in Standard Mode and Page Mode. The descriptions of these individual
commands in this chapter indicate the differences in how they operate in the two modes.
Limitations
Page mode is only implemented on the receipt station in 7158 Native Mode and 7167
Native Mode only.
```
```
Print and Return to Standard Mode
ASCII: FF
```
```
Hexadecimal: 0C
```
```
Decimal: 12
```
```
The processed data is printed and the printer returns to Standard Mode. The developed
data is deleted after being printed. This command has the same code as the Print and Eject
Slip command, which is executed when the printer is not in Page Mode.
```
```
Example:
MSComm1.Output = Chr$(&H0C)
Exceptions:
This command is enabled only in Page Mode.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 194
```
```
Cancel Print Data in Page Mode
ASCII: CAN
```
```
Hexadecimal: 18
```
```
Decimal: 24
```
```
Deletes all the data to be printed in the “page” area. Any data from the previously selected
“page” area that is also part of the current data to be printed is deleted.
This command has the same code as the Open Form command, which is performed when
the printer is not in Page Mode.
```
```
Example:
MSComm1.Output = Chr$(&H18)
Exceptions:
This command is only used in Page Mode.
```
```
Print Data in Page Mode
ASCII: ESC FF
```
```
Hexadecimal: 1B 0C
```
```
Decimal: 27 12
```
```
Collectively prints all buffered data in the printing area.
After printing, the printer does not clear the buffered data and sets values for Select Print
Direction in Page Mode (1B 54 n) and Set Print Area in Page Mode (1B 57...), and sets the
position for buffering character data.
```
```
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H0C)
Exceptions:
This command enabled only in Page Mode.
```

7167 Owner’s Manual Chapter 6: Commands

195 November 2003

```
Select Page Mode
ASCII: ESC L
```
```
Hexadecimal: 1B 4C
```
```
Decimal: 27 76
```
```
Switches from Standard Mode to Page Mode. After printing has been completed either by
the Print and Return to Standard Mode (FF) command or Select Standard Mode (1B 53) the
printer returns to Standard Mode. The developed data is deleted after being printed.
This command sets the position where data is buffered to the position specified by Select
Print Direction in Page Mode (1B 54) within the printing area defined by Set Print Area in
Page Mode (1B 57).
This command switches the settings for the following commands (which values can be set
independently in Standard Mode and Page Mode) to those for Page Mode.
```
1. Set Right-Side Character Spacing (1B 20)
2. Select 1/6-Inch Line Spacing (1B 32)
3. Set Line Spacing (1B 33)
4. It is possible only to set values for the following commands in Page Mode. These
    commands are not executed.
5. Select or Cancel 90 Degree Clockwise Rotation (1B 56)
6. Select Justification (1B 61)
7. Select or Cancel Upside Down Printing (1B 7B).
8. Set Left Margin (1D 4C)
9. Set Print Area Width (1D 57)

```
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H4C)
Exceptions:
The command is enabled only when input at the beginning of a line.
The command is available only when the receipt is selected by Select Paper
(1B 63 30).
The command has no effect if Page Mode has previously been selected.
The Select Paper (1B 63 30) command can not be used in Page Mode.
In 7156 Emulation Mode, (1B 4C...) is used for double density graphics.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 196
```
```
Select Standard Mode
ASCII: ESC S
```
```
Hexadecimal: 1B 53
```
```
Decimal: 27 83
```
```
Switches from Page Mode to Standard Mode. In switching from Page Mode to Standard
Mode, data buffered in Page Mode is cleared, the printing area set by Set Print Area in
Page Mode (1B 57) is initialized and the print position is set to the beginning of the line.
This command switches the settings for the following commands (the values for these
commands can be set independently in Standard Mode and Page Mode) to those for
Standard Mode:
```
1. Set Right-Side Character Spacing (1B 20)
2. Select 1/6 Inch Line Spacing (1B 32)
3. Set Line Spacing (1B 33)
Standard Mode is automatically selected when power is turned on, the printer is reset, or
the Initialize Printer command (1B 40) is used.

```
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H53)
Exceptions:
This command is effective only in Page Mode.
```

7167 Owner’s Manual Chapter 6: Commands

197 November 2003

```
Select Print Direction in Page Mode
ASCII : ESC T n
```
```
Hexadecimal : 1B 54 n
```
```
Decimal: 27 84 n
```
```
Value of n : Start position
```
```
0 Upper left corner proceeding across page to the right (A)
```
```
1 Lower left corner proceeding up the page (B)
```
```
2 Lower right corner proceeding across page to the left (upside
down) (C)
```
```
3 Upper right corner proceeding down page (D)
```
```
A, B, C and D note the direction of of print. See illustration.
```
```
Selects the printing direction and start position in Page Mode. See the illustration.
The command can be sent multiple times so that several different print areas, aligned in
different print directions, can be developed in the printer’s page buffer before being
printed by the Eject Slip command (0C).
```
```
A
```
```
D
```
```
B
```
```
Default: 0 (Upper left corner proceeding across page to the right)
```
```
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H54) & Chr$(n)
Exceptions:
This command is valid only in Page Mode.
This command is ignored if the value of n is out of the specified range.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 198
```
```
Set Printing Area in Page Mode
ASCII: ESC W n1, n2 ...n8 .]
```
```
Hexadecimal: 1B 57 n1, n2 ...n8]
```
```
Decimal: 27 87 n1,n2 ...n8]^
```
```
Range: 0 - 255
```
```
Default: n1 - 4 =^0^
```
```
n5 =^64^
```
```
n6 =^2^
```
```
n7 =^64^
```
```
n8 =^2^
```
```
Sets the position and size of the printing area in Page Mode.
The command can be sent multiple times so that several different print areas, aligned in
different print directions, can be developed in the printer’s page buffer before being
printed by the Eject Slip command (0C).
Defaults equal an origin of 0,0 and a size of 576x576. This command is allowed in any
mode.
Formulas:
The starting position of the print area is the upper left of the area to be printed (x0, y0).
The length of the area to be printed in the y direction is set to dy inches. The length of the
area to be printed in the x direction is set to dx inches. Use the equations to determine the
Value of x0, y0, dx, and dy.
See the illustration for a graphic representation of the printing area. For more information
about the fundamental calculation pitch, see the Set Fundamental Calculation Pitch
command (1D 50).
```
1. x0 = [( _n_ 1 + _n_ 2 x 256) x (horizontal direction of the fundamental calculation pitch)]
2. y0 = [( _n_ 3 + _n_ 4 x 256) x (vertical direction of the fundamental calculation pitch)]
3. dx = [( _n_ 5 + _n_ 6 x 256) x (horizontal direction of the fundamental calculation pitch)]
4. dy = [( _n_ 7 + _n_ 8 x 256) x (vertical direction of the fundamental calculation pitch)]
5. Keep the following notes in mind for this command.
6. The fundamental calculation pitch depends on the vertical or horizontal direction.
7. The maximum printable area in the x direction is 576/203 inches.
8. The maximum printable area in the y direction is 2000/203 inches.


7167 Owner’s Manual Chapter 6: Commands

199 November 2003

```
First the printer must be set to page mode, then the following command should be sent.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H57) & Chr$(&H40) & Chr$(&H0) & Chr$(&H40) &
Chr$(&H0) & Chr$(&H40) & Chr$(&H1) & Chr$(&H40) & Chr$(&H1)
Exception:
This command is effective only in Page Mode.
```
```
Set Absolute Vertical Print Position in Page Mode
ASCII : GS $ nL nH
```
```
Hexadecimal : 1D 24 nL nH
```
```
Decimal: 29 36 nL nH
```
```
Formulas:
```
```
[( nL + nH X 256) x (vertical or horizontal motion unit)] inches.
Sets the absolute vertical print starting position for buffer character data in
Page Mode.
The vertical or horizontal motion unit for the paper roll is used and the horizontal starting
buffer position does not move.
The reference starting position is set by Select Print Direction in Page Mode
(1B 54). This sets the absolute position in the vertical direction when the starting position
is set to the upper left or lower right; and sets the absolute position in the horizontal
direction when the starting position is set to the upper right or lower left. The horizontal
and vertical motion unit are specified by the Set Horizontal and Vertical Minimum Motion
Units (1D 50) command.
The Set Horizontal and Vertical Minimum Motion Units (1D 50) command can be used to
change the horizontal and vertical motion unit. However, the value cannot be less than the
minimum horizontal movement amount, and it must be in even units of the minimum
horizontal movement amount.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H24) & Chr$(nL) & Chr$(nH)
Exceptions:
This command is effective only in Page Mode. If the [( nL + nH x 256) x (vertical or
horizontal motion unit)] exceeds the specified printing area, this command is ignored.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 200
```
```
Set Relative Vertical Print Position in Page Mode
ASCII : GS \ nL nH
```
```
Hexadecimal : 1D 5C nL nH
```
```
Decimal: 29 92 nL nH
```
```
Sets the relative vertical print starting position from the current position. This command
can also change the horizontal and vertical motion unit. The unit of horizontal and vertical
motion is specified by this command.
This command functions as follows, depending on the print starting position set by Select
Print Direction in Page Mode (1B 54):
When the starting position is set to the upper left or lower left of the printing area, the vertical motion
unit (y) is used.
When the starting position is set to the upper right or lower left of the printing area, the horizontal
motion unit (x) is used.
Value:
The value for the horizontal and vertical movement cannot be less than the minimum
horizontal movement amount, and must be in even units of the minimum horizontal
movement amount.
Formulas:
The distance from the current position is set to [( nL + nH x 256) x vertical or horizontal
motion unit] inches. The amount of movement is calculated only for the receipt.
When pitch n is specified to the movement downward:
nL + nH x 256 = n
When pitch n is specified to the movement upward (the negative direction), use the
complement of 65536.
When pitch n is specified to the movement upward:
nL + nH x 256 – 65536 – N
Exceptions:
This command is used only in Page Mode, otherwise it is ignored.
Any setting that exceeds the specified printing area is ignored.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H5C) & Chr$(nL) & Chr$(nH)
```

7167 Owner’s Manual Chapter 6: Commands

201 November 2003

#### Macro Commands

```
These commands are used to select and perform a user-defined sequence of printer
operations.
```
```
Start or End Macro Definition
ASCII: GS :
```
```
Hexadecimal: 1D 3A
```
```
Decimal: 29 58
```
```
Starts or ends macro definition. Macro definition begins when this command is received
during normal operation and ends when this command is received during macro
definition. The macro definition is cleared, during definition of the macro, when the
Execute Macro (1D 5E) command is received.
Normal printing occurs while the macro is defined. When the power is turned on the
macro is not defined.
The defined contents of the macro are not cleared by the Initialize Printer (1B 40), thus,
the Initialize Printer (1B 40) command may be used as part of the macro definition.
If the printer receives a second Select or Cancel Macro Definition (1D 3A) command
immediately after previously receiving a Select or Cancel Macro Definition (1D 3A) the
printer remains in the macro undefined state.
Formulas:
The contents of the macro can be defined up to 2048 bytes.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H3A)
Exceptions:
If the macro definition exceeds 2048 bytes, excess data is not stored.
This command is available in 7158 Native Mode and 7167 Native Mode only.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 202
```
```
Execute Macro
ASCII : GS ^ r t m
```
```
Hexadecimal : 1D 5E r t m
```
```
Decimal: 29 94 r t m
```
```
Value of r : The number of times to execute the macro.
```
```
Value of t : The waiting time for executing the macro.
```
```
Value of m : Macro executing mode
```
```
0 (Bit0): The Macro executes r times continuously
with waiting time specified by t.
```
```
1 (Bit0): The printer waits for feed button to be
pressed after waiting for the period
specified by t. If the button is pressed,
the printer executes the macro once. The
printer repeats the operation r times.
```
```
Executes a macro. After waiting for a specified period the LED indicators blink and the
printer waits for the Paper Feed Button to be pressed. After the button is pressed, the
printer executes the macro once. The printer repeats this operation the number of specified
times.
When the macro is executed by pressing the Paper Feed Button ( m = 1), paper cannot be
fed by using the Paper Feed Button.
Formulas:
The waiting time is t x 100 msec for every macro execution.
m specifies macro executing mode when the LSB (Least significant bit) m = 0
The macro executes r times continuously at the interval specified by t when the LSB (Least
significant bit) of m = 1.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H5E) & Chr$(r) & Chr$(t) & Chr$(m)
Exceptions:
If this command is received while a macro is being defined, the macro definition is aborted
and the definition is cleared.
If the macro is not defined or if r is 0, nothing is executed.
This command is available in 7158 Native Mode and 7167 Native Mode only.
```

7167 Owner’s Manual Chapter 6: Commands

203 November 2003

#### MICR Commands

```
MICR Reading
These commands control the Magnetic Ink Character Recognition (MICR) check reader,
including how it parses the character strings on checks.
The section, MICR Parsing, describes how to create a parsing format and how to create
and maintain an Exceptions table.
```
```
Read MICR Data and Transmit
ASCII : ESC w 1
```
```
Hexadecimal : 1B 77 01
```
```
Decimal: 27 119 1
```
```
Default: All data returned
```
```
Reads and transmits the MICR data and adds a Carriage Return (0x0D). If no parsing
format is selected with either of the Define Parsing Format commands (see below), all data
will be returned, which is the default.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H77) & Chr$(&H01)
```
```
Reread MICR Data
ASCII : ESC w R
```
```
Hexadecimal : 1B 77 52
```
```
Decimal: 27 119 82
```
```
Resends the previously decoded MICR data to the host.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H77) & Chr$(&H52)
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 204
```
#### MICR Parsing

```
This section describes MICR parsing in detail and includes several examples of useful
parsing variations. It also describes how to create a parsing format and how to create and
maintain an exception table.
```
```
Define Parsing Format, Save in NVRAM
ASCII : ESC w P d1 d2 ... dn CR
```
```
Hexadecimal : 1B 77 50 d1 d2 ... dn 0D
```
```
Decimal: 27 119 80 d1 d2 ... dn 13^
```
```
Defines and saves parsing format. See Parsing Parameter String Options in this document.
Send with this command the parse data that is to be the default parse string at printer
power-up. If no parameters are selected, parsing is not performed.
d1 through dn are the parse string. The string must be CR terminated. If the string has
invalid characters in it or is too long, the printer will store a null string, and raw MICR
data will be returned.
See sample parsing examples
```
```
Define Parsing Format, Do Not Save Permanently
ASCII : ESC w p d1 d2 ... dn CR
```
```
Hexadecimal : 1B 77 70 d1 d2 ... dn CR
```
```
Decimal: 27 119 112 d1 d2 ... dn CR
```
```
Defines, but does not save parsing format. See Parsing Parameter String Options in this
document. Send this command as often as desired to change the previous parse format
string. The data sent with 1B 77 50 will be restored at power-up.
d1 through dn are the parse string. The string must be CR terminated. If the string has
invalid characters in it or is too long, the printer will store a null string, and raw MICR
data will be returned.
See examples of parsing
Exceptions:
If no parameters are selected, parsing is not performed.
```

7167 Owner’s Manual Chapter 6: Commands

205 November 2003

```
Parsing Parameter String Options
Variable Length Fields
Variable Length Field Name Selector Comments
Transit Number T Full 9 digit routing/transit number
Bank Number B Digits 4-8 of transit number
Check Digit D Digit 9 of transit number
Account Number A
Check Serial Number C Separate from account number
Amount $ This field may not be present or
readable
```
```
Variable Length Field Optional
Modifiers
Selector
Comments
Zero fill to length 0 ASCII zero preceding maximum
length
Maximum length nn 1- or 2-digit ASCII number
Remove space/dash X
Replace space/dash with 0 x
```
```
Examples of Variable Length Field Format Specifications
Account #, all characters in the field, keep spaces and dashes A
Account #, all characters in the field, replace spaces and dashes xA
Account #, maximum 12 characters, keep spaces and dashes 12A
Account #, always 12 characters zero filled, remove spaces and
dashes
```
##### 012XA

```
Other Parameters
Error Number E One Digit Returned
```
(^0)
1
Read OK
Read error: bad character, empty field
invalid length, check digit invalid
Status S Two Digits Returned
(^00)
01
09
08
05
07
04
10
11
No error
No MICR data
Mexican check
Canadian check
Error in transit number
Error in account number
Error in check serial number
Business or commercial check
Amount field present


7167 Owner’s Manual Chapter 6: Commands

```
November 2003 206
```
```
Field Separator 'x
```
(^) Field separator preceded by a single quote, so a field
separator of the letter A would be sent as 'A (0x27 0x41).
If a Carriage Return is specified as a separator (0x27
0x0D), a final Carriage Return must still terminate the
parsing parameter string.
Country Code Un One Digit Returned
(^) N returned if US check
(^) Nothing returned if not US check
Country Code Km One Digit Returned
(^) M returned if Canadian check
(^) Nothing returned if not Canadian check
Check Type L One Digit Returned
(^) 1 Personal check
(^2) Business or commercial check
Ten parameters are more than enough to specify all variable length fields with a field
separator each and other status information that may be helpful to an application. More
than 10 parameters are not recommended because they use up space in non-volatile
memory (NVRAM) available for the exception table.
The parsing parameter string is stored packed in NVRAM starting at word 10, with the
total byte length stored in the high order byte of word 10. While most parameters take two
bytes of NVRAM, the following parameters take only one byte: B, D, E, S, L. None of the
parsing examples in the following section take more than 14 bytes (seven words) of
NVRAM.
The exception table starts at word 20. If the parsing parameter string extends into word 20,
then the first exception table entry is unavailable.


7167 Owner’s Manual Chapter 6: Commands

207 November 2003

```
Sample Parsing Formats
The following strings show various sample formats that you can use assuming they meet
your parsing format needs. Included with the sample format is a description of the data
that is returned to the application.
```
```
ESC w p 18 A <CR>
Maximum 18 characters in the account number
Final Carriage Return
```
```
ESC w p 18 X A <CR>
Maximum 18 characters in the account number with spaces and dashes removed
Final Carriage Return
```
```
ESC w p 18 x A <CR>
Maximum 18 characters in the account number with spaces and dashes replaced with 0
Final Carriage Return
```
```
ESC w p 018 A <CR>
Always 18 characters in the account number (high order zero-filled if necessary)
Final Carriage Return
```
```
ESC w p 018 X A <CR>
Always 18 characters in the account number with spaces and dashes removed
Final Carriage Return
```
```
ESC w p 018 x A <CR>
Always 18 characters in the account number with spaces and dashes replaced with 0
Final Carriage Return
```
```
ESC w p T 18 X A 04C <CR>
All characters in the transit number
All characters in the account number (up to 18) with spaces and dashes removed
Always four characters in the check number (zero-filled if check number is only three characters
long)
Final Carriage Return
```
```
ESC w p K9 X T 18 X A 04C <CR>
Canadian check: dash in transit number removed; “9” inserted at beginning, resulting in a fully
numeric nine character transit number
All nine characters in the transit number (because there are no dashes)
All characters in the account number (up to 18) with spaces and dashes removed
Always four characters in the check number (zero-filled if check number is only three characters
long)
Final Carriage Return
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 208
```
```
ESC w p T '/ A '/ C '/ S <CR>
All characters in the transit number
Field separator: /
All characters in the account number
Field separator: /
All characters in the check number
Field separator: /
Two-digit status
Final Carriage Return
```
```
Notes
All parameters are ASCII characters, i.e. greater than or equal to 0x20, with the exception
of a non-ASCII character enclosed in single quotes as a field separator. This applies both
to parameter specifications sent from application to printer, and to MICR data returned
from printer to application.
Parameters are positional; their order in the parameter string is the order in which the
parsed MICR data will be returned. Unrecognized parameters will be ignored, and
processing of the parsing parameters will stop. Any data remaining after the unrecognized
parameter will be treated as normal input data.
If parameters are not defined (for example, 1B 77 50 <CR> or 1B 77 70 <CR>) parsing is
not selected. One status byte followed by all decoded MICR characters will be returned.
This is the default parsing format if no other is selected:
Status Status Byte Value
Good read, data follows
Bad read, data follows
No check present, no data
Paper jam, no data
No MICR characters, no
data
```
```
0x00
0x01
0x02
0x03
0x04
```
```
MICR Characters ASCII Hexadecimal
Numerics
Unrecognized Character
Space
Amount symbol
Dash symbol
“on us” symbol
Transit symbol
```
##### 0...9

##### ?

##### &

##### '

##### (

##### )

```
0x30...0x39
0x3F
0x20
0x26
0x27
0x28
0x29
```

7167 Owner’s Manual Chapter 6: Commands

209 November 2003

```
Once a parsing format is specified, the following values are returned:
MICR Characters ASCII Hexadecimal
Numerics
Space
Dash
Field separator*
Country code*
```
##### 0...9

##### -

```
0x30...0x39
0x20
0x2D
```
```
*As specified in the parsing parameter string
```
```
Check Serial Number
Parsing the Check Serial Number
Most banks print the check serial number in three easily recognizable spots. The printer
firmware will look for the number in these spots, using the following ordered algorithm.
The examples use letters to represent symbols on the check:
```
```
t o $ - c x
Transit symbol
“on us” symbol
```
```
Amount symbol
Dash
Check serial number
```
```
Any other number
```
```
A number bracketed by “on us” symbols in the auxiliary “on us” field is the check serial
number.
occcccco txxxxxxxxxt xxxxxxxxo
Otherwise, a three or more digit number to the right of the rightmost “on us” symbol, and
to the left of the leftmost amount symbol if an amount field is present, is the check serial
number.
txxxxxxxxxt xxxxxxxxo cccc
txxxxxxxxxt xxxxxxxxo cccc $xxxxxx$
If both of these searches fail to produce the check serial number, extract the whole account
number field from between the rightmost transit symbol and the rightmost “on us”
symbol. A three, four, or five-digit number to the right of the rightmost transit symbol,
separated by a space or a dash from the rest of the account number is the check serial
number.
txxxxxxxxxt cccc xxxxxxxxo
txxxxxxxxxt cccc-xxxxxxxxo
txxxxxxxxxt cccc xxxxxxxxo xx
If all of these searches fail to produce the distinct check serial number, and the check serial
number field has been specified in the parsing parameter string options, no check serial
number will be returned. If it is imbedded within the account number field, it will be
returned as part of that variable length field.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 210
```
```
Exceptions
Some banks print the check serial number in a location that cannot be electronically
distinguished without specific exception information, although it can be visually
distinguished because it is repeated in the upper right corner of the check. For these cases,
the printer can hold up to nine exceptions for specific banks in its non-volatile memory
(NVRAM), which is accessed by the read and write NVRAM commands. The specific bank
is picked out by its transit number, and the firmware will look in the exception table for a
transit number match before looking in the normal check serial number locations.
In this example, without an exception table entry, the firmware would always pick the
rightmost four-digit number as the check serial number following rule two above. The
bank with the three digit check serial number and the four digit extension after the “on
us” symbol would need to be exceptionally recognized:
txxxxxxxxxt ccc-xxxxxxxxxxoxxxx
txxxxxxxxxt xxx-xxxxxxxxxxocccc
In this example, without an exception table entry, the firmware would not be able to pick
out the check serial number because it is not separated from the rest of the account
number:
txxxxxxxxxt ccccxxxxxxxxxxo
In this example, without an exception table entry, the firmware would not be able to pick
out the check serial number correctly, because it is imbedded within the rest of the account
number:
txxxxxxxxxt xxx-ccc-xxxxxxxxxxo
```
```
Loading the Exception Table
The exception table begins at word 20 in NVRAM. Each entry takes five words. There is
room for eight exceptions with a sumcheck written in the last word. An application can
load local exceptions into the printer using the write NVRAM command:
```
```
0x1B 0x73 n1 n2 k
```
```
which writes the two byte word n1:n2 to word k in NVRAM.
```
```
Exception Table Entry Format
Each exception table entry consists of five words. The first two words contain the first
eight characters of the transit number by packing the low order nibble of the numeric
transit number characters. For Canadian checks, eliminate the dash and store the eight
numerics.
The next three words are used as six individual bytes to tell the firmware how to interpret
the MICR characters that fall to the right of the rightmost transit symbol. Each of the six
bytes is positional and consists of two parts: character type and number.
The three high order bits of each byte mark the character type. The characters can be
marked in three ways: check serial # character, account # character, or “skip this character
or symbol.”
The five low order bits of each byte contain the number of characters of that type to
extract. Most exceptions will not need to use all six bytes; in that case clear the unused
bytes to zero.
```

7167 Owner’s Manual Chapter 6: Commands

211 November 2003

```
Bits within Byte 7 6 5 4 3 2 1 0
```
```
check serial # character string 0 0 1 n n n n n
account # character string 0 1 0 n n n n n
character string to ignore 1 0 0 n n n n n
Example 1
t123456780t12349876543210o 1234 is the check serial #
9876543210 is the account #
To load the second table entry, which starts at word 25, the transit number 123456780
would be stored in the first two words of its table entry using this string of commands:
0x1B 0x73 0x12 0x34 25
0x1B 0x73 0x56 0x78 26
After the right transit symbol are immediately the four characters of the check serial #,
followed immediately by the ten characters of the account number. These would be
bitwise encoded as:
0 0 1 0 0 1 0 0 (check #, four characters)
and 0 1 0 0 1 0 1 0 (account #, 10 characters)
then stored in the other three words of the table entry using:
0x1B 0x73 0x24 0x4A 27
0x1B 0x73 0x00 0x00 28
0x1B 0x73 0x00 0x00 29
Example 2
t22137-632t001 6042202o927540 2754 is the check serial #
6042202 is the account #
To load the third table entry, which starts at word 30, the transit number 2137-632 would
be stored in the first two words of its table entry using this string of commands:
0x1B 0x73 0x22 0x13 30
0x1B 0x73 0x76 0x32 31
After the right transit symbol are four characters to skip, a seven digit account number,
two characters to skip, and finally a four digit check serial #. The final character to skip
need not be encoded. These would be bitwise encoded as:
1 0 0 0 0 1 0 0 (skip four characters)
0 1 0 0 0 1 1 1 (account #, seven characters)
1 0 0 0 0 0 1 0 (skip two characters)
0 0 1 0 0 1 0 0 (check #, four characters)
then stored in the other three words of the table entry using:
0x1B 0x73 0x84 0x47 32
0x1B 0x73 0x82 0x24 33
0x1B 0x73 0x00 0x00 34.
```
```
Maintaining the Exception Table
Present contents of the exception table can be examined using the read NVRAM
command:
0x1B 0x6A k
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 212
```
```
which reads and returns word k in NVRAM. When the exception table is full, a new entry
can replace an older, less frequently used entry, by merely rewriting the words for that
table entry.
```
#### Check Flip Command

```
Check Flip Command
ASCII : ESC w F
```
```
Hexadecimal : 1B 77 46
```
```
Decimal: 27 119 70^
```
```
Causes a check on the slip table to be fed into the printer, flipped and left with the trailing
edge of the check in the slip feed rollers. Prior to the flip, the check is measured to see that
it is of an appropriate size (see Appendix B) to be flipped. If not, the check is fed back to
the user.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H77) & Chr$(&H46)
Exception:
This command is available only in 7158 Native Mode and 7167 Native Mode.
```
#### User Data Storage Commands.........................................................................................

```
Write to User Data Storage
ASCII: ESC ‘ m a0 a1 a2 d1 ... dm
```
```
Hexadecimal: 1B 27 m a0 a1 a2 d1 ... dm
```
```
Decimal: 27 39 m a0 a1 a2 d1 ... dm
```
```
Value of m: 0 – 255
```
```
Writes m bytes of data to the User Data Storage Flash Page at the address specified. The
printer waits for m bytes of data following the 3-byte address, addr.
If any of the memory locations addressed by this command are not currently erased, the
command is not executed.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H27) & Chr$(&H5) & Chr$(&H0) & Chr$(&H0) &
Chr$(&H0) & "Hello"
The above command writes the word ‘Hello’ to the User Data Storage Flash Page.
```

7167 Owner’s Manual Chapter 6: Commands

213 November 2003

```
Read from User Data Storage
ASCII: ESC 4 m a0 a1 a2
```
```
Hexadecimal: 1B 34 m a0 a1 a2
```
```
Decimal: 27 52 m a0 a1 a2
```
```
Value of m : 0 – 255
```
```
Reads m bytes of data from the User Data Storage Flash Page at the address specified.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H34) & Chr$(&H5) & Chr$(&H0) & Chr$(&H0) &
Chr$(&H0)
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 214
```
```
Read from Non-Volatile Memory
ASCII : ESC j k
```
```
Hexadecimal
:
```
```
1B 6A k
```
```
Decimal: 27 106 k
```
```
Range of k : 20 – 63 (decimal)
```
```
Reads a two-byte word from location k in the history EEROM. The printer returns the
word at the next available opportunity.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H6A) & Chr$(k)
```
```
Write to Non-Volatile Memory (NVRAM)
ASCII : ESC s n 1 n 2 k
```
```
Hexadecimal : 1B 73 n 1 n 2 k
```
```
Decimal: 27 115 n 1 n 2 k
```
```
Value of n1 : 1 st Byte
```
```
Value of n2 : 2 nd Byte
```
```
Range of k : 20 - 63 (decimal)
```
```
Writes the two-byte word, n 1 n 2, to location k in history EEROM.
Example:
MSComm1.Output = Chr$(&H1B) & Chr$(&H73) & Chr$(n1) & Chr$(&Hn2k)
```

7167 Owner’s Manual Chapter 6: Commands

215 November 2003

```
Select Memory Type (SRAM/Flash) Where to Save Logos or User-Defined
Fonts
ASCII : GS " n
```
```
Hexadecimal : 1D 22 n
```
```
Decimal: 29 34 n
```
```
Value of n : 48 - 51
```
```
Specifies whether to load the logos or user-defined characters to Flash Memory or to RAM
(volatile memory). The selection remains in effect until it is changed via this command or
until the power cycles.
n = 48 (ASCII n = 0)
Loads active logo to RAM only. This is used to print a special logo but not have it take up
Flash Memory. A logo defined following this command is not preserved over a power
cycle.
n = 49 (ASCII n = 1)
Loads active logo to Flash Memory. This is the default condition for logo Flash storage. A
logo defined following this command is stored in Flash Memory.
n = 50 (ASCII n = 2)
Loads user-defined characters to RAM only. This is the default condition for user-defined
character storage. Any user-defined characters defined following this command are not
preserved over a power cycle.
n = 51 (ASCII n = 3)Loads user-defined characters to Flash Memory. An application must
use this command to store user-defined characters in Flash Memory. Any user-defined
characters defined following this command are stored in Flash Memory. A user-defined
character cannot be redefined in Flash Memory. The Flash Memory page must be erased
by an application before redefining user-defined characters. For more information, see the
Erase User Flash Sector (1D 40 n ) command.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H22) & Chr$(n)
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 216
```
```
Flash Allocation
ASCII : GS " U n1 n
```
```
Hexadecimal : 1D 22 55 n1 n2
```
```
Decimal: 29 34 85 n1 n2
```
```
Default Value
of n1 :
```
```
1 (see below)
```
```
Default Value
of n2 :
```
```
1 (see below)
```
```
n1 is the number of 64k sectors used for logos and user-defined characters.
n2 is the number of 64k sectors used for user data storage.
This command sets the allocation of Flash sectors between user data storage and
logos/user-defined characters. This allocation is saved in the EEPROM of the printer and
is therefore saved across power cycles.
n1 + n2 <= 6 (3M)
```
```
The 7167 has been configured at the factory with 2M of Flash memory. If n1 + n2 is
greater than the maximum number of sectors available, the command is ignored.
Reissuing this command with different parameters will erase all sectors.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H22) & Chr$(&H55) & Chr$(&Hn1) & Chr$(Hn2)
Exception:
This is command is available only in 7158 Native Mode and 7167 Native Mode.
```

7167 Owner’s Manual Chapter 6: Commands

217 November 2003

Erase User Flash Sector

ASCII:

```
GS @ n
```
```
Hexadecimal: 1D 40 n
Decimal: 29 64 n
Value of n: 49 - 50
```
```
Erases a page of Flash Memory and sends a carriage return when the operation is
complete.
n = 49 (ASCII n = 1)
This command erases all sectors available for user-defined characters and multiple logos.
The page should be erased in two situations: when the logo definition area is full and an
application is attempting to define new logos, and when an application wants to replace
one user-defined character set with another. In both cases, all logos and character set
definitions are erased and must be redefined.
n = 50 (ASCII n = 2)
This command erases all sectors available for user data storage.
Important: While erasing Flash Memory, the printer disables all interrupts, including
communications. To provide feedback to the application, the printer responds to the
application when the erase is complete. After sending the Erase User Flash Sector (1D 40 n )
command, an application should wait for the response from the printer before sending
data. Otherwise, data will be lost. If an application is unable to receive data, it should wait
a minimum of five seconds after sending the Erase User Flash Sector (1D 40 n ) command
before sending data.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H40) & Chr$(n)
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 218
```
```
Printer Setting Change
ASCII : US DC1 [ m n ], [ m n ], ... [ m n ] 0FFH
```
```
Hexadecimal : 1F 11 [ m n ], [ m n ], ... [ m n ] 0FFH
```
```
Decimal: 31 17 [ m n ], [ m n ], ... [ m n ] 0FFH
```
```
Value of m, n :
```
```
m
(Hex)
```
```
Function n
(Hex)
```
```
Function
```
```
10 Interface type 00
01
02
```
##### USB/RS232C

##### RS232C

##### USB

```
11 Baud rate 00
01
02
03
04
05
06
07
```
```
115200 bps
57600 bps
38400 bps
19200 bps
9600 bps
4800 bps
2400 bps
1200 bps
12 Number of data bit 00
01
```
```
8 data bits
7 data bits
13 Number of stop bit 00
01
```
```
1 stop bits
2 stop bits
14 Parity 00
01
```
```
No parity
Even parity
Odd parity
15 Flow control 00
01
```
```
Software (XON/XOFF)
Hardware (DTR/DSR)
16 Data reception errors
option
```
##### 00

##### 01

```
Ignore errors
Print “?”
17 One Line Buffer 00
01
```
```
4 K Buffer
Single Line Buffer (64 bytes)
19 Printer ID mode 00
01
02
```
```
7158 Native ID
Emulated Printer ID
7167 Native ID
20 Emulation 00
01
02
03
```
```
7158 Native mode
7156 mode
7150 mode
7167 Mode
```

7167 Owner’s Manual Chapter 6: Commands

219 November 2003

```
m
(Hex)
```
```
Function n
(Hex)
```
```
Function
```
```
21 Default lines per inch 00
01
02
```
```
8.13 lines per inch
7.52 lines per inch
6 lines per inch
22 Carriage return usage 00
01
```
```
Ignore CR
Use CR as Print cmd.
23 Asian mode 00
01
```
```
Asian mode on
Asian mode off
24 Slip Print Width Option 00
01
```
```
82.2 mm (7167 Mode)
120.7 Conversion (7156/58 Mode)
25 Receipt synchronization 00
01
```
```
Enabled
Disabled
30 Print density 00
01
02
```
##### 100%

##### 110%

##### 120%

```
31 Paper Low sensor option 00
01
```
```
Paper low sensor enable
Paper low sensor disable
32 Paper width 00
01
```
```
80 mm
58 mm
33 Knife option 00
01
```
```
Enable knife
Disable knife
34 MICR option 00
01
```
```
Enable MICR
Disable MICR
35 Check Flip option 00
01
```
```
Enable check flip
Disable check flip
36 Max Power 00
01
```
##### 55 W

##### 75 W

```
37 Color Paper Option 00
01
```
```
One color paper
Two color paper
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 220
```
```
m
(Hex)
```
```
Function n
(Hex)
```
```
Function
```
```
38 MICR dual pass option 00
01
```
```
Dual pass disable
Dual pass enable
40 Default Code page 00
01
02
03
04
05
06
07
08
09
0A
0B
0C
0D
```
##### 437

##### 850

##### 852

##### 858

##### 860

##### 862

##### 863

##### 864

##### 865

##### 866

##### 874

##### 1252

```
Katakana
932 (or 936, 949, 950)^1
50 EEPROM default setting 00 EEPROM default setting
```
```
Set the printer configuration specified by m and n. The printer is reset after receiving this
command to activate the configuration setting. If m or n is out of range, this command is
ignored. The printer will wait for the data until the terminator code “0FFH” is received.
Example:
The following command would set the communication baud rate to 115,200 bps.
```
```
MSComm1.Output = Chr$(&H1F) & Chr$(&H11) & Chr$(&H11) & Chr$(&H0) & Chr$(&HFF)
```
(^1) Not supported by 7167-1035 and 7167-2035


7167 Owner’s Manual Chapter 6: Commands

221 November 2003

#### Asian Character Commands

```
Select print modes for Kanji characters
ASCII : FS! n
```
```
Hexadecimal : 1C 21 n
```
```
Decimal: 28 33 n
```
```
Value of n : The character attribute for Asian character
```
```
Bit Off/On Hex Decimal Function
0 - - - Select font
1 Off 00 0 Undefined
2 Off
On
```
##### 00

##### 01

##### 0

##### 1

```
Double width mode is not selected
Double width mode is selected
3 Off
On
```
##### 00

##### 01

##### 0

##### 1

```
Double height mode is not selected
Double height mode is selected
4 - - - Undefined
5 - - - Undefined
6 - - - Undefined
7 Off
On
```
##### 00

##### 01

##### 0

##### 1

```
Underline mode is not selected
Underline mode is selected
```
```
Default of n : 0
```
```
Selects character attribute for Asian character.
The underline mode can be turned on or off by using FS – or ESC – also.
The thickness of underline is defined by FS – or ESC -, it does not relate to character size.
Example:
MSComm1.Output = Chr$(&H1C) & Chr$(&H21) & Chr$(n)
```
(^3) These commands are not supported by model 7167-1035 and 7167-2035


7167 Owner’s Manual Chapter 6: Commands

```
November 2003 222
```
```
FS – Turn underline mode ON/OFF for Kanji
ASCII : FS - n
```
```
Hexadecimal : 1C 2D n
```
```
Decimal: 28 45 n
```
```
Value of n : 0 = Cancel
```
```
1 = 1 dot height underline
```
```
2 = 2 dot height underline
```
```
Default n : 0 (Cancel)
```
```
Turn underline mode on or off for Asian character.
All characters could be underlined, including character right side spacing.
Underline can be selected by FS! and ESC – also, the last received command is effective.
Example:
MSComm1.Output = Chr$(&H1C) & Chr$(&H2D) & Chr$(n)
```
```
Define user-defined Kanji characters
ASCII : FS 2 c1 c2 d1 ... dn
```
```
Hexadecimal : 1C 32 c1 c2 d1 ... dn
```
```
Decimal: 28 50 c1 c2 d1 ... dn
```
```
Value of c1 : Specified the beginning Asian character code
```
```
Value of c2 : Specified the end Asian character code
```
```
Value of d : Image data
```

7167 Owner’s Manual Chapter 6: Commands

223 November 2003

```
Range of c1,c2 : Japanese
(CP932)
```
```
F0 ≤ c1 ≤ F9, 40 ≤ c2 ≤ 7E and 80 ≤
c2 ≤ FC
```
```
Simplified
Chinese
(CP936)
```
```
A1 ≤ c1 ≤ A7, 40 ≤ c2 ≤ 7E and 80 ≤
c2 ≤ A0, AA ≤ c1 ≤ AF, A1 ≤ c2 ≤
FE, F8 ≤ c1 ≤ FE, A1 ≤ c2
≤ FE
```
```
Korean
(CP949)
```
```
c1 = C9 and c1 = FE, A1 ≤ c2 ≤ FE
```
```
Traditional
Chinese
(CP950)
```
```
81 ≤ c1 ≤ A0 and FA ≤ c1 ≤ FE, 40 ≤
c2 ≤ 7E and 80 ≤ c2 ≤ FE
C7 ≤ c1 ≤ C8, A1 ≤ c2 ≤ FE
```
```
Defines and enters downloaded characters into RAM. The user-defined character will be
cleared by ESC @ or power off of printer. Each character requires 72 bytes for character
definition.
The maximum number of user-defined character is 100.
Example:
MSComm1.Output = Chr$(&H1C) & Chr$(&H32) & Chr$(&HF0) & Chr$(&H40) & Chr$(d1) &
Chr$(dn)
```
```
Set Kanji character spacing
ASCII : FS S n1 n2
```
```
Hexadecimal : 1C 53 n1 n2
```
```
Decimal: 28 83 n1 n2
```
```
Value of n1 : Ignored (0)
```
```
Value of n2 : Character right side spacing dots (1/203 inch)
```
```
Default of n2 : 1 for 1 byte character, 2 for 2 bytes character
```
```
Sets the character right side spacing for characters in Asian character.
The underline is valid on the space set by this command. ESC SP command is not valid for
Asian character code pages. Therefore, this command is used to set the character right side
spacing for characters in Asian code page.
Example:
MSComm1.Output = Chr$(&H1C) & Chr$(&H53) & Chr$(0) & Chr$(100)
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 224
```
```
FS W (Set quadruple mode ON/OFF for Kanji)
ASCII : FS W n
```
```
Hexadecimal : 1C 57 n
```
```
Decimal: 28 87 n
```
```
Value of n : The quadruple mode for Asian characters.
```
```
0 (Bit 0) = Quadruple mode off
```
```
1 (Bit 0) = Quadruple mode on
```
```
Default of n : 0 (Quadruple mode off)
```
```
Selects or cancels the quadruple mode for Asian characters.
FS! and GS! also have control over character size. This, latest received command is
effective.
Example:
MSComm1.Output = Chr$(&H1C) & Chr$(&H57) & Chr$(n)
```

7167 Owner’s Manual Chapter 6: Commands

225 November 2003

#### Scanner Function Commands

pL, pH specify (pL + (pH x 256)) as the number of bytes after pH (fn and m).

Scanning Threshold FS ( g pL pH fn m d1 d2 d3 (when fn = 40)

```
The threshold level of the scanning density is specified by this command.
```
```
ASCII FS ( g pL pH fn m d1 d2 d3
Hex 1C 28 67 pL pH fn m d1 d2 d3
Decimal 28 40 103 pL pH fn m d1 d2 d3
Para Value (pL + pH x 256) = 5 (pL =5, pH = 0)
fn = 40;m = 48;d1 = 1;d2 = 49;-128 < d3 < 127;
Default d3 = 0
```
```
d3
Hex Decimal Function
80H – FEH -128 - - 1 Specifies a density lighter than the standard density level (the
lightest density: – 128)
00H 0 Specifies the standard density level
01H – 7FH 1 – 127 Specifies a density darker than the standard density level (the
darkest density – 127)
```
(^4) These commands are supported only by 7167-1035 and 7167-2035.


7167 Owner’s Manual Chapter 6: Commands

```
November 2003 226
```
Scanning Area FS ( g pL pH fn x1 y1 x2 y2 (when fn = 41)

```
The area on the check to be scanned is defined by this function.
```
```
ASCII FS ( g pL pH fn x1 y1 x2 y2
Hex 1C 28 67 pL pH fn x1 y1 x2 y2
Decimal 28 40 103 pL pH fn x1 y1 x2 y2
```
```
Range (pL + pH x 256) = 5 (pL =5, pH = 0)
fn = 41
0 < x1 < 101
0 < y1 < 229
x1 < x2 < 102, x2=0
y1 < y2 < 230, y2=0
```
```
Default x1 = 0
y1 = 0
x2 = 70
y2 = 0
```
- x1, y1 Specifies the starting point to scan.
- x2, y2 specifies the end point that is to be scanned.
- The possible scanning range is 102 mm (4.02) in the X direction and 230 mm (9.06) in
the Y direction.
x2 > 102 or x2 = 0 specifies the maximum scanning range (=102) in X direction
y2 > 230 specifies the maximum scanning range (=230) in Y direction
If y2 = 0, the scanning range is to the bottom of the sheet within the maximum scanning range of
230 mm.
- All setting values are specified in millimeters for the distance from the origin (lower left
corner in the check).

#### Check Size

```
origin
```

7167 Owner’s Manual Chapter 6: Commands

227 November 2003

Compression Mode FS ( g pL pH fn m n (when fn = 50)

```
This command sets the compression method and the file transmission format for the image data.
```
```
ASCII FS ( g pL pH fn m n
Hex 1C 28 67 pL pH fn m n
Decimal 28 40 103 pL pH fn m n
```
```
Range pL + pH x 256 = 3 (pL =3, pH = 0)
fn = 50
m = 48, 49
n = 48, 49, 50 (when m = 48)
n = 48, 49 (when m = 49)
```
```
Default m = 49, n = 48
```
```
m Compression Method N File Transmission
Format
48 TIFF format
48 No Compression 49 BMP format
50 Raw data
```
```
48
```
```
TIFF format
```
```
B&W Gray scale
49
```
```
Compress ON, if B/W
mode, compress use
CCITT (Group 4); if 8-
bit gray scale mode, use
JPEG algorithm
```
##### 49 N/A JPEG

```
format
```
```
Deletes Cropping Area FS ( g pL pH fn n (when fn = 56)
The defined cropping area n is deleted
```
```
ASCII FS ( g pL pH fn n
Hex 1C 28 67 pL pH fn n
Decimal 28 40 103 pL pH fn n
```
```
Range (pL + pH x 256) = 2 (pL =2, pH = 0)
fn = 56
0 < n < 10
```
```
N = 0 deletes all cropping areas.
After the cropping area is deleted the area number n is cleared.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 228
```
Set Cropping Area FS ( g pL pH fn n x1 y1 x2 y2 (when fn = 57)

```
The area to be cropped is the area of data that is to be retained. The remaining area of the scanned
area is returned as “white” data. The area to be cropped is defined by n.
```
- x1, y1 specifies the starting point to be cropped
- x2, y2 specifies the ending point to be cropped
- The scanning range is 102 mm (4.02) in the X direction and 230 mm (9.06) in the Y direction.
x2 > 102 specifies the maximum cropping range (= 102) in the X direction.
y2 > 230 specifies the maximum cropping range (= 230) in the Y direction.
- All values are specified in millimeters for the distance from the origin of the check.
(lower left corner of the check).

```
ASCII FS ( g pL pH fn n x1 y1 x2 y2
Hex 1C 28 67 pL pH fn n x1 y1 x2 y2
Decimal 28 40 103 pL pH fn n x1 y1 x2 y2
```
```
Range (pL + pH x 256) = 6 (pL = 6, pH = 0)
Fn = 57
1 < n < 10
x1scan < x1 < x2scan
y1scan < y1 < y2scan
x1 < x2 < x2scan
y1 < y2 < y2scan
```
```
Default No cropping area is set
```
```
Scan Area outside cropping areas are turned white and sent together when CropID
in corresponding commands are not 41H-4AH
```
```
Data in cropping
area retained
```
```
Cropping area 1
```

7167 Owner’s Manual Chapter 6: Commands

229 November 2003

Transmission Format FS ( g pL pH fn m (When fn = 60)

```
This command sets the transmission file format as binary or hexadecimal
```
```
ASCII FS ( g pL pH fn m
Hex 1C 28 67 pL pH fn m
Decimal 28 40 103 pL pH fn m
```
```
Range (pL + pH x 256) = 2 (pL =2, pH = 0)
fn = 60
m = 48, 49
```
```
Default m = 48
```
```
m Transmission Method
48 Transmits the image data in Binary format.
49 Transmits the image data with Hexadecimal character strings format.
```
```
Notes Since the default value of this command is set to the one most suitable for the
kind of interface, it is recommended to use the default as is. The default value can be
checked with function 100.
```
```
With the serial interface model, when XON/OFF control is selected, specify m = 49.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 230
```
Transmits Threshold Level FS ( g pL pH fn m (when fn = 80)

```
The density of the threshold level of the scanned image for Function 40 is communicated to the
host.
```
```
ASCII FS ( g pL pH fn m
Hex 1C 28 67 pL pH fn m
Decimal 28 40 103 pL pH fn m
```
```
Range (pL + pH x 256) = 2 (pL =2, pH = 0)
fn = 80
m = 48
```
```
Transmission Data Hexadecimal Decimal Amount of Data
Header 37H 55 1 byte
Identifier 3BH 59 1 byte
Fixed Value 34H, 38H 52, 56 2 bytes
Separator 1FH 31 1 byte
m of Function 40 34H, 38H 52, 56 2 bytes
Separator 1FH 31 1 byte
d1 of Functtion 40 31H 49 1 byte
Separator 1FH 31 1 byte
d2 of Function 40 34H, 39H 52, 57 2 bytes
Separator 1FH 31 1 byte
d3 of Function 40 30H - 39H 48 - 57 1 - 3 bytes
NUL 00H 0 1 byte
```
```
The value and transmission data of d3 of Function 40 are as follows:
```
```
Setting value -128 ... -1 0 1 ... 127
Transmission data 128 ... 255 0 1 ... 127
```
```
The transmission data values are converted to hexadecimal characters strings for the image data.
```
```
Example: When data is 48 the transmission data will be:
Hexadecimal: 34H, 38H
Decimal: 52, 56
```

7167 Owner’s Manual Chapter 6: Commands

231 November 2003

Transmits Scanning Area FS ( g pL pH fn m (when fn = 81)

```
The scanned image area for Function 41 is communicated to the host.
```
```
ASCII FS ( g pL pH fn m
Hex 1C 28 67 pL pH fn m
Decimal 28 40 103 pL pH fn m
```
```
Range (pL + pH x 256) = 2 (pL =2, pH = 0)
fn = 81
m = 48
```
```
Default Same as Function 41 of FS ( g.
```
```
Transmission Data Hexadecimal Decimal Amount of Data
Header 37H 55 1 byte
Identifier 3CH 60 1 byte
Fixed Value 34H, 38H 52, 56 2 bytes
Separator 1FH 31 1 byte
x1 of Function 41 30H - 39H 48 - 57 1 - 3 bytes
Separator 1FH 31 1 byte
y1 of Function 41 30H - 39H 48 - 57 1 – 3 bytes
Separator 1FH 31 1 byte
x2 of Function 41 30H, 39H 48 - 57 1 – 3 bytes
Separator 1FH 31 1 byte
y2 of Function 41 30H - 39H 48 - 57 1 - 3 Bytes
NUL 00H 0 1 Byte
```
```
The transmission data values are converted to hexadecimal characters strings for the image data.
```
```
Example: When data is 48 the transmission data will be:
Hexadecimal: 34H, 38H
Decimal: 52, 56
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 232
```
Transmits Compression Method FS ( g pL pH fn m (when fn = 90)

```
Command Description:
```
```
The method of file compression and the file transmission format for the
image data will be communicated to the host device for the value of Function 50.
```
```
ASCII FS ( g pL pH fn m
Hex 1C 28 67 pL pH fn m
Decimal 28 40 103 pL pH fn m
```
```
Range (pL + pH x 256) = 2 (pL =2, pH = 0)
fn = 90
m = 48
```
```
Transmission Data Hexadecimal Decimal Amount of
Data
Header 37H 55 1 byte
Identifier 3DH 61 1 byte
Fixed Value 34H, 38H 52, 56 2 bytes
Separator 1FH 31 1 byte
m of Function 50 34H, 38H or
34H, 39H
```
```
52, 56 or
52, 57
```
```
2 bytes
```
```
Separator 1FH 31 1 byte
n of Function 50 34H ,38H or 34H,
39H or 35H,30H
```
```
52, 56 or 52, 57 or
53, 48
```
```
2 bytes
```
```
NUL 00H 0 1 Byte
```
```
The transmission data values are converted to hexadecimal characters strings for the image data.
```
```
Example: When data is 48 the transmission data will be:
Hexadecimal: 34H, 38H
Decimal: 52, 56
```

7167 Owner’s Manual Chapter 6: Commands

233 November 2003

Transmits the cropping area FS ( g pL pH fn m (when fn = 97)

```
Command Description:
```
```
The cropping area of the scanned image as defined is communicated to the host
```
```
ASCII FS ( g pL pH fn m
Hex 1C 28 67 pL pH fn m
Decimal 28 40 103 pL pH fn m
```
```
Range (pL + pH x 256) = 2 (pL =2, pH = 0)
fn = 97
m = 48
```
```
Transmission Data Hexadecimal Decima
l
```
```
Amount of Data
```
```
Header 37H 55 1 byte
Identifier 75H 117 1 byte
Fixed Value 40H, last Block
41H next Blk
exist
```
```
64 or
65
```
```
1 byte
```
```
Separator 1FH 31 1 byte
Data 30H - 39H
and 1FH
```
##### 48 – 57

```
and 31
```
```
9 - 80 bytes
```
```
NUL 00H 0 1 Byte
```
```
The “Data” will consist of data groups enumerated with the associated key codes.
```
```
If the total amount of data exceeds 80 bytes when several cropping areas are set, the data is divided
up to a maximum of 80 bytes, then transmitted.
```
```
Transmission Data Hexadecimal Decimal Amount of Data
```
```
n of Function 57 30H - 39H 48 - 57 1-2 byte
Separator 1FH 31 1 byte
x1 of Function 57 30H - 39H 48 - 57 1 - 3 bytes
Separator 1FH 31 1 byte
y1 of Function 57 30H - 39H 48 - 57 1 - 3 bytes
Separator 1FH 31 1 byte
x2 of Function 57 30H - 39H 48 - 57 1 - 3 bytes
Separator 1FH 31 1 byte
y2 of Function 57 30H - 39H 48 - 57 1 - 3 bytes
Separator 1FH 31 1 byte
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 234
```
```
Data transmission by this command is controlled by the ESC/POS handshaking protocol. The
ESC/POS handshaking protocol is defined as the protocol that the printer receives as a response
from the host after the [Header-NUL] is transmitted: then it performs the following process,
corresponding to the response.
```
```
When the identification status (existence of the next data block) is
Hexadecimal = 41H/Decimal = 65
```
```
Response
ASCII HEX Decimal Process Performed
ACK 06H 6 Transmits the next data block
NAK 15H 21 Transmits the previous data block again
CAN 18H 24 Cancels the process
```
```
When the identification status (for the previous data block) is
Hexadecimal = 40H / Decimal = 64
```
```
Response
ASCII HEX Decimal Process Performed
ACK 06H 6 Ends the process
NAK 15H 21 Transmits the previous data block again
CAN 18H 24 Cancels the process
```

7167 Owner’s Manual Chapter 6: Commands

235 November 2003

Transmits the File Format FS ( g pL pH fn m (when fn = 100)

```
Command Description:
```
```
This command transmits the format of the file transmission formation for the function value of 60
for the image data.
```
```
ASCII FS ( g pL pH fn m
Hex 1C 28 67 pL pH fn m
Decimal 28 40 103 pL pH fn m
```
```
Range (pL + pH x 256) = 2 (pL =2, pH = 0)
fn = 100
m = 48
```
```
Transmission Data Hexadecimal Decimal Amount of Data
Header 37H 55 1 byte
Identifier 3EH 62 1 byte
Fixed Value 34H, 38H 52, 56 2 bytes
Separator 1FH 31 1 byte
m of Function 60 34H, 38H or
34H, 39H
```
```
52, 56 or
52, 57
```
```
2 bytes
```
```
NUL 00H 0 1 Byte
```
```
The transmission data values are converted to hexadecimal characters strings for the image data.
```
```
Example: When data is 48 the transmission data will be:
Hexadecimal: 34H, 38H
Decimal: 52, 56
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 236
```
Select Scanning mode FS ( g pL pH fn m (when fn = 101)

```
Command Description:
```
```
This command selects the scanning mode.
```
```
ASCII FS ( g pL pH fn m
Hex 1C 28 67 pL pH fn m
Decimal 28 40 103 pL pH fn m
```
```
Range (pL + pH x 256) = 2 (pL =2, pH = 0)
fn = 101
m = 48,49
Default m = 48
```
```
m Scanning Mode
48 Black / White mode
49 8 bit gray scale mode
```
Transmits Scanning mode FS ( g pL pH fn m (when fn = 102)

```
Command Description:
```
```
This command transmits the scanning mode.
```
```
ASCII FS ( g pL pH fn
Hex 1C 28 67 pL pH fn
Decimal 28 40 103 pL pH fn
```
```
Range (pL + pH x 256) = 1 (pL =1, pH = 0)
fn = 102
```
```
This command transmits the scanning mode as the following format.
```
```
Transmission Data Hexadecimal Decimal Amount of Data
Header 37H 55 1 byte
Identifier 3AH 62 1 byte
Fixed Value 34H, 38H 52, 56 2 bytes
Separator 1FH 31 1 byte
m of Function 101 34H, 38H or
34H, 39H
```
```
52, 56 or
52, 57
```
```
2 bytes
```
```
NUL 00H 0 1 Byte
```
```
The transmission data values are converted to hexadecimal characters strings for the image data.
```
```
Example: When data is 48 the transmission data will be:
Hexadecimal: 34H, 38H
Decimal: 52, 56
```
Executes Scan GS ( G pL pH fn nl nH m1 m2 [d1...dk] (when fn = 65)

```
Command Description:
```

7167 Owner’s Manual Chapter 6: Commands

237 November 2003

```
Executes the process for the scanning of the image from the slip station and then transmits the
scanned data to the host computer.
Hogan makes busy status during executing of scanning. Host can’t send any data to Hogan in that
time.
```
- If [d1..dk] is specified, [d1..dk] is added to the image data.
- If m1 is 48, when the scan operation is successful the printer transmits a three-block data group:
file information block, size information block and an image data block in that sequence.
- Scan result will be retained in working buffer until another scan is performed or power off.
- If m1 is 49, this command executes scanning only. It doesn’t transmit image data.
- When an error occurs in scanning, the printer transmits the file information block only.
- The contents of each data block are as shown below:

```
ASCII GS ( G pL pH fn nl nH m1 m2 [d1...dk]
Hex 1D 28 67 pL pH fn nl nH m1 m2 [d1...dk]
Decimal 29 40 103 pL pH fn nl nH m1 m2 [d1...dk]
```
```
Range 5 < (pL + pH x 256) < 260 (0 < pL < 255, 0 < pH < 1)
fn = 65
(nl + nH x 256) = 1 (nl = 1, nH = 0)
m1 = 48, 49
m2 = 48
0 < d < 255
0 < k < 255
```
```
a) When Binary is selected as file transmission format with Function 60 of FS ( g.
Transmission Data Hexadecimal Decimal Amount of Data
Header 53H 83 1 byte
Identifier 20H 32 1 byte
Identification status 42H : last Blk
43H : next Blk exist
```
```
64 – 67 1 byte
```
```
Information data (See
below)
```
```
Selections from 00H
```
- FFH

```
0 - 255 1 byte
```
```
Identification status is indicates
40H: current block is last data block
41H:existence of the next data block
```
```
Information data in the file information block is as follows:
Transmission Data Hexadecimal Decimal Amount of Data
Block Code 46H 70 1 byte
Fixed value 31H 49 1 byte
Separator 1FH 31 1 byte
Scanning status Normal: 50H
Abnormal: 70H
```
```
Normal: 80
Abnormal: 112
```
```
1 byte
```
```
Detailed information
(See Table below)
```
```
40H – 48H 64 – 72 1 byte
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 238
```
```
Separator 1FH 31 1 byte
Compression process
(*1)(*2)
```
```
30H – 39H 48 – 57 0 – 2 bytes
```
```
File transmission format
(*1)
```
```
30H – 39H 48 – 57 0 – 2 bytes
```
```
Separator 1FH 31 1 byte
Fixed value (*1) 34H, 38H, 30H, 34H
38H, 34H, 38H
```
##### 52, 56, 48, 52,

##### 56, 52, 56

```
1 – 7 bytes
```
```
NUL 00H 0 1 byte
```
```
*1. This type of data is not transmitted if an error has occurred.
*2. This value depends on the value set with Function 50 of FS ( g.
```
```
Status Information Hexadecimal Decimal
Normal Not abnormal status 40 64
Abnormal There isn’t any data for the scanned image 41 65
Abnormal Processing stopped due to cover open. 44 68
Abnormal An error occurred in the compression of image data 47 71
Abnormal A check feeding error occurred during the scan of the
check.
```
##### 48 72

```
*3. The check size is smaller than scan area size.
```

7167 Owner’s Manual Chapter 6: Commands

239 November 2003

```
The size information block for the information data is shown below (This data is not transmitted if
an error occurred).
```
```
Information Data Hexadecimal Decimal Amount of Data
Block Code 53H 83 1 byte
Fixed value 30H, 30H 48, 48 2 bytes
Separator 1FH 31 1 byte
X starting point (*1) 30H – 39H 48 – 57 1 – 3 bytes
Separator 1FH 31 1 byte
Y starting point (*1) 30H – 39H 48 – 57 1 – 3 bytes
Separator 1FH 31 1 byte
X ending point (*2) 30H – 39H 48 – 57 1 – 3 bytes
Separator 1FH 31 1 byte
Y ending point (*2) 30H – 39H 48 – 57 1 – 3 bytes
Separator 1FH 31 1 byte
Amount of data in X (*3) 30H – 39H 48 – 57 1 – 4 bytes
Separator 1FH 31 1 byte
Amount of data in Y (*4) 30H – 39H 48 – 57 1 – 4 bytes
NUL 00H 0 1 byte
*1. This value depends on the value set with Function 41 of FS (g.
*2. This point indicates the ending point of the actual reading area.
*3. This numerical value indicates the amount of actual scanning data in the X direction (dots).
*4. This number value indicates the amount of the actual scanning data in the Y direction (dots).
```
```
Information data for the image data block is shown below (this data is not transmitted if an error
occurred).
```
```
Information Data Hexadecimal Decimal Amount of Data
Block Code 53H 20H 83, 32 2 bytes
Identification status 40H : last Blk
41H : next Blk exist
```
```
64 – 65 1 bytes
```
```
Block Size 1-FFFFH 1-65535 2 bytes
image data 00H – FFH 0 – 255 1 – 65535 bytes
```
```
If the total amount of data exceeds 65535 bytes, the data is divided up to a maximum of 65536
bytes, then transmitted
```
```
b) When Hexadecimal character strings is selected as file transmission format with Function 60 of
FS ( g.
```
```
Transmission Data Hexadecimal Decimal Amount of Data
Header 37H 55 1 byte
Identifier 74H 116 1 byte
Identification status 42H : last Blk
43H : next Blk exist
```
```
64 – 65 1 byte
```
```
Information data (See
below)
```
##### 30H – 39H

##### 41H – 46H

##### 48 – 57

##### 65 – 70

```
1 – 80 bytes
```
```
NULL 00H 0 1 byte
```
```
Information data in the file information block is as follows:
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 240
```
```
Transmission Data Hexadecimal Decimal Amount of Data
Block Code 46H 70 1 byte
Fixed value 31H 49 1 byte
Separator 1FH 31 1 byte
Scanning status Normal: 50H
Abnormal: 70H
```
```
Normal: 80
Abnormal: 112
```
```
1 byte
```
```
Detailed information
(See Table below)
```
```
40H – 48H 64 – 72 1 byte
```
```
Separator 1FH 31 1 byte
Compression process
(*1)(*2)
```
```
30H – 39H 48 – 57 0 – 2 bytes
```
```
File transmission format
(*1)
```
```
30H – 39H 48 – 57 0 – 2 bytes
```
```
Separator 1FH 31 1 byte
Fixed value (*1) 34H, 38H, 30H, 34H
38H, 34H, 38H
```
##### 52, 56, 48, 52,

##### 56, 52, 56

```
1 – 7 bytes
```
```
NUL 00H 0 1 byte
```
```
*1. This type of data is not transmitted if an error has occurred.
*2. This value depends on the value set with Function 50 of FS ( g.
```
```
Status Information Hexadecimal Decimal
Normal Not abnormal status 40 64
Abnormal There isn’t any data for the scanned image 41 65
Abnormal Processing stopped due to cover open. 44 68
Abnormal An error occurred in the compression of image data 47 71
Abnormal A check feeding error occurred during the scan of the
check.
```
##### 48 72


7167 Owner’s Manual Chapter 6: Commands

241 November 2003

```
The size information block for the information data is shown below (This data is not transmitted if
an error occurred).
```
```
Information Data Hexadecimal Decimal Amount of Data
Block Code 53H 83 1 byte
Fixed value 30H, 30H 48, 48 2 bytes
Separator 1FH 31 1 byte
X starting point (*1) 30H – 39H 48 – 57 1 – 3 bytes
Separator 1FH 31 1 byte
Y starting point (*1) 30H – 39H 48 – 57 1 – 3 bytes
Separator 1FH 31 1 byte
X ending point (*2) 30H – 39H 48 – 57 1 – 3 bytes
Separator 1FH 31 1 byte
Y ending point (*2) 30H – 39H 48 – 57 1 – 3 bytes
Separator 1FH 31 1 byte
Amount of data in X (*3) 30H – 39H 48 – 57 1 – 4 bytes
Separator 1FH 31 1 byte
Amount of data in Y (*4) 30H – 39H 48 – 57 1 – 4 bytes
NUL 00H 0 1 byte
*1. This value depends on the value set with Function 41 of FS (g.
*2. This point indicates the ending point of the actual reading area.
*3. This numerical value indicates the amount of actual scanning data in the X direction (dots).
*4. This number value indicates the amount of the actual scanning data in the Y direction (dots).
```
```
Information data for the image data block is shown below (this data is not transmitted if an error
occurred).
Information Data Hexadecimal Decimal Amount of Data
Block Code 37H 74H 55 116 1 byte
Identification status 40H : last Blk
41H : next Blk exist
```
```
64 – 65 1 bytes
```
```
image data 30H – 39H, 41H – 46H 48 – 57, 65 - 70 1 – 80 bytes
NUL 00H 0 1 byte
```
```
If the total amount of data exceeds 80 bytes, the data is divided up to a maximum of 80 bytes, then
transmitted
```
```
The printer transmits the image data in the file transmission format specified with Function 50 of
FS ( g.
```
```
If the capacity of the image data is large, the image data is divided into several data blocks, then
transmitted.
```
```
Only when Hexadecimal is specified as the file transmission format with Function 60 of FS (g, the
transmission data values are converted to the hexadecimal character strings for the image data.
Example: When data is 3FH. The transmission data is Hexadecimal: 30H, 46H, Decimal 48, 70.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 242
```
```
Data transmitted with this command is controlled by the ESC/POS handshaking protocol. The
ESC/POS handshaking protocol is defined as the protocol that the printer receives as a response
from the host; then it performs the following process corresponding to the response.
```
```
When the identification status is: Hexadecimal = 41H, 43H / Decimal = 65, 67.
```
```
Response
ASCII HEX Decimal Process Performed
ACK 06H 6 Transmits the next data block
NAK 15H 21 Transmits the previous data block again
CAN 18H 24 Cancels the process
```
```
When the identification status is: Hexadecimal = 40H, 42H / Decimal = 64, 66
```
```
Response
ASCII HEX Decimal Process Performed
ACK 06H 6 Ends the process
NAK 15H 21 Transmits the previous data block again
CAN 18H 24 Cancels the process
```
```
Notes:
```
- While transmitting block data, the printer does not process a real-time command or send ASB
status. Therefore it is not possible to determine the printer status while transmitting data.


7167 Owner’s Manual Chapter 6: Commands

243 November 2003

(^) Header
File information block
Size information block
image data block
Send to Host
Host
Send ACK
image data block Send to Host
:
:
:
image data block Send to Host
Send ACK
:
:
:


7167 Owner’s Manual Chapter 6: Commands

```
November 2003 244
```
```
Transmit Scan Image from Working Buffer GS ( G pL pH fn m CropID [d1...dk],
k=1, ..., 255
```
```
Command Description:
```
- Retrieve original scan data from working buffer (RAM)
- Crop, compress and make image file based on current settings and transmit it to the host
- If scan has not be executed on receiving this command, send error block
- If Bit6 of CropID is ON (CropID= 0x41 to 0x4A), This command transmits cropping area data
only.

```
ASCII GS ( G pL pH fn m CropID [d1...dk]
Hex 1D 28 47 pL pH fn m CropID [d1...dk]
Decimal 29 40 71 pL pH fn m CropID [d1...dk]
```
```
Range 2<(pL + pH x 256) <= 257
fn = 66
m=48: use original data in scan image buffer, crop according to the cropping area set by CropID,
compress and make image file based on current settings, then transmit file to host
CropID=0, transmit original (uncropped) image
CropID=1-10, transit image file with the nth cropping area, data outside the cropping area but
inside the scanarea will be transmitted as “white”.
CropID=0x41 – 0x4A, transmit image file with the nth (n=1 to 10) cropping area, but only data
that resides within the Crop Area is transmitted.
CropID>10 (except 0x41 to 0x4A), transmit image file with all the cropping area set, if no
cropping area is set, send the original scan image
```
```
When GS ( G Function 65 is not executed, only the file information block which consists of the
following information data, is transmitted. Information data in the file information block is as
follows.
```
```
Transmission Data Hexadecimal Decimal Amount of Data
Header 53H / 37H 83/55 1 byte
Identifier 20H / 74H 32/116 1 byte
Identification status 42H : last Blk 66 1 byte
Block Code 46H 70 1 byte
Fixed value 31H 49 1 byte
Separator 1FH 31 1 byte
Scanning status 70H 112 1 byte
Detailed information 41H 65 1 byte
Separator 1FH 31 1 byte
NUL 00H 0 1 byte
```
```
If scan has completed normally, Hogan will send image file to host, data strings have the same
format as that in “Execute Scan” command.
```
```
Notes:
```
- While transmitting block data, the printer does not process a real-time command or send ASB
status. Therefore it is not possible to determine the printer status while transmitting data.


7167 Owner’s Manual Chapter 6: Commands

245 November 2003

```
Transmit Scan Image from Flash ROM GS ( G pL pH fn m FileIndex (when fn =
73)
```
```
Command Description:
```
- Retrieve scan image file from flash ROM and transmit to host.
- If scan has not be executed on receiving this command, send error block

```
ASCII GS ( G pL pH fn m [File Index]
Hex 1D 28 47 pL pH fn m [File Index]
Decimal 29 40 71 pL pH fn m [File Index]
Range pL + pH x 256=2
fn = 73
m=49: send image file stored in flash ROM to host, the image file is selected using File Index,
which is defined by the firmware when image file is stored into flash ROM, FileIndex is larger
than 0 in this command.
If cannot find an image file with the specified FileIndex in flash ROM, transmit the following
block.
```
```
Transmission Data Hexadecimal Decimal Amount of Data
Header 53H / 37H 83/55 1 byte
Identifier 20H / 74H 32/116 1 byte
Identification status 42H : last Blk 66 1 byte
Block Code 46H 70 1 byte
Fixed value 31H 49 1 byte
Separator 1FH 31 1 byte
Scanning status 70H 112 1 byte
Detailed information 41H 65 1 byte
Separator 1FH 31 1 byte
NUL 00H 0 1 byte
```
```
If the image file exists, send the file in the same format as that sent in “Execute Scan”
command.
```
```
Notes:
```
- While transmitting block data, the printer does not process a real-time command or send ASB
status. Therefore it is not possible to determine the printer status while transmitting data.


7167 Owner’s Manual Chapter 6: Commands

```
November 2003 246
```
Store Scan Image to Flash ROM GS ( G pL pH fn n [d1..dk] (when fn = 70)

```
Hogan makes busy status during store scan image. Host can’t send any data to Hogan at that time.
```
```
Command Description:
```
- If [d1..dk] is specified, it’s added to image file as image description (image tag data); if not
specified, use the one specified before. This string is included in the image file.
- Image file will be appended to the end of the last image stored in flash ROM.
- In each image file, the first 2 bytes hold file index (2 byte), the next 4 bytes store the length of
the file, followed by 2 blocks of scan information and image file data string.
- Original scan data are retrieved from working buffer, cropped, compressed and made into image
file based on current settings.
- The scanner locates all available flash ROM space and compares with the image size.
- If the image file size is smaller than ROM space, increase file index number and write file to
falsh ROM, send host “store information” block
- If ROM space is too small for image file, transmit “store information” block to host
- Max. number of files can be stored is 255.
- If bit6 of n(CropID) is 1, Hogan stores only image data that resides within the crop area.

```
ASCII FS ( g pL pH fn n [d1... dk]
Hex 1D 28 47 pL pH fn n [d1 ...dk]
Decimal 29 40 71 pL pH fn n [d1... dk]
```
```
Range 2<=(pL + pH x 256) <= 257
fn = 70
n: CropID, n = 0, no cropping, or n<10 and equal to CropID that is not defined, entire scan area
selected;
n = exist CropAreaID (0x00 to 0x0A), only selected crop area is processed and stored,
n = exist CropAreaID (0x41 to 0x4A), only selected crop area is processed and stored. The
stored data is only data that resides within the crop area.
n>10 (except 0x41 to 0x4A), all crop areas are selected
```
```
The storage information block is as follows:
```
```
Transmission Data Hexadecimal Decimal Amount of Data
Header 37H 55 1 byte
Identifier 77H 119 1 byte
Fixed Value 34H, 38H 52, 56 2 bytes
Separator 1FH 31 1 byte
Store Status 30-33H(*1) 48-51 1 byte
Separator 1FH 31 1 byte
FileIndex 30-39H 48-57 1-3 bytes
Separator 1FH 31 1 byte
Free ROM space 30 - 39H,
41 - 46H
```
##### 48 - 57,

##### 65 - 70

```
6 bytes
```
```
Separator 1FH 31 1 byte
NUL 00H 0 1 Byte
```
```
*1. Store Status: Successful 30H
Not enough memory 31H
Image file not exist 32H
Flash ROM is cleared 33H
```

7167 Owner’s Manual Chapter 6: Commands

247 November 2003

```
Notes:
```
- While writing flash ROM, the printer does not process a real-time command or send ASB status.
Therefore it is not possible to determine the printer status while storing scan image.

Clear All Scan Images GS ( G pL pH fn (when fn = 71)

```
Hogan makes busy status in clearing flash ROM. Host can’t send any data to Hogan at that time.
Command Description:
```
- Erase all scan image files

```
ASCII FS ( g pL pH fn
Hex 1D 28 47 pL pH fn
Decimal 29 40 71 pL pH fn
```
```
Range
pL=1, pH=0
fn = 71
```
```
Notes:
```
- While clearing flash ROM, the printer does not process a real-time command or send ASB
status. Therefore it is not possible to determine the printer status while clearing image files.
- This command sent the information block to host PC. The format is same format of the store to
flash ROM command.


7167 Owner’s Manual Chapter 6: Commands

```
November 2003 248
```
```
Print Scanned Image GS ( G pL pH fn m (when fn = 68)
Command Description:
```
```
This command performs printing the scanned image data
```
```
ASCII GS ( G pL pH fn m
Hex 1D 28 47 pL pH fn m
Decimal 29 40 71 pL pH fn m
```
```
Range (pL + pH x 256) = 2 (pl = 2, pH = 0)
fn = 68
m = 48,49
```
```
Default m = 48
```
```
m Printing ratio of x direction
48 100% printing mode
if scan area width > printable width, the extra image is cut.
49 50% printing mode (Horizontal & Vertical direction)
```
```
This command is available on Black/White mode. (When scan mode is 8 bit gray scale, this
command is ignored.)
```
```
Execute Shading correction GS ( G pL pH fn m (when fn = 69)
Command Description:
```
```
This command performs Black/White shading correction.
```
```
ASCII GS ( G pL pH fn m
Hex 1D 28 47 pL pH fn m
Decimal 29 40 71 pL pH fn m
Parameter Value (pL + pH x 256) = 2 (pl = 2, pH = 0)
fn = 69
m = 48,49
Default m = 48
```
```
m Shading correction
48 Execute Black Shading correction
49 Execute White Shading correction
```

7167 Owner’s Manual Chapter 6: Commands

249 November 2003

```
Reverse feed to top of form GS ( G pL pH fn m (when fn = 74)
Command Description:
```
```
This command performs a reverse feed to top of form on the slip print station.
This command is ignored if slip is not the selected station.
```
```
ASCII GS ( G pL pH fn m
Hex 1D 28 47 pL pH fn m
Decimal 29 40 71 pL pH fn m
Parameter value (pL + pH x 256) = 2 (pl = 2, pH = 0)
fn = 74
m = 48
```
#### Flash Download Commands............................................................................................

```
These commands are used to load firmware into the printer.
The commands are listed in numerical order according to their hexadecimal codes. Each
command is described and the hexadecimal, decimal, and ASCII codes are listed.
There are three ways to enter the Download Mode.
```
1. Powering the printer up with DIP Switch 2 up.
2. While the printer is running normally, use the command Switch to Flash Download
    Mode, to leave normal operation and enter the Download Mode.
3. If the Flash if found corrupted during Level 0 diagnostics the Download Mode is
    automatically entered after the printer has reset.
The printer never goes directly from the Download Mode to normal printer operation. To
return to normal printer operation either the operator must turn the power off and then on
to reboot or the application must send a command to cancel Download Mode and reboot.

```
Switch to Flash Download Mode
ASCII: ESC [ }
```
```
Hexadecimal: 1B 5B 7D
```
```
Decimal: 27 91 125
```
```
Puts the printer in Flash Download Mode in preparation to receive commands controlling
the downloading of objects into Flash Memory. When this command is received, the
printer leaves normal operation and can no longer print transactions until the Reboot the
Printer command (1D FF) is received or the printer is rebooted.
This command does not affect the current communication parameters. Once the printer is
in Flash Download Mode, this command is no longer available.
Example:
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 250
```
```
MSComm1.Output = Chr$(&H1B) & Chr$(&H5B) & Chr$(&H7D)
```
```
Request Printer ID
ASCII: GS NUL
```
```
Hexadecimal: 1D 00
```
```
Decimal: 29 0
```
```
Returns ACK (06 hex) + 12 bytes ASCII string describing the Flash Memory Boot Sector
Firmware part number. Ex : 189-1234567A
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H00)
```

7167 Owner’s Manual Chapter 6: Commands

251 November 2003

```
Return Segment Number Status of Flash Memory
ASCII: GS SOH
```
```
Hexadecimal: 1D 01
```
```
Decimal: 29 1
```
```
Returns the size of the Flash used. There may be 8, 16, or 32 sectors (64K each) in Flash
Memory. This command assures that the firmware to be downloaded is the appropriate
size for Flash Memory. The value returned is the maximum sector number that can be
accepted by the Select Sector to Download (1D 02 n ) command.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H01)
Exceptions:
Available only in Download Mode.
```
```
Select Flash Memory Sector to Download
ASCII : GS STX n
```
```
Hexadecimal : 1D 02 n
```
```
Decimal: 29 2 n
```
```
Value of n : The Flash sector to which the next download
operation applies
```
```
Range of n : 0 – 7 (512K)
```
```
0 – 15 (1 mB)
```
```
0 – 31 (2 mB)
```
```
Selects the Flash sector (nn) for which the next download operation applies. The values of
the possible sector are restricted, depending upon the Flash part type. The printer
transmits an ACK if the sector number is acceptable or an NAK if the sector number is not
acceptable. Sector numbers start at 0.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H02) & Chr$(n)
Exceptions:
Available only in Download Mode.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 252
```
```
Get Firmware CRC
ASCII: GS ACK
```
```
Hexadecimal: 1D 06
```
```
Decimal: 29 6
```
```
Causes the printer to calculate the CRC for the currently selected sector and transmits the
result. This is performed normally after downloading a sector to verify that the
downloaded firmware is correct. The printer also calculates the CRC for each sector
during power up and halts the program if any sector is erroneous.
The printer transmits ACK if the calculated CRC is correct for the selected sector; NAK if
the CRC is incorrect or if no sector is selected.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H06)
```
```
Return Microprocessor CRC
ASCII: GS BEL
```
```
Hexadecimal: 1D 07
```
```
Decimal: 29 7
```
```
Returns the CRC calculated over the boot sector code space.
Formulas: ACK <low byte> <high byte>
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H07)
```
```
Erase the Flash Memory
ASCII: GS SO
```
```
Hexadecimal: 1D 0E
```
```
Decimal: 29 14
```
```
Causes the entire Flash Memory (except the boot) to be erased.
The printer returns ACK if the command is successful; NAK if it is unsuccessful.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H0E)
Exceptions:
```

7167 Owner’s Manual Chapter 6: Commands

253 November 2003

```
Available only in Download Mode.
```
```
Return Main Program Flash CRC
ASCII: GS SI
```
```
Hexadecimal: 1D 0F
```
```
Decimal: 29 15
```
```
Returns the CRC calculated over the Flash firmware code space. The format of the
response is ACK <low byte> <high byte>.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H0F)
```
```
Erase Selected Flash Sector
ASCII : GS DLE n
```
```
Hexadecimal : 1D 10 n
```
```
Decimal: 29 16 n
```
```
Value and Range of n : 0 – 7 = 512K bytes Flash
```
```
0 – 15 = 1M bytes Flash
```
```
0 – 31 = 2M bytes Flash
```
```
Erases the previously selected sector. The printer transmits ACK when the sector has been
erased. If the previous sector is not successfully erased, or if no sector was selected, the
printer transmits NAK.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&H10) & Chr$(n)
Exceptions:
Available only in Download Mode.
```

7167 Owner’s Manual Chapter 6: Commands

```
November 2003 254
```
```
Download to Active Flash Sector
ASCII : GS DC1 al ah cl ch d1...dn
```
```
Hexadecimal : 1D 11 al ah cl ch d1...dn
```
```
Decimal: 29 17 al ah cl ch d1...dn
```
```
Value of al: low byte of the address
```
```
Value of ah: high byte of the address
```
```
Value of cl: low byte of the count
```
```
Value of ch: high byte of the count
```
```
Value of d: data bytes, from 1 to n
```
```
Contains a start address (ah * 256 + al) and count (ch * 256 + cl) of binary bytes to load into
the selected sector, followed by that many bytes. The start address is relative to the start of
the sector. Addresses run from 0 to 64K.
The printer may return one of several responses. ACK means that the data was written
correctly and the host should transmit the next block. NAK means that, for some reason,
the data was not written correctly. This could mean that communications failed or that the
write to Flash failed. The alternatives seem to be to retry the block or halt loading and
assume a hardware failure.
```
```
Value of n (for number of data bytes) Range of Address (al ah) Range of Count (cl ch)
(( ch * 256) + cl ) 2000-FFFF (hexadecimal) 0001-0400 (hexadecimal)
```
```
Range: Addresses run from 0 to 64K.
Related Information:
Available only in Download Mode.
```

7167 Owner’s Manual Chapter 6: Commands

255 November 2003

```
Reboot the Printer
ASCII : GS (SPACE)
```
```
Hexadecimal : 1D FF
```
```
Decimal: 29 255
```
```
Ends the load process and reboots the printer. Before executing this command, the printer
should have firmware loaded and external switches set to the runtime settings.
Application software for downloading should prompt the user to set the external switches
and confirm before sending this command. If the downloading was started from a
diagnostic, the reboot will cause the printer to reenter download state unless the external
switches are changed.
Example:
MSComm1.Output = Chr$(&H1D) & Chr$(&HFF)
```

7167 Owner’s Manual Appendix A: Specifications

```
November 2003 253
```
Appendix A: Specifications

### Printing Specifications

```
Thermal Receipt Station Slip Station
Print head Fixed
576 Print Elements
Direct Thermal
Fixed Head
Line of Dots
```
```
Bi-directional
Logic Seeking
Serial Dot Matrix
Ribbon Cassette
Forms Insertion
Character Cell Standard: 13 x 24 Dots
Compressed: 10 x 24 Dots
```
```
Standard: 10 x 7 Dots
Compressed: 10 x 7 Dots
Character Size .0525" Wide by .092" High .057" Wide by .097" High
Character Spacing 15.25 Characters per Inch (horizontal)
Character Pitch 15.6 Characters/Inch (Standard)
20.3 Characters/Inch (Compressed)
```
```
13.9 Characters/Inch (Standard)
17.1 Characters/Inch (Compressed)
Columns (maximum) For 80 mm paper:
44 Columns (Standard)
56 Columns (Compressed)
For 58 mm paper:
32 Columns (Standard)
42 Columns (Compressed)
```
```
45 Columns (Standard)
55 Columns (Compressed)
```
```
Print Mode Standard, Compressed, Double High,
Double Wide, Upside Down,
Rotated, Underline, Scalable, Bold,
Superscript, Italic, Subscript
```
```
Standard, Compressed, Double Wide,
Upside Down, Rotated
```
```
Resident Fonts Code Page 437, 850, 852, 860, 863,
865, 858, 866, 1252, Katakana, 874,
862, 864, and Space page
```
```
Code Page 437, 850, 852, 860, 863, 865,
858, 866, 1252, Katakana, 874, 862, 864,
and Space page
Speed 3019 Lines / Minute (44 columns),
Depend on Line Spacing
```
```
240/202/164/142 Lines per Minute;
Depending on # of Columns
(40 column width)
Print Order Descending Descending
Line Spacing 7.52 Lines per Inch ( default )
8.47, 8.13, 7.81, 7.25, 7.00, 5.98 Lines /
Inch and variable lines per inch.
```
```
7.2 Lines / Inch ( default )
10.3, 9.0, 8.0, 6.5, 6.0, Lines / Inch
and variable lines per inch.
```

7167 Owner’s Manual Appendix A: Specifications

254 November 2003

```
Thermal Receipt Station Slip Station
Slew Speed 6.7 Inches per Second 4.0 lines per Second
Print Zone 2.83 Inches Maximum 3.23 Inches Maximum
Noise 57 dBA Sound Pressure (ISO 7779) 62 dBA Sound Pressure (ISO 7779)
Graphics (Optional) User-Defined Graphics, Logo User-Defined Graphics
Other No Reverse Paper Feed Reverse Paper Feed
Two Form in Sensors
```
```
Thermal Receipt Station Impact Slip Station
Paper Diameter 80 mm Max. Not Applicable
Paper Length 83 Meters (273 feet) Side Insertion: 2.0 Inches (Min.)
Front Insertion: 2.75 Inches (Min.)
Paper Width 80 mm ± 1mm
(3.15 Inches ± .02 Inches)
```
```
Side Insertion: 8.0 Inches (Min.)
Front Insertion: 2.0 Inches (Min.)
Paper Thickness Not Applicable .406 mm (.016 Inch)
Printable Area 2.83 Inches (Max.) 3.22 Inches (Max.)
```
### Power Requirements

```
The 7167 printer receives power from a separate power supply. Here are the voltage
requirements for the power supply.
Maximum Current
Voltage Station Short Term Long Term
```
```
24.0 V ± 10% Slip 4.6 Amps 3.15 Amps
Receipt 6.5 Amps 3.15 Amps
```
### Environmental Conditions

```
Operating Temperature 5°C to 45°C (40°F to 112°F), models with knife
5°C to 50°C (40°F to 120°F), models with no knife
Operating Humidity 5% to 90%
```
```
Condensation may occur when equipment is transferred from cold to
warm areas after shipment. The printer's design permits operation after
drying out and stabilizing at room temperature.
```

7167 Owner’s Manual Appendix A: Specifications

```
November 2003 255
```
### Reliability

```
The numbers in the table refer to the Mean Cycle Between Failure (MCBF) for the items
indicated.
Thermal Receipt Printer 52 Million Lines
Impact Slip Printer 30 Million Lines
Impact Print head 200 Million Characters
Electronics 347,000 On time Hours
Communications Card 2,000,000 On Time Hours
Control Panel 2,100,000 On Time Hours
Knife 1 Million Cuts
MICR Check Reader 500,000 Reads
Flip 500,000 Flips
Power Supply 200,000 On-time Hours
```
Flip Mechanism (^) 200,000 Cycles
Scan I/F Board 1,383,000 MTBF
Scanner Mechanism 500,000 Cycles
Scan Head 1,000,000 Hours MTBF
Reliability staticties based on averages exhibited under lab conditions and do not constitue
a waranty

### Dimensions and Weight ...........................................................................................................

```
Height 174 mm (6.9 Inches)
Height with Cover Open 296 mm (11.7 Inches)
Width 190 mm (7.5 Inches)
Depth 262 mm (10.3 Inches)
Depth with Extended Slip Table 316 mm (12.5 Inches)
Weight 4.50 Kg (10.0 Pounds), Flip Model
4.25 Kg (9.4 Pounds), Non-Flip
Model
```
### Density of Receipt Print Lines

```
When the receipt station prints high density print lines (graphics), it automatically slows
down to a rate slower than 902 lines per minute. High density print lines are defined as
lines with over 50% of the dots printing on the line (there are 576 total dot columns on the
print station).
```

7167 Owner’s Manual Appendix A: Specifications

256 November 2003

### Duty Cycle Restrictions (Printing Solid Blocks)

```
There are restrictions on the duty cycle because of the heat generated by the receipt
thermal print head when printing solid blocks (regardless of the length of the block in
relation to the print line). The restrictions are ambient temperature, the percentage of time
(measured against one minute) of continuous solid printing, and the amount of coverage.
Caution: When the duty cycle approches the limits shown in the table, the receipt print
head will heat up and shut down. This may damage the print head.
To avoid this problem, do one or a combination of the following:
```
1. Reduce the amount of coverage.
2. Reduce the time of continuous solid printing.
3. Reduce the ambient temperature.

```
Ambient Temperature
Amount of Solid Coverage 25° C 35° C 50° C
20% 100% of 1 min.
continuous
printing
```
```
50% of 1 min.
continuous
printing
```
```
20% of 1 min.
continuous
printing
40% 50% of 1 min.
continuous
printing
```
```
25% of 1 min.
continuous
printing
```
```
10% of 1 min.
continuous
printing
100% 20% of 1 min.
continuous
printing
```
```
10% of 1 min.
continuous
printing
```
```
3% of 1 min.
continuous
printing
```

7167 Owner’s Manual Appendix B: Print Characteristics

```
Novembery 2003 257
```
Appendix B: Print Characteristics

### Character Size

```
This section shows the dot pattern for characters printed on the receipt and slip stations.
```
#### Receipt Station.................................................................................................................

```
The following two illustrations show the dot patterns of sample characters for standard
pitch (15.6 CPI) and compressed pitch (20.3 CPI). Note that compressed pitch uses fewer
dots horizontally than standard pitch.
```
Standard Pitch

```
11 Dots
1.38 mm
.054 in.
```
```
19 Dots
2.38 mm
.094 in.
```
```
13 Dots
1.63 mm
.064 in.
```
```
24 Dots
3.00 mm
.118 in.
```
```
203 DPI, 15.6 CPI Pitch (Standard)
```

7167 Owner’s Manual Appendix B: Print Characteristics

```
Novembery 2003 258
```
Compressed Pitch

#### Slip Station

```
The following illustrations show the dot patterns of sample characters for standard pitch
(13.9 CPI), double-wide characters, and rotated characters (counterclockwise).
```
```
Standard Pitch
The first illustration shows a single character with the dimensions listed in the table that
follows (including dimensions for compressed pitch). The second illustration shows the
layout of columns for standard pitch characters.
```
```
D
```
```
C
```
```
A
```
```
B
```
```
E
```
```
(Next Character)
```
```
Row spacing is fixed and column spacing depends upon the character pitch as indicated in
the table.
```
```
Dimension
```
```
Standard Pitch
(13.9 CPI, 45 Columns)
```
```
Compressed Pitch
(17.1 CPI, 55 Columns)
A .366 mm (.0144 inches) .30 mm (.0117 inches)
B 1.45 mm (.057 inches) 1.24 mm (.049 inches)
C 2.46 mm (.097 inches)
D .353 mm (.0139 inches)
E 1.83 mm (.072 inches) 1.49 mm (.0585 inches)
```
```
10 Dots
1.25 mm
.049 in.
```
```
8 Dots
1.00 mm
.039 in.
```
```
19 Dots
2.38 mm
.094 in.
```
```
203 DPI, 19 CPI Pitch (Compressed)
```
```
24 Dots
3.00 mm
.118 in.
```

7167 Owner’s Manual Appendix B: Print Characteristics

```
Novembery 2003 259
```
```
Note: Columns overlap within the format for each print row in half-dot increments
(depending upon pitch), but the printer cannot print overlapping dots on a single print
row. No ASCII character contains overlapping dots on a print row.
```
```
Double-Wide Characters
Double-wide characters are upright characters in an 8x7 dot format with twice the column
(horizontal) spacing between printed dots as for standard characters.
```

7167 Owner’s Manual Appendix B: Print Characteristics

```
Novembery 2003 260
```
```
Rotated Characters
Rotated characters are alternate characters in a 5x7 dot format printed 90 degrees
counterclockwise (as shown in the illustration) or clockwise. Only one horizontal pitch is
available: 6.95 CPI, 33 columns maximum.
```
```
Dimension
```
```
Horizontal Pitch
(6.95 CPI, 33 Columns)
A .366 mm (.0144 inches)
B 2.56 mm (.100 inches)
C 1.75 mm (.069 inches)
D .353 mm (.0139 inches)
E 3.66 mm (.144 inches)
```

7167 Owner’s Manual Appendix B: Print Characteristics

```
Novembery 2003 261
```
### Print Zones

```
This section shows the printable area for the slip station and the receipt station.
```
#### Receipt Station

```
For 80 mm Paper
The receipt station centers characters (standard pitch and compressed pitch) and graphics
on an 80 mm wide (3.15 inches) receipt.
Standard pitch: 13 x 24 dots in character cell, 44 characters (columns) per line
Compressed pitch: 10 x 24 dots in character cell, 56 characters (columns) per line
Double byte character: 24 x 24 dots in character cell, 24 characters (columns) per line
Graphics: 576 addressable bits
The minimum print line height is 24 dots for characters and 24 dots for graphics. The
standard print line height is 27 dots (3.38 mm, .133 inches) for characters (with three extra
dot rows). See the following illustration (not to scale).
```
```
For 58 mm Paper
The receipt station centers characters (standard pitch and compressed pitch) and graphics
on an 58 mm wide (2.28 inches) receipt.
Standard pitch: 13 x 24 dots in character cell, 32 characters (columns) per line
Compressed pitch: 10 x 24 dots in character cell, 42 characters (columns) per line
Double byte character: 24 x 24 dots in character cell, 17 characters (columns) per line
Graphics: 424 addressable bits
The minimum print line height is 24 dots for characters and 24 dots for graphics. The
standard print line height is 27 dots (3.38 mm, .133 inches) for characters (with three extra
dot rows). See the following illustration (not to scale).
```
```
Top Margin, 16.8 mm (.66 in.)
Minimum
```
```
Print Zone, 72.10 mm (2.84 in.)
576 Dots
Left and Right Margins, 4.00 mm (.16 in.)
```
```
Paper Width = 80 mm (3.15 inc.)
```

7167 Owner’s Manual Appendix B: Print Characteristics

```
Novembery 2003 262
```
#### Slip Station

```
The slip station prints characters (standard pitch and compressed pitch) and graphics in a
print zone of 82.2 mm (3.24 inches) wide on a slip or form.
Standard pitch: 45 characters (columns) per line
Compressed pitch: 55 characters (columns) per line
Double byte character: 27 characters (columns) per line
The print line height of 10 half dot x 7 dot characters is 2.46 mm (.097 in). With three-dot
spacing, the print line height is 3.53 mm (.139 inches). See the following illustration (not to
scale). To print as close to the bottom of the slip as possible without the slip leaving the
feed rollers, use the Print and Feed n Lines (1B 64 n ) , with n = 0.
```
```
Top Margin, 16.8 mm (.69 in.)
Minimum
```
```
Print Zone, 53.05 mm (2.09 in.)
424 Dots
Left and Right Margins, 4.00 mm (.10 in.)
```
```
Paper Width = 58 mm (2.28 inc.)
```
```
Paper Width: Not Restricted
```
```
Top Margin, 16 mm (.63 in.) Minimum
(Without Reverse Feed)
No Top Margin with Reverse Feed
```
```
Print Zone, 82.2 mm (3.24 in.)
```
```
Left and Right Margins, 3.2 mm (.125 in.)
```
```
Bottom Margin: 15.0 mm (.59 in.)
```

7167 Owner’s Manual Appendix B: Print Characteristics

```
Novembery 2003 263
```
#### Slip Form Parameters

```
In order for the printer to handle forms properly the forms shall be flat and void of curls or wrinkles
especially at the leading edge of the form.
```
```
Paper Feed Direction
```
```
Glued Location
```
##### 1 2 2 3

```
Form construction for glued edges.
```
```
1) Bottom edge of form should not be glued
2) Paper feeding and insertion are affected by gluing method and the quality of glue used
when form is glued on the right or top edge of form.
3) Skewing may occur when the form is glued on the left edge or when a wide form is used.
```
```
The sensors on the printer slip station use a reflective type photo sensor. Therefore the following
precautions must be taken to allow for proper operation.
```
- Paper that has holes or is translucent in the sensor locations as shown below should not be
    used.
- When thin paper is used it should be placed between the top and bottom sheets of multi-
    ply paper. The thickest ply of paper should be the last ply


7167 Owner’s Manual Appendix B: Print Characteristics

```
Novembery 2003 264
```
#### Check Size

```
The size of the check that the slip station and check flip mechanism handles conforms to
ANSI/ABA standard X9.13 dated 1999.
```
```
Personal Check
6.00” (152.40 mm) wide x 2.750” (69.85 mm) High.
```
```
Business
8.75” (222.25 mm) wide x 3.667” (93.14 mm) High
```
#### MICR Media Requirements.............................................................................................

```
MICR Printing
Printing of MICR Characters must conform to MICR standards as defined in ANSI/ABA
X9.13, X9.18 and 9.27 as well ISO 1004.
```
```
Forms
Checks must be flat and void of curls, folds or wrinkles expecially at the leading edges of
the checks.
```
```
Paper jams and MICR read errors will occur if check have paper clips and staples. Also
damage to the printer mechanism may occur to printer components such as the MICR
read head, paper feed rollers, impact print head, etc..
```
```
When inserting the check into the printer and the the printer feed rolls begin to feed the
check release the check immediately. Skewing of the check will occur which will cause
check jams and MICR read errors.
```
```
8 .0 mm (0.315 “)
```
```
19 mm (0.747”)
```
```
6 mm (0.236 “)
```
```
Edge of Check
```
```
Paper Feed
Direction
```
```
Holes and Low Reflection
Not Permitted in these
areas
```

7167 Owner’s Manual Appendix C

```
Novembery 2003 265
```
### Appendix C: Character Sets

```
The following pages show the character sets.
```
- PC Code Page 437 (USEnglish)
- PC Code Page 850 (Multilingual)
- PC Code Page 852 (Slavic)
- PC Code Page 860 (Portuguese)
- PC Code Page 862 (Hebrew)
- PC Code Page 863 (French-Canadian)
- PC Code Page 864 (Arabic)
- PC Code Page 865 (Nordic)
- PC Code Page 866 (Cyrillic)
- PC Code Page 1252 (Windows Latin #1)
- PC Code Page Katakana
- PC Code Page 874 (Thai)
- Space Page
- Code Page 932^1
- Code Page 936^1
- Code Page 949^1
- Code Page 950^1

(^1) Not supported by 7167-1035 and 7167-2035


7167 Owner’s Manual Appendix C

```
Novembery 2003 266
```
Code Page 950 Code Page 437, 850, 852 and 858


7167 Owner’s Manual Appendix C

```
Novembery 2003 267
```
Code Page 860, 862, 863 and 864


7167 Owner’s Manual Appendix C

```
Novembery 2003 268
```
Code Page 865, 866, 874 and 1252


7167 Owner’s Manual Appendix C

```
Novembery 2003 269
```
Code Page Katakana


7167 Owner’s Manual Appendix C

```
Novembery 2003 270
```
Code Page 932


7167 Owner’s Manual Appendix C

```
Novembery 2003 271
```
Code Page 932 (Cont)


7167 Owner’s Manual Appendix C

```
Novembery 2003 272
```
Code Page 932 (Cont)


7167 Owner’s Manual Appendix C

```
Novembery 2003 273
```
Code Page 932 (Cont)


7167 Owner’s Manual Appendix C

```
Novembery 2003 274
```
Code Page 932 (Cont)


7167 Owner’s Manual Appendix C

```
Novembery 2003 275
```
Code Page 932 (Cont)


7167 Owner’s Manual Appendix C

```
Novembery 2003 276
```
Code Page 932 (Cont)


7167 Owner’s Manual Appendix C

```
Novembery 2003 277
```
Code Page 932 (Cont)


7167 Owner’s Manual Appendix C

```
Novembery 2003 278
```
Code Page 932 (Cont)


7167 Owner’s Manual Appendix C

```
Novembery 2003 279
```
Code Page 936 Simple Chinese


7167 Owner’s Manual Appendix C

```
Novembery 2003 280
```
Code Page 936 Simple Chines1e (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 281
```
Code Page 936 Simple Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 282
```
Code Page 936 Simple Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 283
```
Code Page 936 Simple Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 284
```
Code Page 936 Simple Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 285
```
Code Page 936 Simple Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 286
```
Code Page 936 Simple Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 287
```
Code Page 936 Simple Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 288
```
Code Page 936 Simple Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 289
```

7167 Owner’s Manual Appendix C

```
Novembery 2003 290
```
Code Page 936 Simple Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 291
```
Code Page 949 Korean


7167 Owner’s Manual Appendix C

```
Novembery 2003 292
```
Code Page 949 Korean (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 293
```
Code Page 949 Korean (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 294
```
Code Page 949 Korean (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 295
```
Code Page 949 Korean (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 296
```
Code Page 949 Korean (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 297
```
Code Page 949 Korean (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 298
```
Code Page 949 Korean (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 299
```
Code Page 949 Korean (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 300
```
Code Page 949 Korean (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 301
```
Code Page 949 Korean (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 302
```
Code Page 949 Korean (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 303
```
Code Page 949 Korean (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 304
```
Code Page 949 Korean (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 305
```
Code Page Traditional Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 306
```
Code Page 949 Korean (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 307
```
Code Page 950 Traditional Chinese


7167 Owner’s Manual Appendix C

```
Novembery 2003 308
```
Code Pare 949 Traditional Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 309
```
Code Pare 980 Traditional Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 310
```
Code Pare 950 Traditional Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 311
```
Code Pare 949 Traditional Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 312
```
Code Pare 980 Traditional Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 313
```
Code Pare 980 Traditional Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 314
```
Code Pare 950 Traditional Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 315
```
Code Pare 950 Traditional Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 316
```
Code Pare 950 Traditional Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 317
```
Code Pare 950 Traditional Chinese (Cont.)


7167 Owner’s Manual Appendix C

```
Novembery 2003 318
```
Code Pare 950 Traditional Chinese (Cont.)


7167 Owner’s Manual Index

```
Novembery 2003 Index 319
```
### Index

—7—

7167 printer
clearance, 4
dimensions, 4, 255
environmental conditions, 254
features, 2
location, 4
ordering supplies, 6
power requirements, 254
power supply, ordering, 8
printer specifications, 253
reliability, 255
sending in for repair, 4
specifications, 253
turning on, 10, 39

—A—

Accessories. See Supplies
Asian mode
setting, 65, 66

—B—

Bar code commands, 185
Bar codes
commands, 185
BASIC
sending commands, 75

—C—

Cabinet
cleaning, 9
**Cables
cash drawer** , 2
**communication** , 2
connecting, 8
Carriage return usage
setting, 65
Cash drawer
ordering, 8
Cash drawer cables
connecting, 8
Changing paper, 11, 39
Character set
code page 437, 266
code page 850, 267
code page 852, 269
code page 863, 271
code page 865, 268, 270, 271, 272, 273
Character sets, 265
Characters, receipt station
dot patterns, 257
Characters, slip station

```
dot patterns, 258
Check flip
commands, 210
setting, 69
Check flip commands, 210
Check flip test modes
setting, 62
Checks
printing, 17, 40
validating, 18, 40
verifying, 18, 40
Cleaning the printer, 9
Clearance around printer, 4
Code page 437
character set, 265
Code Page 437, 266
Code page 850
character set, 265
Code Page 850, 267
Code Page 852, 269
Code Page 863, 271
Code Page 865, 268, 270, 271, 272, 273
Color paper
setting, 59, 60, 64, 67, 69, 70, 72
Commands
bar code, 185
check flip, 210
flash download, 247
graphics, 152
horizontal positioning, 125
listing, 83
macro, 199
MICR, 201, 219, 223
page mode, 191
print, 116
print characteristics, 132
printer function, 101
printer status, 161
real time, 173
real time,rules for using, 173
realtime, moving data through the buffer, 174
sending, 75
user data storage, 210
vertical positioning, 116
Commands, printer function
set horizontal and vertical minimum motion units, 124
Commands, real time
alternate implementation, 173
first implementation, 173
real time request to printer, GS sequence, 179
recognizing data from the printer, 172
Commands, sending
using BASIC, 75
using DOS, 75
Communication, 75
Communication cables, 2
connecting, 8
ordering, 8
```

7167 Owner’s Manual Index

```
Novembery 2003 Index 320
```
Communication interface. See RS-232C interface
Communication interface modes, 58
Configuring the printer, 56
Connecting cables
cash drawer, 8
communication, 8
power, 8
Connector
cash drawer, 80
RS-232C communication, 77
Consumables. See Paper
Contacting a service representative, 45

—D—

Data
moving through buffer, 174
Datascope modes
setting, 61
Default code page, 70
Default lines per inch
setting, 65
Density, of print, 255
Diagnostic modes, 60
Diagnostics, 53
knife failure, 42
level 0, 53
level 1, 53
level 2, 73
level 3, 74
paper jam, 42
paper out, 42
printhead over/under temperature, 43
startup, 53
Dimensions, of printer, 4, 255
DIP switches. See Switch settings
Documentation
ordering, 8
DOS
sending commands, 75
Dot patterns, of characters, 257, 258
Double-wide characters
dot patterns, 259
DTR/DSR protocol, 77
**Duty cycle
limitations** , 256

—E—

Emulation/software options, 64
Environmental conditions, 254
Errors. See Problems

—F—

Features, 2
Flash download
commands, 247
Flash download commands, 247
Forms
ordering, 7
printing, 17, 40

```
—G—
Graphics
commands, 152
Graphics commands, 152
```
```
—H—
Hardware options, 67
Horizontal positioning commands, 125
```
```
—I—
Installation
choosing location, 4
connecting cables, 8
loading paper, 11, 39
removing packing material, 3
setting switches, 6
turning on the printer, 10, 39
Interface. See RS-232C interface
```
```
—K—
Knife
failure of, 42
setting, 68
```
```
—L—
LED (green) blinking (fast)
what to do, 42
LED (green) blinking (slow)
what to do, 42
LED (green) does not come on
what to do, 41
LED (slip table) does not come on
what to do, 44
Level 0 diagnostics, 53
Level 1 diagnostics, 53
asian mode, 65, 66
carriage return usage, 65
check flip option, 69
check flip test modes, 62
color paper option, 59, 60, 64, 67, 69, 70, 72
communication interface modes, 58
configuring the printer, 56
datascope modes, 61
default code page, 70
default lines per inch, 65
diagnostic modes, 60
emulation/software options, 64
hardware options, 67
knife option, 68
maximum power option, 67
MICR option, 69
MICR test modes, 62
paper low sensor, 68
paper width, 68
platen waiting time, 66
print density, 67
print head gap adjustment test modes, 63
printer configuration, 54
```

7167 Owner’s Manual Index

```
Novembery 2003 Index 321
```
printer emulations, 64
receipt test modes, 61
RS 232 interface, 58
scan option, 70
set extra RS-232C options, 81
slip test modes, 61
Level 2 diagnostics, 73
Level 3 diagnostics, 74
Location
choosing, 4
clearance, 4

—M—

Macro
commands, 199
Macro commands, 199
Maintenance
cleaning the printer, 9
Maximum power
setting, 67
MICR
commands, 201, 219, 223
setting, 69
MICR check reader
operating environment, 4
MICR check reader commands, 201, 219, 223
MICR parsing, 202
check serial number, parsing, 207
exception table entry format, 208
exception table, loading, 208
exception table, maintaining, 209
parameter string options, 203
sample parsing formats, 205
MICR test modes
setting, 62
Modes
check flip test, 62
datascope, 61
MICR test, 62
print head gap adjustment test, 63
receipt test, 61
slip test, 61

—O—

Operator panel, 73
Options
asian mode, 65, 66
carriage return usage, 65
check flip, 69
color paper, 59, 60, 64, 67, 69, 70, 72
default lines per inch, 65
knife, 68
maximum power, 67
MICR, 69
paper low sensor, 68
paper width, 68
platen waiting time, 66
print density, 67
printer emulations, 64
scan, 70
Ordering

```
cash drawer, 8
communication cables, 8
documentation, 8
paper, 6
power supply, 8
supplies, 6
```
```
—P—
Packing material
removing, 3
repacking printer, 4
Page mode
commands, 191
Page mode commands, 191
Paper
advancing, 14, 39
changing, 11, 39
low, 11, 39, 42
ordering, 6
out, 11, 39
putting in the paper roll, 13, 39
removing, 12, 39
requirements, 6
suppliers, 6
Paper jam, 42
Paper low sensor
setting, 68
Paper out, 42
Paper width
setting, 68
Parsing. See MICR parsing
Platen Waiting Time
setting, 66
Power
turning on the printer, 10, 39
Power cables
connecting, 8
Power requirements, 254
Power supply
ordering, 8
Print characterisitics commands, 132
Print characteristics
commands, 132
Print commands, 116
Print density
receipt, 255
setting, 67
Print head gap adjustment test modes
setting, 63
Print problems, 44
too light, 43
Print speed, 76
Print timing, 76
Print zones
receipt station, 261
slip station, 262
Printer
configuration, 54
Printer configuration
setting, 54
Printer emulations
setting, 64
```

7167 Owner’s Manual Index

```
Novembery 2003 Index 322
```
Printer function commands, 101
Printer status
commands, 161
Printer status commands, 161
Printhead
impact, 5
thermal, 5
Printhead, thermal
cleaning, 9
over/under temperature, 43
**Printing, continuous
limitations of** , 256
Problems, 41
contacting a service representative, 45
forms skew or catch, 44
knife failure, 42
paper jam, 42
paper out, 42
print is light or spotty, 44
printhead over/under temperature, 43
Protocol, RS-232C
DTR/DSR, 77
XON/XOFF, 76

—R—

Real time
commands, 173
Real time commands, 173
alternate implementation, 173
preferred implementation, 173
using, 173
Receipt station
character dot patterns, 257
print zones, 261
Receipt test modes
setting, 61
Reliability, 255
Removing packing material, 3
Repacking printer, 4
Reset, 6
Ribbon cassette
changing, 15, 40
ordering, 7
Rotated characters
dot patterns, 260
Rotated printing
summary, 151
RS 232 interface
setting, 58
RS 232 interface settings, 58
RS-232C interface, 76
cash drawer connector, 80
communication connector, 77
DTR/DSR protocol, 77
parameters, 81
setting extra options, 81
technical specifications, 77
XON/XOFF protocol, 76

—S—

Scan

```
setting, 70
Setting switches, 6
RS-232C parameters, 81
Setup mode. See Level 1 diagnostics
Slip station
character dot patterns, 258
print zones, 262
Slip test modes
setting, 61
Specifications, 253
RS-232C interface, 77
Speed, 76
Standard pitch
dot patterns, 258
Supplies
cash drawer, 8
communication cables, 8
forms, 7
paper, 6
power cord, 8
power supply, 8
ribbon cassette, 7
shipped separately , 2
Switch settings, 6
Switch Settings
RS-232C parameters, 81
```
```
—T—
Technical specifications
RS-232C interface, 77
Thermal paper
ordering, 6
requirements, 6
suppliers, 6
Thermal printhead. See Printhead
cleaning, 9
print density, 255
Timing, 76
Troubleshooting. See Problems
Turning on the printer, 10, 39
```
```
—U—
User data storage
commands, 210
User data storage commands, 210
Using real time commands, 173
```
```
—V—
Vertical Positioning Commands, 116
```
```
—W—
Weight, of printer, 255
```
```
—X—
XON/XOFF protocol, 76
```

7167 Owner’s Manual Index

Novembery 2003 Index
323


```
7167 Owner’s Manual Index
```
```
Febuary 2003
```
##### I

### User Feedback

### Form

```
Title: NCR 7167 Thermal Receipt and Impact Slip Owners Manual
Number: B005-0000-1406 Issue: Issue Date: November 2003
```
```
NCR welcomes your feedback on this publication. Your comments can be of great value in helping us
improve our information products.
```
```
Circle the numbers below that best represent your opinion of this publication.
```
```
Ease of use 5 4 3 2 1 0
Accuracy 5 4 3 2 1 0
Clarity 5 4 3 2 1 0
Completeness 5 4 3 2 1 0
Organization 5 4 3 2 1 0
Appearance 5 4 3 2 1 0
Examples 5 4 3 2 1 0
Illustrations 5 4 3 2 1 0
Job performance 5 4 3 2 1 0
Question resolution 5 4 3 2 1 0
Overall satisfaction 5 4 3 2 1 0
```
```
Indicate the ways you feel we could improve this publication.
```
```
 Improve the table of contents  Add more/better quick reference aids
 Improve the overview/introduction  Add more examples
 Improve the organization  Add more illustrations
 Improve the index  Add more step-by-step procedures
 Make it less technical  Add more troubleshooting information
 Make it more concise/brief  Add more detail
```
```
Cut
```
```
5 = Excellent
4 = Good
3 = Adequate
2 = Fair
1 = Poor
```
```
0 = Not applicable
```
#### Downloaded from http://www.Manualslib.com manuals search engine


7167 Owner’s Manual Index

```
Febuary 2003 II
```
Write any additional comments you may have below and on additional sheets, if necessary. Include page
numbers where applicable.

If we may contact you concerning your comments, please fill in the information below.

Name:^

Organization:^

Company:^

Address:^

Phone:^ Fax:^

Thank you for your evaluation of this publication. Fold the form where indicated, tape (please do not staple),
and drop in the mail.

```
NO POSTAGE
NECESSARY
IF MAILED
IN THE
UNITED STATES
```
```
BUSINESS REPLY MAIL
FIRST CLASS PERMIT NO. 3 DAYTON, OHIO
POSTAGE WILL BE PAID BY ADDRESSEE
```

7167 Owner’s Manual Index

```
Febuary 2003 III
```
```
F-8763 0695
```
##### NCR CORPORATION

##### RETAIL SYSTEMS GROUP

##### INFORMATION PRODUCTS DEPT

##### 2651 SATELLITE BLVD.

##### DULUTH, GA 30136

```
Cut
```
```
Fold
```
```
Fold
```


B005-000-1406 Issue 1.0 0302 NCR is the name and mark of NCR Corporation
© 2002 NCR Corporation
Printed in U.S.A.


